import{ca as z,j as e,cb as M,cc as U,cd as R,R as F,I as b,B as j,az as L,aJ as K,cN as ee,L as H,dA as q,a1 as B,cG as W,r as c,p as S,f as $,V as se,ce as te,eX as ne,cf as N,cg as re,ch as Y,ci as ae,cj as le,A as E,T as C,au as J,a0 as ie,ck as oe,eV as Q,d1 as V,ax as ce,c4 as de,S as X,c3 as xe,D as he,dy as _,eQ as pe,a_ as D,a$ as ue,b1 as me,Y as ge,dC as je,dD as fe,b8 as be,aZ as ve,dF as ye,eS as Ce,eW as Se,eY as ke,H as De,C as Fe}from"./index-D82XrlGq.js";import{E as we}from"./empty-content-CAmd9egU.js";import{C as Te}from"./Card-Bw-3A9ev.js";import{P as Ie,p as Re}from"./Pagination-CXHPyE06.js";import{F as Ee,a as T,c as I}from"./filters-result-BUC8QtIh.js";import{o as G}from"./orderBy-BP_idRMj.js";import"./tour-new-edit-form-BHknQLIS.js";import"./html-to-markdown-ClkW1E93.js";import"./LastPage-xOhVKZvt.js";import"./schema-helper-BcHhi0sG.js";import"./CardHeader-BbCWHGKm.js";function Pe({tour:s,editHref:p,detailsHref:a,onDelete:n,sx:r,...x}){const o=z(),l=()=>e.jsxs(j,{sx:{top:8,right:8,zIndex:9,display:"flex",borderRadius:1,alignItems:"center",position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(b,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",s.ratingNumber]}),h=()=>e.jsxs(j,{sx:{top:8,left:8,zIndex:9,display:"flex",borderRadius:1,bgcolor:"grey.800",alignItems:"center",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!s.priceSale&&e.jsx(j,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:W(s.priceSale)}),W(s.price)]}),u=()=>e.jsxs(j,{sx:{p:1,gap:.5,display:"flex"},children:[e.jsxs(j,{sx:{flexGrow:1,position:"relative"},children:[h(),l(),e.jsx(L,{alt:s.images[0],src:s.images[0],sx:{width:1,height:164,borderRadius:1}})]}),e.jsxs(j,{sx:{gap:.5,display:"flex",flexDirection:"column"},children:[e.jsx(L,{alt:s.images[1],src:s.images[1],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}}),e.jsx(L,{alt:s.images[2],src:s.images[2],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}})]})]}),t=()=>e.jsx(K,{sx:{p:"20px 20px 16px 20px"},primary:`Posted date: ${ee(s.createdAt)}`,secondary:e.jsx(H,{component:F,href:a,color:"inherit",children:s.name}),slotProps:{primary:{sx:{typography:"caption",color:"text.disabled"}},secondary:{noWrap:!0,component:"h6",sx:{mt:1,color:"text.primary",typography:"subtitle1"}}}}),m=()=>e.jsxs(j,{sx:{gap:1.5,display:"flex",position:"relative",flexDirection:"column",p:"0 20px 20px 20px"},children:[e.jsx(B,{onClick:o.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(b,{icon:"eva:more-vertical-fill"})}),[{icon:e.jsx(b,{icon:"mingcute:location-fill",sx:{color:"error.main"}}),label:s.destination},{icon:e.jsx(b,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}}),label:q(s.available.startDate,s.available.endDate)},{icon:e.jsx(b,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}}),label:`${s.bookers.length} Booked`}].map(d=>e.jsxs(j,{sx:[{gap:.5,display:"flex",typography:"body2",alignItems:"center"}],children:[d.icon,d.label]},d.label))]}),g=()=>e.jsx(M,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(U,{children:[e.jsx("li",{children:e.jsxs(R,{component:F,href:a,onClick:()=>o.onClose(),children:[e.jsx(b,{icon:"solar:eye-bold"}),"View"]})}),e.jsx("li",{children:e.jsxs(R,{component:F,href:p,onClick:()=>o.onClose(),children:[e.jsx(b,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsxs(R,{onClick:()=>{o.onClose(),n()},sx:{color:"error.main"},children:[e.jsx(b,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(Te,{sx:r,...x,children:[u(),t(),m()]}),g()]})}function Oe({tours:s}){const p=c.useCallback(a=>{console.info("DELETE",a)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:s.map(a=>e.jsx(Pe,{tour:a,editHref:S.dashboard.tour.edit(a.id),detailsHref:S.dashboard.tour.details(a.id),onDelete:()=>p(a.id)},a.id))}),s.length>8&&e.jsx(Ie,{count:8,sx:{mt:{xs:5,md:8},[`& .${Re.ul}`]:{justifyContent:"center"}}})]})}function Ae({sort:s,onSort:p,sortOptions:a}){const n=z(),r=()=>e.jsx(M,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,children:e.jsx(U,{children:a.map(x=>e.jsx(R,{selected:x.value===s,onClick:()=>{n.onClose(),p(x.value)},children:x.label},x.value))})});return e.jsxs(e.Fragment,{children:[e.jsxs($,{disableRipple:!0,color:"inherit",onClick:n.onOpen,endIcon:e.jsx(b,{icon:n.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(j,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),r()]})}function Le({redirectPath:s,sx:p}){const a=se(),[n,r]=c.useState(""),[x,o]=c.useState(null),l=te(n),{searchResults:h,searchLoading:u}=Ge(l),t=c.useCallback(d=>{o(d),d&&a.push(s(d.id))},[a,s]),m=ne({matchFrom:"any",stringify:d=>`${d.name} ${d.destination}`}),g={width:320,[` .${N.listbox}`]:{[` .${N.option}`]:{p:0,[` .${re.root}`]:{p:.75,gap:1.5,width:1,display:"flex",alignItems:"center"}}}};return e.jsx(Y,{autoHighlight:!0,popupIcon:null,loading:u,options:h,value:x,filterOptions:m,onChange:(d,f)=>t(f),onInputChange:(d,f)=>r(f),getOptionLabel:d=>d.name,noOptionsText:e.jsx(oe,{query:l}),isOptionEqualToValue:(d,f)=>d.id===f.id,slotProps:{paper:{sx:g}},sx:[{width:{xs:1,sm:260}},...Array.isArray(p)?p:[p]],renderInput:d=>e.jsx(J,{...d,placeholder:"Pesquisar...",slotProps:{input:{...d.InputProps,startAdornment:e.jsx(ie,{position:"start",children:e.jsx(b,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})}),endAdornment:e.jsxs(e.Fragment,{children:[u?e.jsx(b,{icon:"svg-spinners:8-dots-rotate",sx:{mr:-3}}):null,d.InputProps.endAdornment]})}}}),renderOption:(d,f,{inputValue:w})=>{const P=ae(f.name,w),O=le(f.name,P);return c.createElement("li",{...d,key:f.id},e.jsxs(H,{component:F,href:s(f.id),color:"inherit",underline:"none",children:[e.jsx(E,{alt:f.name,src:f.images[0],variant:"rounded",sx:{width:48,height:48,flexShrink:0,borderRadius:1}},f.id),e.jsx("div",{children:O.map((k,A)=>e.jsx(C,{component:"span",color:k.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:k.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:k.text},A))},w)]}))}})}function Ge(s){const[p,a]=c.useState([]),[n,r]=c.useState(!1),x=c.useCallback(async()=>{r(!0);try{await new Promise(l=>setTimeout(l,500));const o=Q.filter(({name:l,destination:h})=>[l,h].some(u=>u==null?void 0:u.toLowerCase().includes(s.toLowerCase())));a(o)}catch(o){console.error(o)}finally{r(!1)}},[s]);return c.useEffect(()=>{s?x():a([])},[x,s]),{searchResults:p,searchLoading:n}}function Be({open:s,onOpen:p,onClose:a,filters:n,options:r,canReset:x,dateError:o}){const{state:l,setState:h,resetState:u}=n,t=c.useCallback(i=>{const v=l.services.includes(i)?l.services.filter(y=>y!==i):[...l.services,i];h({services:v})},[h,l.services]),m=c.useCallback(i=>{h({startDate:i})},[h]),g=c.useCallback(i=>{h({endDate:i})},[h]),d=c.useCallback(i=>{h({destination:i})},[h]),f=c.useCallback(i=>{h({tourGuides:i})},[h]),w=()=>e.jsxs(e.Fragment,{children:[e.jsxs(j,{sx:{py:2,pr:1,pl:2.5,display:"flex",alignItems:"center"},children:[e.jsx(C,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(xe,{title:"Reset",children:e.jsx(B,{onClick:()=>u(),children:e.jsx(V,{color:"error",variant:"dot",invisible:!x,children:e.jsx(b,{icon:"solar:restart-bold"})})})}),e.jsx(B,{onClick:a,children:e.jsx(b,{icon:"mingcute:close-line"})})]}),e.jsx(he,{sx:{borderStyle:"dashed"}})]}),P=()=>e.jsxs(j,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsx(_,{label:"Start date",value:l.startDate,onChange:m,sx:{mb:2.5}}),e.jsx(_,{label:"End date",value:l.endDate,onChange:g,slotProps:{textField:{error:o,helperText:o?"End date must be later than start date":null}}})]}),O=()=>e.jsxs(j,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(pe,{id:"multiple-destinations",multiple:!0,fullWidth:!0,placeholder:l.destination.length?"+ Destination":"Select Destination",value:l.destination,onChange:(i,v)=>d(v)})]}),k=()=>e.jsxs(j,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(Y,{multiple:!0,disableCloseOnSelect:!0,options:r.tourGuides,value:l.tourGuides,onChange:(i,v)=>f(v),getOptionLabel:i=>i.name,renderInput:i=>e.jsx(J,{placeholder:"Select Tour Guides",...i}),renderOption:(i,v)=>c.createElement("li",{...i,key:v.id},e.jsx(E,{alt:v.avatarUrl,src:v.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},v.id),v.name),renderTags:(i,v)=>i.map((y,Z)=>c.createElement(D,{...v({index:Z}),key:y.id,size:"small",variant:"soft",label:y.name,avatar:e.jsx(E,{alt:y.name,src:y.avatarUrl})}))})]}),A=()=>e.jsxs(j,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Services"}),r.services.map(i=>e.jsx(ue,{label:i,control:e.jsx(me,{checked:l.services.includes(i),onClick:()=>t(i),inputProps:{id:`${i}-checkbox`}})},i))]});return e.jsxs(e.Fragment,{children:[e.jsx($,{disableRipple:!0,color:"inherit",endIcon:e.jsx(V,{color:"error",variant:"dot",invisible:!x,children:e.jsx(b,{icon:"ic:round-filter-list"})}),onClick:p,children:"Filters"}),e.jsxs(ce,{anchor:"right",open:s,onClose:a,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:[w(),e.jsx(de,{sx:{px:2.5,py:3},children:e.jsxs(X,{spacing:3,children:[P(),O(),k(),A()]})})]})]})}function $e({filters:s,totalResults:p,sx:a}){const{state:n,setState:r,resetState:x}=s,o=c.useCallback(t=>{const m=n.services.filter(g=>g!==t);r({services:m})},[r,n.services]),l=c.useCallback(()=>{r({startDate:null,endDate:null})},[r]),h=c.useCallback(t=>{const m=n.tourGuides.filter(g=>g.name!==t.name);r({tourGuides:m})},[r,n.tourGuides]),u=c.useCallback(t=>{const m=n.destination.filter(g=>g!==t);r({destination:m})},[r,n.destination]);return e.jsxs(Ee,{totalResults:p,onReset:()=>x(),sx:a,children:[e.jsx(T,{label:"Available:",isShow:!!(n.startDate&&n.endDate),children:e.jsx(D,{...I,label:q(n.startDate,n.endDate),onDelete:l})}),e.jsx(T,{label:"Services:",isShow:!!n.services.length,children:n.services.map(t=>c.createElement(D,{...I,key:t,label:t,onDelete:()=>o(t)}))}),e.jsx(T,{label:"Tour guide:",isShow:!!n.tourGuides.length,children:n.tourGuides.map(t=>c.createElement(D,{...I,key:t.id,avatar:e.jsx(E,{alt:t.name,src:t.avatarUrl}),label:t.name,onDelete:()=>h(t)}))}),e.jsx(T,{label:"Destination:",isShow:!!n.destination.length,children:n.destination.map(t=>c.createElement(D,{...I,key:t,label:t,onDelete:()=>u(t)}))})]})}function We(){const s=ge(),[p,a]=c.useState("latest"),n=je({destination:[],tourGuides:[],services:[],startDate:null,endDate:null}),{state:r}=n,x=fe(r.startDate,r.endDate),o=Ne({inputData:Q,filters:r,sortBy:p,dateError:x}),l=r.destination.length>0||r.tourGuides.length>0||r.services.length>0||!!r.startDate&&!!r.endDate,h=!o.length&&l,u=c.useCallback(g=>{a(g)},[]),t=()=>e.jsxs(j,{sx:{gap:3,display:"flex",justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(Le,{redirectPath:g=>S.dashboard.tour.details(g)}),e.jsxs(j,{sx:{gap:1,flexShrink:0,display:"flex"},children:[e.jsx(Be,{filters:n,canReset:l,dateError:x,open:s.value,onOpen:s.onTrue,onClose:s.onFalse,options:{tourGuides:Se,services:Ce.map(g=>g.label)}}),e.jsx(Ae,{sort:p,onSort:u,sortOptions:ke})]})]}),m=()=>e.jsx($e,{filters:n,totalResults:o.length});return e.jsxs(be,{children:[e.jsx(ve,{heading:"List",links:[{name:"Dashboard",href:S.dashboard.root},{name:"Tour",href:S.dashboard.tour.root},{name:"List"}],action:e.jsx($,{component:F,href:S.dashboard.tour.new,variant:"contained",startIcon:e.jsx(b,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(X,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[t(),l&&m()]}),h&&e.jsx(we,{filled:!0,sx:{py:10}}),e.jsx(Oe,{tours:o})]})}function Ne({inputData:s,filters:p,sortBy:a,dateError:n}){const{services:r,destination:x,startDate:o,endDate:l,tourGuides:h}=p,u=h.map(t=>t.id);return a==="latest"&&(s=G(s,["createdAt"],["desc"])),a==="oldest"&&(s=G(s,["createdAt"],["asc"])),a==="popular"&&(s=G(s,["totalViews"],["desc"])),x.length&&(s=s.filter(t=>x.includes(t.destination))),u.length&&(s=s.filter(t=>t.tourGuides.some(m=>u.includes(m.id)))),r.length&&(s=s.filter(t=>t.services.some(m=>r.includes(m)))),n||o&&l&&(s=s.filter(t=>ye(o,t.available.startDate,t.available.endDate))),s}const Ve={title:`Tour list | Dashboard - ${Fe.appName}`};function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsxs("title",{children:[" ",Ve.title]})}),e.jsx(We,{})]})}export{Ke as default};

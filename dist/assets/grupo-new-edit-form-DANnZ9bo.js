import{V as D,r as R,y as k,z,O as N,c5 as c,p as g,j as e,F as U,G as h,aP as B,B as l,K as i,T as n,de as V,a$ as q,e0 as j,aQ as G,S as f,f as T,ch as M,au as Q,cd as W,N as $,e7 as H,Q as d,bG as K}from"./index-D82XrlGq.js";import{u as J}from"./use-corretores-D9KzIeK_.js";import{C as X}from"./confirm-dialog-rvtuH5TT.js";import{s as Y}from"./schema-helper-BcHhi0sG.js";import{C as y}from"./Card-Bw-3A9ev.js";const Z=N({avatarUrl:Y.file().optional(),name:d().min(1,{message:"Nome é obrigatório!"}),description:d().min(1,{message:"Descrição é obrigatória!"}),leader:d().min(1,{message:"Gerente é obrigatório!"}),meta:K().min(0,{message:"Meta deve ser um número positivo!"}).optional(),tipo:d().min(1,{message:"Tipo é obrigatório!"}),status:H(["ativo","inativo","suspenso"])});function oe({currentGrupo:t}){const m=D(),[C,u]=R.useState(!1),{corretores:v,loading:S}=J(),w={avatarUrl:null,name:"",description:"",leader:"",meta:0,tipo:"",status:"ativo"},p=k({mode:"onSubmit",resolver:z(Z),defaultValues:w,values:t?{avatarUrl:t.avatarUrl||null,name:t.name,description:t.description,leader:t.leader,meta:t.meta||0,tipo:t.tipo||"",status:t.status}:void 0}),A=async()=>{try{await new Promise(a=>setTimeout(a,500)),c.success("Grupo excluído com sucesso!"),m.push(g.dashboard.grupos.list),u(!1)}catch(a){console.error(a),c.error("Erro ao excluir grupo")}},{reset:b,watch:I,control:E,handleSubmit:O,formState:{isSubmitting:P}}=p,x=I(),F=O(async a=>{try{if(await new Promise(o=>setTimeout(o,500)),t)b(),c.success("Grupo atualizado com sucesso!"),m.push(g.dashboard.grupos.details(t.id));else{const o=`grupo-${Date.now()}`;b(),c.success("Grupo criado com sucesso!"),m.push(g.dashboard.grupos.details(o))}console.info("DATA",a)}catch(o){console.error(o)}}),L=[{value:"Residencial",label:"Residencial"},{value:"Comercial",label:"Comercial"},{value:"Rural",label:"Rural"},{value:"Lançamentos",label:"Lançamentos"},{value:"Aluguel",label:"Aluguel"},{value:"Venda",label:"Venda"},{value:"Aluguel por Temporada",label:"Aluguel por Temporada"},{value:"Industrial",label:"Industrial"},{value:"Terrenos e Lotes",label:"Terrenos e Lotes"},{value:"Imóveis de Alto Padrão",label:"Imóveis de Alto Padrão"},{value:"Oportunidades",label:"Oportunidades"}];return e.jsxs(U,{methods:p,onSubmit:F,children:[e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{size:{xs:12,md:4},children:e.jsxs(y,{sx:{pt:10,pb:5,px:3},children:[t&&e.jsx(B,{color:x.status==="ativo"&&"success"||x.status==="suspenso"&&"error"||"warning",sx:{position:"absolute",top:24,right:24},children:x.status}),e.jsx(l,{sx:{mb:5,textAlign:"center"},children:e.jsx(i.UploadAvatar,{name:"avatarUrl",maxSize:3145728,helperText:e.jsxs(n,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Permitido *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," tamanho máximo de ",V(3145728)]})})}),t&&e.jsx(q,{labelPlacement:"start",control:e.jsx(j,{name:"status",control:E,render:({field:a})=>e.jsx(G,{...a,checked:a.value==="ativo",onChange:o=>a.onChange(o.target.checked?"ativo":"inativo")})}),label:e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:.5},children:"Status Ativo"}),e.jsx(n,{variant:"body2",sx:{color:"text.secondary"},children:"Ativar ou desativar o grupo"})]}),sx:{mx:0,mb:3,width:1,justifyContent:"space-between"}}),t&&e.jsx(f,{sx:{mt:3,alignItems:"center",justifyContent:"center"},children:e.jsx(T,{variant:"soft",color:"error",onClick:()=>u(!0),children:"Excluir grupo"})})]})}),e.jsx(h,{size:{xs:12,md:8},children:e.jsxs(y,{sx:{p:3},children:[e.jsxs(l,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(i.Text,{name:"name",label:"Nome do Grupo"}),e.jsx(j,{name:"leader",control:p.control,render:({field:a,fieldState:{error:o}})=>e.jsx(M,{...a,options:v.filter(s=>s.status==="ativo"),getOptionLabel:s=>typeof s=="string"?s:s.name,isOptionEqualToValue:(s,r)=>typeof r=="string"?s.name===r:s.id===r.id,onChange:(s,r)=>{a.onChange(r?r.name:"")},value:v.find(s=>s.name===a.value)||null,loading:S,renderInput:s=>e.jsx(Q,{...s,label:"Gerente",error:!!o,helperText:o==null?void 0:o.message,placeholder:"Pesquisar gerente..."}),renderOption:(s,r)=>e.jsx(l,{component:"li",...s,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(n,{variant:"body2",children:r.name}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[r.email," • CRECI: ",r.creci]})]})}),noOptionsText:"Nenhum corretor encontrado"})}),e.jsx(l,{sx:{gridColumn:{sm:"span 2"}},children:e.jsx(i.Text,{name:"description",label:"Descrição",multiline:!0,rows:3})}),e.jsx(i.Text,{name:"meta",label:"Meta",type:"number",InputProps:{inputProps:{min:0}}}),e.jsx(i.Select,{name:"tipo",label:"Tipo",children:L.map(a=>e.jsx(W,{value:a.value,children:a.label},a.value))})]}),e.jsx(f,{sx:{mt:3,alignItems:"flex-end"},children:e.jsx($,{type:"submit",variant:"contained",loading:P,children:t?"Salvar alterações":"Criar grupo"})})]})})]}),e.jsx(X,{open:C,onClose:()=>u(!1),title:"Excluir grupo",content:e.jsxs(e.Fragment,{children:["Tem certeza de que deseja excluir este grupo?",e.jsx("br",{}),e.jsx(n,{component:"span",sx:{color:"error.main",fontWeight:"fontWeightBold"},children:"Esta ação é irreversível e não pode ser desfeita."})]}),action:e.jsx(T,{variant:"contained",color:"error",onClick:A,children:"Excluir"})})]})}export{oe as G};

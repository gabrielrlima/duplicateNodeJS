import{r as b,V as ue,Y as xe,cU as he,y as ge,z as ve,O as _,cN as H,p as ae,j as e,F as be,G as p,T as s,S as u,K as l,eM as ye,b3 as c,B as g,N as pe,I as O,c3 as J,bn as ie,bm as je,Q as d,c2 as Se,bv as Ce,bc as se,D as Z,aB as Ee,aq as Pe,f as X,ee,eJ as ze}from"./index-cNRh_qft.js";import{b as Re,c as fe}from"./terreno-B_nrSajh.js";import{C as N}from"./Card-C_-31fGp.js";import{G as t}from"./Grid-BAAHJ7js.js";const Ne=_({titulo:d().min(1,"Título é obrigatório"),preco:J.number().min(.01,"Preço deve ser maior que zero"),area:J.number().min(.01,"Área deve ser maior que zero"),proprietario:_({nome:d().min(1,"Nome do proprietário é obrigatório"),email:d().email("Email inválido").min(1,"Email é obrigatório"),telefone:d().min(1,"Telefone é obrigatório"),documento:d().min(1,"CPF/CNPJ é obrigatório")}),descricao:d().optional(),status:d().optional(),tipo:d().optional(),observacoes:d().optional(),imagens:je(Se()).optional(),localizacao:_({endereco:d().optional(),numero:d().optional(),bairro:d().optional(),cidade:d().optional(),estado:d().optional(),cep:d().optional()}).optional(),caracteristicas:_({dimensoes:d().optional(),formato:d().optional(),topografia:d().optional(),acesso:d().optional(),documentacao:d().optional()}).optional(),precoM2:J.number().optional(),preco_negociavel:ie().default(!1),itu_anual:J.number().optional()}),_e=b.forwardRef(({currentTerreno:a,onLoadingChange:n,renderActions:f},h)=>{const B=ue(),E=xe(),{currentRealEstate:P}=he(),[v,T]=b.useState(!1),[I,V]=b.useState(null),z={titulo:"",preco:0,area:0,proprietario:{nome:"",email:"",telefone:"",documento:""},descricao:"",status:"disponivel",tipo:"residencial",observacoes:"",imagens:[],localizacao:{endereco:"",numero:"",bairro:"",cidade:"",estado:"SP",cep:""},caracteristicas:{dimensoes:"",formato:"",topografia:"",acesso:"",documentacao:""},precoM2:0,preco_negociavel:!1,itu_anual:0},A=ge({mode:"onChange",resolver:ve(Ne),defaultValues:z,values:a?{titulo:a.titulo,descricao:a.descricao,area:a.area,preco:a.preco,precoM2:a.precoM2,status:a.status==="available"?"disponivel":a.status==="reserved"?"reservado":a.status==="sold"?"vendido":a.status==="inactive"?"suspenso":a.status,tipo:a.tipo==="residential"?"residencial":a.tipo==="commercial"?"comercial":a.tipo==="industrial"?"industrial":a.tipo==="rural"?"rural":a.tipo,observacoes:a.observacoes||"",localizacao:{...a.localizacao,numero:a.localizacao.numero||""},proprietario:a.proprietario,caracteristicas:{...a.caracteristicas,dimensoes:a.dimensoes||a.caracteristicas.formato||"",topografia:a.caracteristicas.topografia==="plano"?"plano":a.caracteristicas.topografia==="aclive"?"aclive":a.caracteristicas.topografia==="declive"?"declive":a.caracteristicas.topografia==="irregular"?"irregular":a.caracteristicas.topografia==="inclinado"?"inclinado":a.caracteristicas.topografia==="flat"?"plano":a.caracteristicas.topografia==="sloped"?"inclinado":a.caracteristicas.topografia,acesso:a.caracteristicas.acesso==="asfalto"?"asfalto":a.caracteristicas.acesso==="terra"?"terra":a.caracteristicas.acesso==="paved"?"asfalto":a.caracteristicas.acesso==="dirt"?"terra":a.caracteristicas.acesso,documentacao:a.caracteristicas.documentacao==="sim"?"escritura":a.caracteristicas.documentacao==="nao"?"":["escritura","contrato","posse","financiado"].includes(a.caracteristicas.documentacao)?a.caracteristicas.documentacao:""},preco_negociavel:a.preco_negociavel||!1,itu_anual:a.itu_anual||0,imagens:a.imagens||[]}:void 0}),{reset:L,watch:W,setValue:D,handleSubmit:F,formState:{isSubmitting:y}}=A,m=W(),R=b.useCallback((i,r)=>{if(i===r)return!0;if(i==null||r==null)return!1;if(typeof i!="object"||typeof r!="object")return i===r;const x=Object.keys(i),o=Object.keys(r);if(x.length!==o.length)return!1;for(const S of x)if(!o.includes(S)||!R(i[S],r[S]))return!1;return!0},[]);b.useEffect(()=>{if(a&&I){const i=!R(m,I);T(i)}else a||T(!0)},[m,I,a,R]),b.useEffect(()=>{if(a&&!I){const i={titulo:a.titulo,descricao:a.descricao,area:a.area,preco:a.preco,precoM2:a.precoM2,status:a.status==="available"?"disponivel":a.status==="reserved"?"reservado":a.status==="sold"?"vendido":a.status==="inactive"?"suspenso":a.status,tipo:a.tipo==="residential"?"residencial":a.tipo==="commercial"?"comercial":a.tipo==="industrial"?"industrial":a.tipo==="rural"?"rural":a.tipo,observacoes:a.observacoes||"",localizacao:{...a.localizacao,numero:a.localizacao.numero||""},proprietario:a.proprietario,caracteristicas:{...a.caracteristicas,dimensoes:a.dimensoes||a.caracteristicas.formato||"",topografia:a.caracteristicas.topografia==="plano"?"plano":a.caracteristicas.topografia==="aclive"?"aclive":a.caracteristicas.topografia==="declive"?"declive":a.caracteristicas.topografia==="irregular"?"irregular":a.caracteristicas.topografia==="inclinado"?"inclinado":a.caracteristicas.topografia==="flat"?"plano":a.caracteristicas.topografia==="sloped"?"inclinado":a.caracteristicas.topografia,acesso:a.caracteristicas.acesso==="asfalto"?"asfalto":a.caracteristicas.acesso==="terra"?"terra":a.caracteristicas.acesso==="paved"?"asfalto":a.caracteristicas.acesso==="dirt"?"terra":a.caracteristicas.acesso,documentacao:a.caracteristicas.documentacao==="sim"?"escritura":a.caracteristicas.documentacao==="nao"?"":["escritura","contrato","posse","financiado"].includes(a.caracteristicas.documentacao)?a.caracteristicas.documentacao:""},preco_negociavel:a.preco_negociavel||!1,itu_anual:a.itu_anual||0,imagens:a.imagens||[]};V(i)}},[a]);const Q=b.useCallback(i=>{var x;const r=m.imagens&&((x=m.imagens)==null?void 0:x.filter(o=>o!==i));D("imagens",r)},[D,m.imagens]),oe=b.useCallback(()=>{D("imagens",[],{shouldValidate:!0})},[D]),K=()=>{m.area>0&&m.preco>0&&D("precoM2",m.preco/m.area)},q=()=>{B.push(ae.dashboard.terrenos.root)},w=F(async i=>{var r,x,o,S,j,C,M,k,Y,U,re,le,te,ce,ne,de,me;console.log("🎯 handleSave chamado!"),console.log("📋 Dados do formulário:",i),E.onTrue();try{console.log("🚀 Salvando terreno:",i),console.log("Imobiliária atual:",P),P!=null&&P.id||console.log("⚠️ Nenhuma imobiliária selecionada. Usando ID padrão para teste.");const $={name:i.titulo,title:i.titulo,description:i.descricao||"Terreno criado via formulário",totalArea:i.area,value:i.preco,status:i.status==="disponivel"?"available":i.status==="reservado"?"reserved":i.status==="vendido"?"sold":i.status==="suspenso"?"inactive":"available",type:i.tipo==="residencial"?"residential":i.tipo==="comercial"?"commercial":i.tipo==="industrial"?"industrial":i.tipo==="rural"?"rural":"residential",acceptsFinancing:!!i.preco_negociavel,address:{street:((r=i.localizacao)==null?void 0:r.endereco)||"Não informado",number:((x=i.localizacao)==null?void 0:x.numero)||"S/N",neighborhood:((o=i.localizacao)==null?void 0:o.bairro)||"Não informado",city:((S=i.localizacao)==null?void 0:S.cidade)||"Não informado",state:((j=i.localizacao)==null?void 0:j.estado)||"SP",zipCode:((C=i.localizacao)==null?void 0:C.cep)||"00000-000"},owner:{name:i.proprietario.nome,email:i.proprietario.email,phone:i.proprietario.telefone,document:i.proprietario.documento},topography:((M=i.caracteristicas)==null?void 0:M.topografia)==="plano"?"flat":((k=i.caracteristicas)==null?void 0:k.topografia)==="inclinado"||((Y=i.caracteristicas)==null?void 0:Y.topografia)==="aclive"||((U=i.caracteristicas)==null?void 0:U.topografia)==="declive"?"sloped":((re=i.caracteristicas)==null?void 0:re.topografia)==="irregular"?"irregular":"flat",dimensions:((le=i.caracteristicas)==null?void 0:le.dimensoes)||"",accessType:((te=i.caracteristicas)==null?void 0:te.acesso)==="asfalto"?"paved":((ce=i.caracteristicas)==null?void 0:ce.acesso)==="terra"?"dirt":((ne=i.caracteristicas)==null?void 0:ne.acesso)==="paralelepipedo"?"cobblestone":(((de=i.caracteristicas)==null?void 0:de.acesso)==="concreto","paved"),hasDocumentation:!!((me=i.caracteristicas)!=null&&me.documentacao),imagens:i.imagens||[],realEstateId:(P==null?void 0:P.id)||"test-real-estate-id"};console.log("Dados para API:",$),a?(await Re(a.id,$),H.success("Terreno atualizado com sucesso!")):(await fe($),H.success("Terreno criado com sucesso!")),L(),B.push(ae.dashboard.terrenos.root)}catch($){console.error("Erro ao salvar terreno:",$),H.error("Erro ao salvar terreno. Verifique os dados e tente novamente.")}finally{E.onFalse()}});return b.useImperativeHandle(h,()=>({onSave:w,onCancel:q}),[w,q]),b.useEffect(()=>{n&&n(E.value&&y)},[n,E.value,y]),b.useEffect(()=>{f&&f({onSave:w,onCancel:q,loading:E.value&&y,isEditing:!!a})},[f,E.value,y,a,w,q]),e.jsxs(be,{methods:A,onSubmit:w,children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{size:{xs:12,md:8},children:[e.jsxs(N,{sx:{p:3},children:[e.jsx(s,{variant:"h6",sx:{mb:3},children:"Informações Básicas"}),e.jsxs(u,{spacing:3,children:[e.jsx(l.Text,{name:"titulo",label:"Título",placeholder:"Digite o título do terreno"}),e.jsx(l.Text,{name:"descricao",label:"Descrição",placeholder:"Descreva as características do terreno",multiline:!0,rows:3}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:4},children:e.jsx(l.Number,{name:"area",label:"Área (m²)",placeholder:"Ex: 500",formatThousands:!0,onBlur:K})}),e.jsx(p,{size:{xs:12,md:4},children:e.jsx(l.Number,{name:"preco",label:"Preço (R$)",placeholder:"Ex: 150.000",formatThousands:!0,onBlur:K})}),e.jsx(p,{size:{xs:12,md:4},children:e.jsx(l.Number,{name:"precoM2",label:"Preço/m² (R$)",formatThousands:!0,disabled:!0})})]}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsx(l.Select,{name:"status",label:"Status",placeholder:"Selecione o status",children:ye.map(i=>{const r=a&&a.status===i.value;return e.jsx(c,{value:i.value,disabled:r,children:i.label},i.value)})})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsxs(l.Select,{name:"tipo",label:"Tipo",placeholder:"Selecione o tipo",children:[e.jsx(c,{value:"residencial",children:"Residencial"}),e.jsx(c,{value:"comercial",children:"Comercial"}),e.jsx(c,{value:"industrial",children:"Industrial"}),e.jsx(c,{value:"rural",children:"Rural"})]})})]}),e.jsx(l.Switch,{name:"preco_negociavel",label:"Preço Negociável"}),e.jsx(l.Number,{name:"itu_anual",label:"ITU Anual (R$)",placeholder:"Ex: 1.200",formatThousands:!0,InputProps:{startAdornment:"R$"}}),e.jsx(l.Text,{name:"observacoes",label:"Observações",placeholder:"Informações adicionais sobre o terreno",multiline:!0,rows:2})]})]}),e.jsxs(N,{sx:{p:3,mt:3},children:[e.jsx(s,{variant:"h6",sx:{mb:3},children:"Localização"}),e.jsxs(u,{spacing:3,children:[e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:8},children:e.jsx(l.Text,{name:"localizacao.endereco",label:"Endereço",placeholder:"Ex: Rua das Flores, 123"})}),e.jsx(p,{size:{xs:12,md:4},children:e.jsx(l.Text,{name:"localizacao.numero",label:"Número",placeholder:"Ex: 123"})})]}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsx(l.Text,{name:"localizacao.bairro",label:"Bairro",placeholder:"Ex: Centro"})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(l.Text,{name:"localizacao.cidade",label:"Cidade",placeholder:"Ex: São Paulo"})})]}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsx(l.Text,{name:"localizacao.estado",label:"Estado",placeholder:"Ex: SP"})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(l.Cep,{name:"localizacao.cep",label:"CEP",placeholder:"Ex: 01234-567"})})]})]})]}),e.jsxs(N,{sx:{p:3,mt:3},children:[e.jsx(s,{variant:"h6",sx:{mb:3},children:"Características"}),e.jsxs(u,{spacing:3,children:[e.jsx(l.Text,{name:"caracteristicas.dimensoes",label:"Dimensões",placeholder:"Ex: 10m x 20m"}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsxs(l.Select,{name:"caracteristicas.formato",label:"Formato",placeholder:"Selecione o formato",children:[e.jsx(c,{value:"retangular",children:"Retangular"}),e.jsx(c,{value:"quadrado",children:"Quadrado"}),e.jsx(c,{value:"irregular",children:"Irregular"}),e.jsx(c,{value:"triangular",children:"Triangular"})]})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsxs(l.Select,{name:"caracteristicas.topografia",label:"Topografia",placeholder:"Selecione a topografia",children:[e.jsx(c,{value:"plano",children:"Plano"}),e.jsx(c,{value:"inclinado",children:"Inclinado"}),e.jsx(c,{value:"aclive",children:"Aclive"}),e.jsx(c,{value:"declive",children:"Declive"}),e.jsx(c,{value:"irregular",children:"Irregular"})]})})]}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsxs(l.Select,{name:"caracteristicas.acesso",label:"Acesso",placeholder:"Selecione o tipo de acesso",children:[e.jsx(c,{value:"asfalto",children:"Asfalto"}),e.jsx(c,{value:"terra",children:"Terra"}),e.jsx(c,{value:"paralelepipedo",children:"Paralelepípedo"}),e.jsx(c,{value:"concreto",children:"Concreto"})]})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsxs(l.Select,{name:"caracteristicas.documentacao",label:"Documentação",placeholder:"Selecione a documentação",children:[e.jsx(c,{value:"escritura",children:"Escritura"}),e.jsx(c,{value:"contrato",children:"Contrato"}),e.jsx(c,{value:"posse",children:"Posse"}),e.jsx(c,{value:"financiado",children:"Financiado"})]})})]})]})]}),e.jsxs(N,{sx:{p:3,mt:3},children:[e.jsx(s,{variant:"h6",sx:{mb:3},children:"Imagens"}),e.jsxs(u,{spacing:1.5,children:[e.jsx(s,{variant:"subtitle2",children:"Fotos do Terreno"}),e.jsx(l.Upload,{multiple:!0,thumbnail:!0,name:"imagens",maxSize:3145728,onRemove:Q,onRemoveAll:oe,onUpload:void 0})]})]})]}),e.jsx(p,{size:{xs:12,md:4},children:e.jsxs(N,{sx:{p:3},children:[e.jsx(s,{variant:"h6",sx:{mb:3},children:"Proprietário"}),e.jsxs(u,{spacing:3,children:[e.jsx(l.Text,{name:"proprietario.nome",label:"Nome",placeholder:"Ex: João Silva"}),e.jsx(l.Text,{name:"proprietario.email",label:"Email",placeholder:"Ex: joao@email.com"}),e.jsx(l.Phone,{name:"proprietario.telefone",label:"Telefone",placeholder:"Ex: (11) 99999-9999",country:"BR"}),e.jsx(l.Document,{name:"proprietario.documento",label:"CPF/CNPJ",placeholder:"Ex: 123.456.789-00"})]})]})})]}),!f&&e.jsxs(g,{sx:{mt:3,gap:2,display:"flex",justifyContent:"flex-end"},children:[e.jsx(pe,{color:"inherit",size:"large",variant:"outlined",onClick:q,children:"Cancelar"}),e.jsxs(pe,{type:"submit",size:"large",variant:"contained",loading:E.value,disabled:a?!v:!1,onClick:()=>{console.log("🖱️ Botão Criar Terreno clicado!"),console.log("📊 Estado do formulário:",A.formState),console.log("❌ Erros de validação:",A.formState.errors),console.log("🔄 Há mudanças:",v),w()},startIcon:e.jsx(O,{icon:"solar:save-bold"}),children:[a?"Atualizar":"Criar"," Terreno"]})]})]})});function Ie(){return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Informações Básicas"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Preencha os dados principais do terreno"})]}),e.jsxs(u,{spacing:3,children:[e.jsx(l.Text,{name:"titulo",label:"Título do Terreno",placeholder:"Ex: Terreno Residencial Vila Nova",required:!0,helperText:"Escolha um título atrativo e descritivo"}),e.jsx(l.Text,{name:"descricao",label:"Descrição",placeholder:"Descreva as características do terreno...",multiline:!0,rows:4,helperText:"Detalhe as principais características e diferenciais do terreno"}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l.Number,{name:"preco",label:"Preço (R$)",placeholder:"Ex: 150000",formatThousands:!0,required:!0,helperText:"Valor de venda do terreno"})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l.Number,{name:"area",label:"Área (m²)",placeholder:"Ex: 500",formatThousands:!0,helperText:"Área total do terreno"})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l.Switch,{name:"precoNegociavel",label:"Preço Negociável",helperText:"Marque se aceita negociação"})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsxs(l.Select,{name:"status",label:"Status",helperText:"Situação atual do terreno",children:[e.jsx(c,{value:"available",children:"Disponível"}),e.jsx(c,{value:"sold",children:"Vendido"}),e.jsx(c,{value:"reserved",children:"Reservado"})]})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsxs(l.Select,{name:"tipo",label:"Tipo",helperText:"Classificação do terreno",children:[e.jsx(c,{value:"residential",children:"Residencial"}),e.jsx(c,{value:"commercial",children:"Comercial"}),e.jsx(c,{value:"industrial",children:"Industrial"}),e.jsx(c,{value:"rural",children:"Rural"})]})})]})]})]})})}const De=[{value:"AC",label:"Acre (AC)"},{value:"AL",label:"Alagoas (AL)"},{value:"AP",label:"Amapá (AP)"},{value:"AM",label:"Amazonas (AM)"},{value:"BA",label:"Bahia (BA)"},{value:"CE",label:"Ceará (CE)"},{value:"DF",label:"Distrito Federal (DF)"},{value:"ES",label:"Espírito Santo (ES)"},{value:"GO",label:"Goiás (GO)"},{value:"MA",label:"Maranhão (MA)"},{value:"MT",label:"Mato Grosso (MT)"},{value:"MS",label:"Mato Grosso do Sul (MS)"},{value:"MG",label:"Minas Gerais (MG)"},{value:"PA",label:"Pará (PA)"},{value:"PB",label:"Paraíba (PB)"},{value:"PR",label:"Paraná (PR)"},{value:"PE",label:"Pernambuco (PE)"},{value:"PI",label:"Piauí (PI)"},{value:"RJ",label:"Rio de Janeiro (RJ)"},{value:"RN",label:"Rio Grande do Norte (RN)"},{value:"RS",label:"Rio Grande do Sul (RS)"},{value:"RO",label:"Rondônia (RO)"},{value:"RR",label:"Roraima (RR)"},{value:"SC",label:"Santa Catarina (SC)"},{value:"SP",label:"São Paulo (SP)"},{value:"SE",label:"Sergipe (SE)"},{value:"TO",label:"Tocantins (TO)"}];function Ve(){return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Localização"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Informe o endereço completo do terreno"})]}),e.jsxs(u,{spacing:3,children:[e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:8,children:e.jsx(l.Text,{name:"endereco.rua",label:"Rua",placeholder:"Ex: Rua das Flores",required:!0,helperText:"Nome da rua, avenida ou logradouro"})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l.Text,{name:"endereco.numero",label:"Número",placeholder:"Ex: 123",required:!0,helperText:"Número do imóvel"})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"endereco.bairro",label:"Bairro",placeholder:"Ex: Centro",required:!0,helperText:"Nome do bairro"})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"endereco.cidade",label:"Cidade",placeholder:"Ex: São Paulo",required:!0,helperText:"Nome da cidade"})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsxs(l.Select,{name:"endereco.estado",label:"Estado (UF)",placeholder:"Selecione o estado",required:!0,helperText:"Selecione o estado brasileiro",children:[e.jsx(c,{value:"",disabled:!0,children:"Selecione o estado"}),De.map(a=>e.jsx(c,{value:a.value,children:a.label},a.value))]})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Cep,{name:"endereco.cep",label:"CEP",placeholder:"Ex: 01234-567",required:!0,helperText:"Código postal da região"})})]})]})]})})}function Ae(){return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Características"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Detalhe as características físicas do terreno"})]}),e.jsxs(u,{spacing:3,children:[e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(l.Select,{name:"topografia",label:"Topografia",helperText:"Formato do terreno",children:[e.jsx(c,{value:"flat",children:"Plano"}),e.jsx(c,{value:"sloped",children:"Inclinado"}),e.jsx(c,{value:"irregular",children:"Irregular"})]})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(l.Select,{name:"tipoAcesso",label:"Tipo de Acesso",helperText:"Condição da via de acesso",children:[e.jsx(c,{value:"paved",children:"Asfaltado"}),e.jsx(c,{value:"dirt",children:"Terra"}),e.jsx(c,{value:"cobblestone",children:"Paralelepípedo"})]})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l.Switch,{name:"temDocumentacao",label:"Tem Documentação",helperText:"Possui documentação regularizada"})})]}),e.jsx(l.Text,{name:"dimensoes",label:"Dimensões",placeholder:"Ex: 20m x 25m ou 500m²",helperText:"Informe as medidas do terreno (opcional)"})]})]})})}function Fe(){return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Imagens do Terreno"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Adicione fotos que destacam as características do terreno"})]}),e.jsxs(u,{spacing:3,children:[e.jsx(l.Upload,{name:"imagens",multiple:!0,thumbnail:!0,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"]},helperText:"Arraste e solte as imagens aqui ou clique para selecionar",sx:{"& .MuiBox-root":{minHeight:200,borderRadius:2,border:"2px dashed",borderColor:"divider","&:hover":{borderColor:"primary.main",bgcolor:"action.hover"}}}}),e.jsx(g,{sx:{p:3,bgcolor:"background.neutral",borderRadius:2,border:"1px dashed",borderColor:"divider"},children:e.jsxs(u,{spacing:2,children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{icon:"solar:camera-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"subtitle2",color:"primary.main",children:"Dicas para boas fotos"})]}),e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:"• Tire fotos em diferentes ângulos do terreno"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"• Inclua fotos da frente, fundos e laterais"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"• Fotografe durante o dia com boa iluminação"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"• Mostre a vista e o entorno do terreno"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"• Destaque características especiais (árvores, declive, etc.)"})]})]})})]})]})})}function Me(){return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Dados do Proprietário"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Informe os dados de contato do proprietário do terreno"})]}),e.jsxs(u,{spacing:3,children:[e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"proprietario.nome",label:"Nome do Proprietário",placeholder:"Ex: João Silva",required:!0,helperText:"Nome completo do proprietário"})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"proprietario.email",label:"Email",placeholder:"Ex: joao@email.com",required:!0,helperText:"Email para contato"})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Phone,{name:"proprietario.telefone",label:"Telefone",placeholder:"(11) 99999-9999",required:!0,helperText:"Telefone com DDD"})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsx(l.Document,{name:"proprietario.documento",label:"CPF/CNPJ",placeholder:"123.456.789-00 ou 12.345.678/0001-90",required:!0,helperText:"Documento de identificação"})})]})]})]})})}function we(){var v,T,I,V,z,A,L,W,D,F,y;const{watch:a}=Ce(),n=a(),f=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m||0),h=m=>({available:"Disponível",sold:"Vendido",reserved:"Reservado"})[m]||m,B=m=>({residential:"Residencial",commercial:"Comercial",industrial:"Industrial",rural:"Rural"})[m]||m,E=m=>({flat:"Plano",sloped:"Inclinado",irregular:"Irregular"})[m]||m,P=m=>({paved:"Asfaltado",dirt:"Terra",cobblestone:"Paralelepípedo"})[m]||m;return e.jsx(N,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(u,{spacing:1,children:[e.jsx(s,{variant:"h5",sx:{fontWeight:600},children:"Revisão dos Dados"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Confira todas as informações antes de finalizar o cadastro"})]}),e.jsxs(u,{spacing:4,children:[e.jsxs(g,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(O,{icon:"solar:home-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"h6",color:"primary.main",children:"Informações Básicas"})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsxs(t,{item:!0,xs:12,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Título"}),e.jsx(s,{variant:"body1",sx:{fontWeight:500},children:n.titulo||"Não informado"})]}),n.descricao&&e.jsxs(t,{item:!0,xs:12,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Descrição"}),e.jsx(s,{variant:"body2",children:n.descricao})]}),e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Preço"}),e.jsxs(s,{variant:"body1",sx:{fontWeight:600,color:"success.main"},children:[f(n.preco),n.precoNegociavel&&e.jsx(se,{label:"Negociável",size:"small",color:"info",sx:{ml:1}})]})]}),n.area&&e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Área"}),e.jsxs(s,{variant:"body1",children:[n.area.toLocaleString("pt-BR")," m²"]})]}),e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Status"}),e.jsx(se,{label:h(n.status),color:n.status==="available"?"success":"default",size:"small"})]}),e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Tipo"}),e.jsx(s,{variant:"body1",children:B(n.tipo)})]})]})]}),e.jsx(Z,{}),e.jsxs(g,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(O,{icon:"solar:map-point-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"h6",color:"primary.main",children:"Localização"})]}),e.jsxs(s,{variant:"body1",children:[(v=n.endereco)==null?void 0:v.rua,", ",(T=n.endereco)==null?void 0:T.numero]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[(I=n.endereco)==null?void 0:I.bairro,", ",(V=n.endereco)==null?void 0:V.cidade," - ",(z=n.endereco)==null?void 0:z.estado]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["CEP: ",(A=n.endereco)==null?void 0:A.cep]})]}),e.jsx(Z,{}),e.jsxs(g,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(O,{icon:"solar:settings-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"h6",color:"primary.main",children:"Características"})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Topografia"}),e.jsx(s,{variant:"body1",children:E(n.topografia)})]}),e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Tipo de Acesso"}),e.jsx(s,{variant:"body1",children:P(n.tipoAcesso)})]}),e.jsxs(t,{item:!0,xs:12,md:4,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Documentação"}),e.jsx(se,{label:n.temDocumentacao?"Regularizada":"Pendente",color:n.temDocumentacao?"success":"warning",size:"small"})]}),n.dimensoes&&e.jsxs(t,{item:!0,xs:12,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Dimensões"}),e.jsx(s,{variant:"body1",children:n.dimensoes})]})]})]}),e.jsx(Z,{}),e.jsxs(g,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(O,{icon:"solar:camera-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"h6",color:"primary.main",children:"Imagens"})]}),e.jsxs(s,{variant:"body1",children:[((L=n.imagens)==null?void 0:L.length)||0," imagem(ns) selecionada(s)"]})]}),e.jsx(Z,{}),e.jsxs(g,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(O,{icon:"solar:user-bold",sx:{color:"primary.main"}}),e.jsx(s,{variant:"h6",color:"primary.main",children:"Proprietário"})]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsxs(t,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Nome"}),e.jsx(s,{variant:"body1",children:((W=n.proprietario)==null?void 0:W.nome)||"Não informado"})]}),e.jsxs(t,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Email"}),e.jsx(s,{variant:"body1",children:((D=n.proprietario)==null?void 0:D.email)||"Não informado"})]}),e.jsxs(t,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Telefone"}),e.jsx(s,{variant:"body1",children:((F=n.proprietario)==null?void 0:F.telefone)||"Não informado"})]}),e.jsxs(t,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"CPF/CNPJ"}),e.jsx(s,{variant:"body1",children:((y=n.proprietario)==null?void 0:y.documento)||"Não informado"})]})]})]})]})]})})}const Be=_({titulo:d().min(1,"Título é obrigatório"),descricao:d().optional(),preco:J.number().min(.01,"Preço deve ser maior que zero"),precoNegociavel:ie().optional(),area:J.number().optional(),status:ee(["available","sold","reserved"]).default("available"),tipo:ee(["residential","commercial","industrial","rural"]).default("residential"),endereco:_({rua:d().min(1,"Rua é obrigatória"),numero:d().min(1,"Número é obrigatório"),bairro:d().min(1,"Bairro é obrigatório"),cidade:d().min(1,"Cidade é obrigatória"),estado:d().min(2,"Estado é obrigatório").max(2,"Use a sigla do estado"),cep:d().min(8,"CEP deve ter 8 dígitos")}),topografia:ee(["flat","sloped","irregular"]).default("flat"),tipoAcesso:ee(["paved","dirt","cobblestone"]).default("paved"),temDocumentacao:ie().default(!1),dimensoes:d().optional(),imagens:je(ze(File)).optional(),proprietario:_({nome:d().min(1,"Nome do proprietário é obrigatório"),email:d().email("Email inválido").min(1,"Email é obrigatório"),telefone:d().min(1,"Telefone é obrigatório"),documento:d().min(1,"CPF/CNPJ é obrigatório")})}),G=[{label:"Informações Básicas",description:"Título, preço e detalhes gerais",component:Ie,fields:["titulo","descricao","preco","precoNegociavel","area","status","tipo"]},{label:"Localização",description:"Endereço completo do terreno",component:Ve,fields:["endereco.rua","endereco.numero","endereco.bairro","endereco.cidade","endereco.estado","endereco.cep"]},{label:"Características",description:"Topografia e tipo de acesso",component:Ae,fields:["topografia","tipoAcesso","temDocumentacao","dimensoes"]},{label:"Imagens",description:"Fotos do terreno",component:Fe,fields:["imagens"]},{label:"Proprietário",description:"Dados do proprietário",component:Me,fields:["proprietario.nome","proprietario.email","proprietario.telefone","proprietario.documento"]},{label:"Revisão",description:"Confirme os dados antes de salvar",component:we,fields:[]}];function Le(){console.log("🚀🚀🚀 TerrenoWizardForm component loaded - WIZARD FORM ATIVO 🚀🚀🚀");const a=ue(),n=xe(),{currentRealEstate:f}=he(),[h,B]=b.useState(0),[E,P]=b.useState({}),[v,T]=b.useState(!1),[I,V]=b.useState(""),z=ge({resolver:ve(Be),mode:"onChange",defaultValues:{titulo:"",descricao:"",preco:0,precoNegociavel:!1,area:0,status:"available",tipo:"residential",endereco:{rua:"",numero:"",bairro:"",cidade:"",estado:"",cep:""},topografia:"flat",tipoAcesso:"paved",temDocumentacao:!1,dimensoes:"",imagens:[],proprietario:{nome:"",email:"",telefone:"",documento:""}}}),{handleSubmit:A,reset:L,trigger:W,watch:D,formState:{errors:F}}=z,y=D(["titulo","preco"]);console.log("👀 Valores observados:",{titulo:y[0],preco:y[1]});const m=()=>h===G.length-1,R=b.useCallback(async()=>{console.log("🔍 validateCurrentStep - activeStep:",h);const r=G[h].fields;if(console.log("🔍 currentStepFields:",r),r.length===0)return console.log("✅ Etapa de revisão - sem validação necessária"),!0;if(h===0){console.log("🔍 Etapa 1 - validando campos obrigatórios");const x=["titulo","preco"];try{const o=z.getValues();console.log("🔍 Valores atuais:",{titulo:o.titulo,preco:o.preco,area:o.area,status:o.status,tipo:o.tipo});const j=(await Promise.all(x.map(async C=>{const M=await W(C);return console.log(`🔍 Campo ${C} válido:`,M),M}))).every(C=>C===!0);return console.log("🔍 Resultado final etapa 1:",j),console.log("🔍 Erros atuais:",F),j}catch(o){return console.error("🔍 Erro na validação da etapa 1:",o),!1}}if(h===1){const o=z.getValues().endereco,S=(o==null?void 0:o.rua)&&o.rua.trim().length>0,j=(o==null?void 0:o.numero)&&o.numero.trim().length>0,C=(o==null?void 0:o.bairro)&&o.bairro.trim().length>0,M=(o==null?void 0:o.cidade)&&o.cidade.trim().length>0,k=(o==null?void 0:o.estado)&&o.estado.trim().length>0,Y=(o==null?void 0:o.cep)&&o.cep.trim().length>=8,U=S&&j&&C&&M&&k&&Y;return console.log("🔍 Resultado etapa 2 (localização):",U),U}if(h===4){const o=z.getValues().proprietario,S=(o==null?void 0:o.nome)&&o.nome.trim().length>0,j=(o==null?void 0:o.email)&&o.email.trim().length>0&&o.email.includes("@"),C=(o==null?void 0:o.telefone)&&o.telefone.trim().length>0,M=(o==null?void 0:o.documento)&&o.documento.trim().length>0,k=S&&j&&C&&M;return console.log("🔍 Resultado etapa 5 (proprietário):",k),k}return console.log("🔍 Etapa opcional:",h),!0},[h,z]),Q=()=>G[h].fields.filter(o=>{const S=o.split(".");let j=F;for(const C of S)j=j==null?void 0:j[C];return j}).length>0?"Por favor, preencha todos os campos obrigatórios desta etapa.":"Todos os campos desta etapa estão válidos!";b.useEffect(()=>{console.log("🔄 useEffect de validação executado - activeStep:",h),console.log("🔄 Dependências do useEffect:",{activeStep:h,errorsCount:Object.keys(F).length,formValid:v,watchedValues:{titulo:y[0],preco:y[1]}});const x=setTimeout(async()=>{console.log("🔄 Iniciando validação..."),console.log("🔄 Estado atual antes da validação:",{formValid:v});const o=await R();console.log("🔄 Resultado da validação:",o),console.log("🔄 Estado anterior formValid:",v),v!==o?(console.log("🔄 Estado formValid vai mudar de",v,"para",o),T(o)):console.log("🔄 Estado formValid permanece o mesmo:",o),V(Q()),console.log("🔄 Validação concluída")},100);return()=>clearTimeout(x)},[h,R,F,v,y]);const oe=async()=>{if(!await R()){V(Q());return}const x={...E};x[h]=!0,P(x),m()||(B(o=>o+1),V(""))},K=()=>{B(r=>r-1),V("")},q=A(async r=>{console.log("🎯 Submetendo formulário wizard:",r),n.onTrue();try{f!=null&&f.id||console.log("⚠️ Nenhuma imobiliária selecionada. Usando ID padrão para teste.");const x={name:r.titulo,title:r.titulo,description:r.descricao||"Terreno criado via formulário wizard",totalArea:r.area,value:r.preco,status:r.status,type:r.tipo,acceptsFinancing:r.precoNegociavel||!1,address:{street:r.endereco.rua,number:r.endereco.numero,neighborhood:r.endereco.bairro,city:r.endereco.cidade,state:r.endereco.estado,zipCode:r.endereco.cep},owner:{name:r.proprietario.nome,email:r.proprietario.email,phone:r.proprietario.telefone,document:r.proprietario.documento},topography:r.topografia,dimensions:r.dimensoes||"",accessType:r.tipoAcesso,hasDocumentation:r.temDocumentacao,imagens:r.imagens||[],realEstateId:(f==null?void 0:f.id)||"test-real-estate-id"};console.log("Dados para API:",x),await fe(x),H.success("Terreno criado com sucesso!"),L(),a.push(ae.dashboard.terrenos.root)}catch(x){console.error("Erro ao criar terreno:",x),H.error("Erro ao criar terreno. Verifique os dados e tente novamente.")}finally{n.onFalse()}}),w=()=>{const r=G[h].component;return e.jsx(r,{})},i=(h+1)/G.length*100;return e.jsx(be,{methods:z,onSubmit:q,children:e.jsxs(g,{sx:{width:"100%",maxWidth:1200,mx:"auto",p:3},children:[e.jsx(g,{sx:{mb:4,textAlign:"center"},children:e.jsxs(g,{sx:{mb:3},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Etapa ",h+1," de ",G.length]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[Math.round(i),"% concluído"]})]}),e.jsx(Ee,{variant:"determinate",value:i,sx:{height:8,borderRadius:4,backgroundColor:"grey.200","& .MuiLinearProgress-bar":{borderRadius:4,background:E[h]?"linear-gradient(90deg, #4caf50 0%, #66bb6a 100%)":"linear-gradient(90deg, #1976d2 0%, #42a5f5 100%)"}}})]})}),I&&e.jsx(Pe,{severity:v?"success":"warning",sx:{mb:3,borderRadius:2},children:I}),e.jsx(g,{sx:{mb:4,backgroundColor:"background.paper",borderRadius:3,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",overflow:"hidden",transition:"all 0.3s ease-in-out","&:hover":{boxShadow:"0 8px 30px rgba(0, 0, 0, 0.12)"}},children:w()}),e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(X,{disabled:h===0,onClick:K,variant:"outlined",size:"large",sx:{minWidth:120},children:"Voltar"}),e.jsxs(g,{sx:{display:"flex",gap:2},children:[e.jsx(X,{variant:"outlined",size:"large",onClick:()=>a.push(ae.dashboard.terrenos.root),disabled:n.value,children:"Cancelar"}),m()?e.jsx(X,{type:"submit",variant:"contained",size:"large",loading:n.value,disabled:!v,sx:{minWidth:140,bgcolor:"success.main","&:hover":{bgcolor:"success.dark"}},children:"Finalizar"}):e.jsx(X,{onClick:oe,variant:"contained",size:"large",disabled:!v,sx:{minWidth:140,bgcolor:v?"black":"grey.400",color:v?"white":"text.disabled","&:hover":{bgcolor:v?"#333":"grey.500",color:v?"white":"inherit"},"&:disabled":{bgcolor:"grey.300",color:"text.disabled"}},children:"Continuar"})]})]})]})})}export{Le as T,_e as a};

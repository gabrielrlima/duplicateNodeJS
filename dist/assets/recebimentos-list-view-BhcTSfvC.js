import{_ as u,Y as w,b0 as B,j as e,b1 as L,b2 as N,b3 as y,R as I,I as g,f as D,br as G,B as d,S as f,A as U,aJ as H,df as q,aK as J,a$ as K,aP as $,a1 as T,bX as X,aj as O,r as b,au as Q,a0 as Y,dL as F,bh as Z,bc as R,dM as ee,bd as te,dO as ae,cN as E,cV as se,bj as oe,p as P,l as ne,U as le,n as re,a_ as ie,bp as ce,dQ as de}from"./index-cNRh_qft.js";import{C as _}from"./confirm-dialog-V5NQjZtL.js";import{u as me,g as ue,r as pe,e as he,T as xe}from"./table-no-data-CeEeU6Ls.js";import{T as ge}from"./table-empty-rows-BTCIE_YQ.js";import{T as be}from"./table-head-custom-DSpcVu4-.js";import{T as je}from"./table-selected-action-DJkdQzwk.js";import{T as fe}from"./table-pagination-custom-xTp1jojO.js";import{T as A,a as ye,b as Ce}from"./TableHead-DBnjkyMB.js";import{T as j}from"./TableCell-CGwO8Re3.js";import{C as ve}from"./Card-C_-31fGp.js";const De=[{value:"pending",label:"Pendente"},{value:"confirmed",label:"Confirmado"},{value:"paid",label:"Pago"},{value:"overdue",label:"Vencido"},{value:"cancelled",label:"Cancelado"}],Te=Array.from({length:20},(t,a)=>{const r={id:u.id(a),name:u.fullName(a),email:u.email(a),avatarUrl:u.image.avatar(a),phone:u.phoneNumber(a)},c={id:u.id(a+20),name:u.productName(a),address:u.fullAddress(a),city:u.countryNames(a%20),state:["SP","RJ","MG","RS","PR"][a%5],zipCode:`${String(Math.floor(Math.random()*9e4)+1e4)}-${String(Math.floor(Math.random()*900)+100)}`,type:["Apartamento","Casa","Terreno","Comercial"][a%4],rentValue:`R$ ${(1e3+a*200).toLocaleString("pt-BR")},00`},m={method:["PIX","Boleto","Cartão de Crédito","Transferência"][a%4],reference:`REF${String(a+1).padStart(6,"0")}`},s=[{type:"payment_created",title:"Recebimento criado",message:"Recebimento foi criado no sistema",time:u.time(1),by:"Sistema"},...a%3===0?[{type:"payment_confirmed",title:"Pagamento confirmado",message:"Pagamento foi confirmado pelo cliente",time:u.time(2),by:r.name}]:[],...a%4===0?[{type:"payment_received",title:"Pagamento realizado",message:"Pagamento foi processado com sucesso",time:u.time(3),by:"Sistema"}]:[]],l=a%4===0?"paid":a%3===0?"confirmed":a%5===0?"overdue":a%7===0?"cancelled":"pending";return{id:u.id(a),receiptNumber:`REC${String(a+1).padStart(6,"0")}`,description:`Parcela ${a%12+1}/12 - ${c.name}`,amount:u.number.price(a)*100,status:l,dueDate:u.time(a+1),paidDate:l==="paid"?u.time(a+2):null,createdAt:u.time(0),customer:r,property:c,payment:l!=="pending"?m:null,history:s,installment:a%12+1,totalInstallments:12}});function Re({row:t,selected:a,onSelectRow:r,onDeleteRow:c,detailsHref:m}){const s=w(),l=B(),h=w(),i=()=>e.jsxs(A,{hover:!0,selected:a,children:[e.jsx(j,{padding:"checkbox",children:e.jsx(G,{checked:a,onClick:r,inputProps:{id:`row-checkbox-${t.id}`,"aria-label":"Row checkbox"}})}),e.jsx(j,{children:e.jsx(d,{sx:{cursor:"pointer"},onClick:h.onToggle,children:e.jsx(d,{sx:{typography:"body2",color:"text.primary"},children:t.receiptNumber})})}),e.jsx(j,{children:e.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(U,{alt:t.customer.name,src:t.customer.avatarUrl}),e.jsxs(d,{children:[e.jsx(d,{sx:{typography:"subtitle2"},children:t.customer.name}),e.jsx(d,{sx:{typography:"body2",color:"text.secondary"},children:t.customer.email})]})]})}),e.jsx(j,{children:e.jsx(H,{primary:J(t.dueDate),secondary:q(t.dueDate),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsx(j,{align:"center",children:e.jsxs(d,{sx:{typography:"body2"},children:[t.installment,"/",t.totalInstallments]})}),e.jsx(j,{children:e.jsx(d,{sx:{typography:"subtitle2"},children:K(t.amount)})}),e.jsx(j,{children:e.jsxs($,{variant:"soft",color:t.status==="paid"&&"success"||t.status==="confirmed"&&"info"||t.status==="pending"&&"warning"||t.status==="overdue"&&"error"||t.status==="cancelled"&&"default"||"default",children:[t.status==="paid"&&"Pago",t.status==="confirmed"&&"Confirmado",t.status==="pending"&&"Pendente",t.status==="overdue"&&"Vencido",t.status==="cancelled"&&"Cancelado"]})}),e.jsxs(j,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(T,{color:h.value?"inherit":"default",onClick:h.onToggle,sx:{...h.value&&{bgcolor:"action.hover"}},children:e.jsx(g,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(T,{color:l.open?"inherit":"default",onClick:l.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})]})]}),n=()=>e.jsx(A,{children:e.jsx(j,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(X,{in:h.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(O,{sx:{m:1.5},children:e.jsxs(f,{direction:"row",alignItems:"center",sx:[x=>({p:x.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:`solid 2px ${x.vars.palette.background.neutral}`}})],children:[e.jsxs(d,{sx:{flexGrow:1},children:[e.jsx(d,{sx:{typography:"subtitle2"},children:t.description}),e.jsxs(d,{sx:{typography:"body2",color:"text.secondary"},children:["Imóvel: ",t.property.name]}),e.jsxs(d,{sx:{typography:"body2",color:"text.secondary"},children:["Endereço: ",t.property.address]}),t.payment&&e.jsxs(d,{sx:{typography:"body2",color:"text.secondary"},children:["Método: ",t.payment.method," - Ref: ",t.payment.reference]})]}),e.jsx(d,{sx:{width:110,textAlign:"right"},children:e.jsx(D,{component:I,href:m,color:"inherit",variant:"outlined",size:"small",children:"Ver detalhes"})})]})})})})});return e.jsxs(e.Fragment,{children:[i(),n(),e.jsx(L,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(N,{children:[e.jsxs(y,{component:I,href:m,onClick:()=>{l.onClose()},children:[e.jsx(g,{icon:"solar:eye-bold"}),"Ver detalhes"]}),e.jsxs(y,{onClick:()=>{s.onTrue(),l.onClose()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Excluir"]})]})}),e.jsx(_,{open:s.value,onClose:s.onFalse,title:"Excluir recebimento",content:"Tem certeza que deseja excluir este recebimento?",action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{c(),s.onFalse()},children:"Excluir"})})]})}function Pe({filters:t,onResetPage:a,dateError:r}){const c=B(),{state:m,setState:s}=t,l=b.useCallback(n=>{a(),s({name:n.target.value})},[a,s]),h=b.useCallback(n=>{a(),s({startDate:n})},[a,s]),i=b.useCallback(n=>{a(),s({endDate:n})},[a,s]);return e.jsxs(e.Fragment,{children:[e.jsxs(d,{sx:[n=>({p:2.5,pr:{xs:2.5,md:1},display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"},columnGap:2,rowGap:1.5})],children:[e.jsxs(d,{sx:[{display:"flex",alignItems:"center",columnGap:2,rowGap:1.5,flexDirection:{xs:"column",sm:"row"},width:{xs:1,md:1}}],children:[e.jsx(Q,{fullWidth:!0,value:m.name,onChange:l,placeholder:"Buscar cliente ou número do recebimento...",InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(F,{label:"Data inicial",value:m.startDate,onChange:h,slotProps:{textField:{fullWidth:!0}},sx:{minWidth:{md:180}}}),e.jsx(F,{label:"Data final",value:m.endDate,onChange:i,slotProps:{textField:{fullWidth:!0,error:r,helperText:r&&"A data final deve ser posterior à data inicial"}},sx:[{minWidth:{md:180},[`& .${Z.root}`]:{position:{md:"absolute"},bottom:{md:-40}}}]})]}),e.jsx(d,{sx:{display:"flex",alignItems:"center",flexShrink:0},children:e.jsx(T,{onClick:c.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(L,{open:c.open,anchorEl:c.anchorEl,onClose:c.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(N,{children:[e.jsxs(y,{onClick:()=>{c.onClose()},children:[e.jsx(g,{icon:"solar:printer-minimalistic-bold"}),"Imprimir"]}),e.jsxs(y,{onClick:()=>{c.onClose()},children:[e.jsx(g,{icon:"solar:import-bold"}),"Importar"]}),e.jsxs(y,{onClick:()=>{c.onClose()},children:[e.jsx(g,{icon:"solar:export-bold"}),"Exportar"]})]})})]})}function Se({filters:t,totalResults:a,onResetPage:r,sx:c,...m}){const{state:s,setState:l}=t,h=b.useCallback(()=>{r(),l({name:""})},[r,l]),i=b.useCallback(()=>{r(),l({status:"all"})},[r,l]),n=b.useCallback(()=>{r(),l({startDate:null,endDate:null})},[r,l]),x=b.useCallback(()=>{r(),l({name:"",status:"all",startDate:null,endDate:null})},[r,l]);return e.jsxs(f,{spacing:1.5,sx:[{p:1},...Array.isArray(c)?c:[c]],...m,children:[e.jsxs(d,{sx:{typography:"body2"},children:[e.jsx("strong",{children:a}),e.jsx(d,{component:"span",sx:{color:"text.secondary",ml:.25},children:"resultados encontrados"})]}),e.jsxs(f,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[!!s.name&&e.jsx(S,{label:"Busca:",children:e.jsx(R,{size:"small",label:s.name,onDelete:h})}),s.status!=="all"&&e.jsx(S,{label:"Status:",children:e.jsx(R,{size:"small",label:s.status,onDelete:i})}),!!s.startDate&&!!s.endDate&&e.jsx(S,{label:"Data:",children:e.jsx(R,{size:"small",label:ee(s.startDate,s.endDate),onDelete:n})}),e.jsx(D,{color:"error",onClick:x,startIcon:e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),children:"Limpar"})]})]})}function S({label:t,children:a}){return e.jsxs(f,{component:O,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,bgcolor:"unset"},children:[e.jsx(d,{component:"span",sx:{typography:"subtitle2"},children:t}),e.jsx(f,{spacing:1,direction:"row",flexWrap:"wrap",children:a})]})}const we=[{value:"all",label:"Todos"},...De],ke=[{id:"receiptNumber",label:"Número",width:120},{id:"customer",label:"Cliente"},{id:"dueDate",label:"Vencimento",width:140},{id:"installment",label:"Parcela",width:120,align:"center"},{id:"amount",label:"Valor",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}];function Me(){var k;const t=me({defaultOrderBy:"receiptNumber"}),a=w(),[r,c]=b.useState(Te),m=te({name:"",status:"all",startDate:null,endDate:null}),{state:s,setState:l}=m,h=ae(s.startDate,s.endDate),i=Ie({inputData:r,comparator:ue(t.order,t.orderBy),filters:s,dateError:h}),n=pe(i,t.page,t.rowsPerPage),x=!!s.name||s.status!=="all"||!!s.startDate&&!!s.endDate,C=!i.length&&x||!i.length,z=b.useCallback(o=>{const p=r.filter(v=>v.id!==o);E.success("Recebimento excluído com sucesso!"),c(p),t.onUpdatePageDeleteRow(n.length)},[n.length,t,r]),M=b.useCallback(()=>{const o=r.filter(p=>!t.selected.includes(p.id));E.success("Recebimentos excluídos com sucesso!"),c(o),t.onUpdatePageDeleteRows(n.length,i.length)},[i.length,n.length,t,r]),V=b.useCallback((o,p)=>{t.onResetPage(),l({status:p})},[l,t]),W=()=>e.jsx(_,{open:a.value,onClose:a.onFalse,title:"Excluir recebimentos",content:e.jsxs(e.Fragment,{children:["Tem certeza que deseja excluir ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," recebimentos?"]}),action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{M(),a.onFalse()},children:"Excluir"})});return e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(oe,{heading:"Recebimentos",links:[{name:"Dashboard",href:P.dashboard.root},{name:"Recebimentos",href:((k=P.dashboard.recebimentos)==null?void 0:k.root)||"#"},{name:"Lista"}],sx:{mb:{xs:3,md:5}}}),e.jsxs(ve,{children:[e.jsx(ne,{value:s.status,onChange:V,sx:[o=>({px:2.5,boxShadow:`inset 0 -2px 0 0 ${le(o.vars.palette.grey["500Channel"],.08)}`})],children:we.map(o=>e.jsx(re,{iconPosition:"end",value:o.value,label:o.label,icon:e.jsx($,{variant:(o.value==="all"||o.value===s.status)&&"filled"||"soft",color:o.value==="paid"&&"success"||o.value==="confirmed"&&"info"||o.value==="pending"&&"warning"||o.value==="overdue"&&"error"||o.value==="cancelled"&&"default"||"default",children:["paid","confirmed","pending","overdue","cancelled"].includes(o.value)?r.filter(p=>p.status===o.value).length:r.length})},o.value))}),e.jsx(Pe,{filters:m,onResetPage:t.onResetPage,dateError:h}),x&&e.jsx(Se,{filters:m,totalResults:i.length,onResetPage:t.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(d,{sx:{position:"relative"},children:[e.jsx(je,{dense:t.dense,numSelected:t.selected.length,rowCount:i.length,onSelectAllRows:o=>t.onSelectAllRows(o,i.map(p=>p.id)),action:e.jsx(ie,{title:"Excluir",children:e.jsx(T,{color:"primary",onClick:a.onTrue,children:e.jsx(g,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ce,{sx:{minHeight:444},children:e.jsxs(ye,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(be,{order:t.order,orderBy:t.orderBy,headCells:ke,rowCount:i.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:o=>t.onSelectAllRows(o,i.map(p=>p.id))}),e.jsxs(Ce,{children:[i.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(o=>{var p,v;return e.jsx(Re,{row:o,selected:t.selected.includes(o.id),onSelectRow:()=>t.onSelectRow(o.id),onDeleteRow:()=>z(o.id),detailsHref:((v=(p=P.dashboard.recebimentos)==null?void 0:p.details)==null?void 0:v.call(p,o.id))||`#${o.id}`},o.id)}),e.jsx(ge,{height:t.dense?56:76,emptyRows:he(t.page,t.rowsPerPage,i.length)}),e.jsx(xe,{notFound:C,title:"Nenhum recebimento encontrado"})]})]})})]}),e.jsx(fe,{page:t.page,dense:t.dense,count:i.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]})]}),W()]})}function Ie({inputData:t,comparator:a,filters:r,dateError:c}){const{name:m,status:s,startDate:l,endDate:h}=r,i=t.map((n,x)=>[n,x]);return i.sort((n,x)=>{const C=a(n[0],x[0]);return C!==0?C:n[1]-x[1]}),t=i.map(n=>n[0]),m&&(t=t.filter(n=>n.receiptNumber.toLowerCase().indexOf(m.toLowerCase())!==-1||n.customer.name.toLowerCase().indexOf(m.toLowerCase())!==-1||n.customer.email.toLowerCase().indexOf(m.toLowerCase())!==-1)),s!=="all"&&(t=t.filter(n=>n.status===s)),c||l&&h&&(t=t.filter(n=>de(n.dueDate,l,h))),t}export{Me as R,Te as _,De as a};

import{el as R,X as H,r as S,j as e,cV as M,bj as F,p as P,f as D,I as j,B as f,l as G,n as O,R as W,y as E,z as L,O as k,cN as g,F as z,G as y,K as x,S as C,N as I,T as m,A as _,c5 as T,aS as $,aT as Q,bp as q,bg as K,aV as X,bn as N,Q as h,c2 as J,cz as Y,H as Z,C as V}from"./index-cNRh_qft.js";import{_ as ee}from"./_lead-DI0xvmEs.js";import{a as se}from"./color-preview-C96dy_lS.js";import{C as A}from"./Card-C_-31fGp.js";const ae=[{value:"",label:"Geral",icon:e.jsx(j,{width:24,icon:"solar:user-id-bold"})},{value:"visits",label:"Visitas agendadas",icon:e.jsx(j,{width:24,icon:"solar:calendar-bold"})}],w="tab",ne=k({name:h().min(1,{message:"Nome é obrigatório!"}),email:h().min(1,{message:"Email é obrigatório!"}).email({message:"Email deve ser um endereço de email válido!"}),phoneNumber:h().min(1,{message:"WhatsApp é obrigatório!"}),status:h(),isVerified:N()}),oe=k({title:h().min(1,{message:"Título é obrigatório!"}),notes:h().optional(),privateClient:N(),visitDate:J(s=>T.isDayjs(s),{message:"Data de visita é obrigatória!"}),interestedProduct:h().min(1,{message:"Produto interessado é obrigatório!"}),interestUnit:h().min(1,{message:"Unidade de interesse é obrigatória!"}),color:h()});function B({open:s,onClose:c,lead:r,editVisit:a,onSave:i}){const l=["#22c55e","#06b6d4","#3b82f6","#f59e0b","#f97316","#ef4444"],d={title:(a==null?void 0:a.title)||"",notes:(a==null?void 0:a.notes)||"",privateClient:(a==null?void 0:a.privateClient)||!1,visitDate:a!=null&&a.date?T(a.date):T(),interestedProduct:(a==null?void 0:a.product)||(r==null?void 0:r.productInterest)||"",interestUnit:(a==null?void 0:a.unit)||(r==null?void 0:r.interestUnit)||"",color:(a==null?void 0:a.color)||l[0]},u=E({resolver:L(oe),defaultValues:d}),{control:o,handleSubmit:v,formState:{isSubmitting:n}}=u,p=v(async t=>{try{await new Promise(U=>setTimeout(U,500));const b={id:(a==null?void 0:a.id)||Date.now(),title:t.title,date:t.visitDate.toDate(),notes:t.notes,color:t.color,product:t.interestedProduct,unit:t.interestUnit,status:(a==null?void 0:a.status)||"Agendada",privateClient:t.privateClient};a?(g.success("Visita atualizada com sucesso!"),i==null||i(b)):(g.success("Este lead será adicionado à sua lista de clientes após agendar a visita."),i==null||i(b)),console.info("VISIT DATA",b),c()}catch(b){console.error(b),g.error(a?"Erro ao atualizar visita":"Erro ao agendar visita")}});return e.jsxs($,{open:s,onClose:c,maxWidth:"xs",fullWidth:!0,children:[e.jsx(Q,{children:a?"Editar visita":"Agendar visita"}),e.jsxs(z,{methods:u,onSubmit:p,children:[e.jsx(q,{sx:{p:3,bgcolor:"background.neutral"},children:e.jsxs(C,{spacing:3,children:[e.jsxs(f,{sx:{bgcolor:"info.lighter",p:2,borderRadius:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(j,{icon:"solar:info-circle-bold",sx:{color:"info.main"}}),e.jsx(m,{variant:"body2",sx:{color:"info.dark"},children:"Este lead será adicionado à sua lista de clientes após agendar a visita."})]}),e.jsx(x.Text,{name:"title",label:"Título",placeholder:"Digite o título da visita"}),e.jsx(x.Text,{name:"notes",label:"Anotações",multiline:!0,rows:3,placeholder:"Adicione observações sobre a visita"}),e.jsx(x.Switch,{name:"privateClient",label:"Privar cliente"}),e.jsx(x.MobileDateTimePicker,{name:"visitDate",label:"Quando a visita vai acontecer?"}),e.jsx(K,{name:"color",control:o,render:({field:t})=>e.jsx(se,{value:t.value,onChange:b=>t.onChange(b),options:l})}),e.jsxs(x.Select,{name:"interestedProduct",label:"Produto interessado",children:[e.jsx("option",{value:"",children:"Selecione..."}),e.jsx("option",{value:"Lake House",children:"Lake House"}),e.jsx("option",{value:"Mountain View",children:"Mountain View"}),e.jsx("option",{value:"City Apartment",children:"City Apartment"}),e.jsx("option",{value:"Beach House",children:"Beach House"})]}),e.jsxs(x.Select,{name:"interestUnit",label:"Unidade de interesse",children:[e.jsx("option",{value:"",children:"Selecione..."}),e.jsx("option",{value:"66m2, 99m2",children:"66m2, 99m2"}),e.jsx("option",{value:"45m2, 65m2",children:"45m2, 65m2"}),e.jsx("option",{value:"80m2, 120m2",children:"80m2, 120m2"}),e.jsx("option",{value:"100m2, 150m2",children:"100m2, 150m2"})]})]})}),e.jsxs(X,{sx:{flexShrink:0},children:[e.jsx(D,{variant:"outlined",color:"inherit",onClick:c,children:"Cancelar"}),e.jsx(I,{type:"submit",variant:"contained",loading:n,sx:{bgcolor:"grey.800","&:hover":{bgcolor:"grey.900"}},children:a?"Salvar alterações":"Agendar visita"})]})]})]})}function re({lead:s}){const[c,r]=S.useState([{id:1,title:"Visita Lake House",date:new Date("2024-01-15T14:00:00"),notes:"Cliente interessado em unidade de 99m2",color:"#22c55e",product:"Lake House",unit:"66m2, 99m2",status:"Agendada",privateClient:!1},{id:2,title:"Apresentação Mountain View",date:new Date("2024-01-20T10:30:00"),notes:"Mostrar plantas e localização",color:"#3b82f6",product:"Mountain View",unit:"80m2, 120m2",status:"Confirmada",privateClient:!0}]),[a,i]=S.useState(!1),[l,d]=S.useState(),u=n=>{d(n),i(!0)},o=async n=>{try{r(p=>p.filter(t=>t.id!==n)),g.success("Visita excluída com sucesso!")}catch(p){console.error(p),g.error("Erro ao excluir visita")}},v=n=>{r(p=>p.map(t=>t.id===n.id?n:t)),i(!1),d(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(y,{container:!0,spacing:3,children:c.length===0?e.jsx(y,{size:12,children:e.jsxs(A,{sx:{p:3,textAlign:"center"},children:[e.jsx(j,{icon:"solar:calendar-add-bold-duotone",sx:{width:64,height:64,mx:"auto",mb:2,color:"text.disabled"}}),e.jsx(m,{variant:"h6",sx:{mb:1},children:"Nenhuma visita agendada"}),e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:"As visitas agendadas para este lead aparecerão aqui"})]})}):c.map(n=>e.jsx(y,{size:{xs:12,md:6},children:e.jsx(A,{sx:{p:3},children:e.jsxs(C,{spacing:2,children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(_,{sx:{bgcolor:n.color,width:40,height:40},children:e.jsx(j,{icon:"solar:calendar-bold"})}),e.jsxs(f,{sx:{flex:1},children:[e.jsx(m,{variant:"subtitle1",sx:{fontWeight:600},children:n.title}),e.jsx(m,{variant:"body2",sx:{color:"text.secondary"},children:n.date.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs(f,{children:[e.jsxs(m,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Produto:"})," ",n.product]}),e.jsxs(m,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Unidade:"})," ",n.unit]}),e.jsxs(m,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Status:"})," ",n.status]}),n.notes&&e.jsxs(m,{variant:"body2",sx:{color:"text.secondary"},children:[e.jsx("strong",{children:"Observações:"})," ",n.notes]})]}),e.jsxs(C,{direction:"row",spacing:1,children:[e.jsx(D,{size:"small",variant:"outlined",startIcon:e.jsx(j,{icon:"solar:pen-bold"}),onClick:()=>u(n),children:"Editar"}),e.jsx(D,{size:"small",variant:"outlined",color:"error",startIcon:e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),onClick:()=>o(n.id),children:"Excluir"})]})]})})},n.id))}),e.jsx(B,{open:a,onClose:()=>{i(!1),d(void 0)},lead:s,editVisit:l,onSave:v})]})}function te({lead:s}){const c={status:(s==null?void 0:s.status)||"",isVerified:(s==null?void 0:s.isVerified)||!0,name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phoneNumber:(s==null?void 0:s.phoneNumber)||""},r=E({mode:"onSubmit",resolver:L(ne),defaultValues:c}),{handleSubmit:a,formState:{isSubmitting:i,isDirty:l}}=r,d=a(async u=>{try{await new Promise(o=>setTimeout(o,500)),g.success("Dados atualizados com sucesso!"),console.info("DATA UPDATED",u)}catch(o){console.error(o),g.error("Erro ao atualizar dados")}});return e.jsx(z,{methods:r,onSubmit:d,children:e.jsx(y,{container:!0,spacing:3,children:e.jsx(y,{size:{xs:12},children:e.jsxs(A,{sx:{p:3},children:[e.jsxs(f,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)"}},children:[e.jsx(x.Text,{name:"name",label:"Nome"}),e.jsx(x.Text,{name:"email",label:"Email"}),e.jsx(x.Phone,{name:"phoneNumber",label:"WhatsApp",country:"BR"})]}),e.jsxs(C,{direction:"row",spacing:2,sx:{mt:3,justifyContent:"flex-end"},children:[e.jsx(D,{variant:"contained",color:(s==null?void 0:s.status)==="desativados"?"success":"error",onClick:()=>{(s==null?void 0:s.status)==="desativados"?g.success("Lead será ativado!"):g.warning("Lead será desativado!")},children:(s==null?void 0:s.status)==="desativados"?"Ativar Lead":"Desativar Lead"}),e.jsx(I,{type:"submit",variant:"contained",loading:i,disabled:!l,sx:{bgcolor:"grey.800","&:hover":{bgcolor:"grey.900"}},children:"Salvar ajustes"})]})]})})})})}function ie({lead:s}){const c=R(),a=H().get(w)??"",[i,l]=S.useState(!1),d=(o,v)=>{const n=new URLSearchParams({[w]:v}).toString();return v?`${o}?${n}`:o},u=()=>{l(!0)};return e.jsxs(M,{children:[e.jsx(F,{heading:(s==null?void 0:s.name)||"",links:[{name:"Painel",href:P.dashboard.root},{name:"Leads",href:P.dashboard.lead.list},{name:(s==null?void 0:s.name)||""}],action:e.jsx(D,{variant:"contained",endIcon:e.jsx(j,{icon:"mingcute:heart-fill"}),onClick:u,sx:{bgcolor:"grey.800","&:hover":{bgcolor:"grey.900"}},children:"Agendar visita"}),sx:{mb:{xs:3,md:5}}}),e.jsx(f,{sx:{mb:3},children:e.jsx(G,{value:a,children:ae.map(o=>e.jsx(O,{component:W,value:o.value,icon:o.icon,label:o.label,href:d(c,o.value)},o.value))})}),a===""&&e.jsx(te,{lead:s}),a==="visits"&&e.jsx(re,{lead:s}),e.jsx(B,{open:i,onClose:()=>l(!1),lead:s})]})}const ce={title:`Lead | Dashboard - ${V.appName}`};function xe(){const{id:s=""}=Y(),c=ee.find(r=>r.id===s);return e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsxs("title",{children:[" ",ce.title]})}),e.jsx(ie,{lead:c})]})}export{xe as default};

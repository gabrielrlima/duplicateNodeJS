import{V as F,r as t,j as r,eG as L,cV as N,bj as $,p as c,B as k,N as D,I as B,W as H,H as O,C as P,a8 as q,a9 as z}from"./index-cNRh_qft.js";import{u as V}from"./use-params-DYuE92tD.js";import"./empty-content-BzM3Az2z.js";import{a as G}from"./terreno-wizard-form-CdhYBVNp.js";import"./terreno-B_nrSajh.js";import"./index-ChnT1xRF.js";import"./index-BDJJM9HW.js";import"./Card-C_-31fGp.js";import"./Grid-BAAHJ7js.js";function M({terreno:a,loading:s}){const l=F(),[u,m]=t.useState(!1),n=t.useRef(null);if(s)return r.jsx(L,{});const p=()=>r.jsxs(k,{sx:{display:"flex",gap:1.5},children:[r.jsx(D,{color:"inherit",variant:"outlined",onClick:()=>l.push(c.dashboard.terrenos.root),children:"Cancelar"}),r.jsx(D,{variant:"contained",loading:u,onClick:()=>{var o;return(o=n.current)==null?void 0:o.onSave()},startIcon:r.jsx(B,{icon:"solar:save-bold"}),children:"Atualizar Terreno"})]});return r.jsxs(N,{children:[r.jsx($,{heading:"Editar",backHref:c.dashboard.terrenos.root,links:[{name:"Dashboard",href:c.dashboard.root},{name:"Terrenos",href:c.dashboard.terrenos.root},{name:(a==null?void 0:a.titulo)||"Terreno"}],action:p(),sx:{mb:{xs:3,md:5}}}),r.jsx(G,{currentTerreno:a,ref:n,onLoadingChange:m})]})}const U={title:`Terreno edit | Dashboard - ${P.appName}`};function ae(){const{id:a=""}=V(),{user:s}=H(),[l,u]=t.useState(null),[m,n]=t.useState(!0);return t.useEffect(()=>{(async()=>{var o,g,h,x,b,T,j,S,v,A,w,C,E,I;if(!(!a||!s))try{console.log("Fetching terreno data for edit, ID:",a);const i=localStorage.getItem("currentRealEstate");if(!i){console.error("No current real estate found in localStorage");return}const y=JSON.parse(i);console.log("Current Real Estate:",y);const d=(await q.get(`${z.terreno.list}?real_estate_id=${y.id}`)).data;if(console.log("Terrenos API Response for edit:",d),d.success&&((o=d.data)!=null&&o.terrenos)){const R=d.data.terrenos;console.log("Terrenos found for edit:",R.length);const e=R.find(f=>f.id===a);if(console.log("Final Terreno for edit:",e),e){const f={id:e.id||a,codigo:e.codigo||a.slice(-4).padStart(4,"0"),titulo:e.name||"Terreno",descricao:e.description||"",area:e.totalArea||e.area||0,preco:e.value||e.price||0,precoM2:e.pricePerSquareMeter||(e.value&&e.totalArea?e.value/e.totalArea:0),status:e.status||"available",tipo:e.type||"residencial",negociavel:e.negociavel||!1,destaque:e.destaque||!1,createdAt:e.createdAt||new Date().toISOString(),updatedAt:e.updatedAt||new Date().toISOString(),localizacao:{endereco:(g=e.address)!=null&&g.street&&((h=e.address)!=null&&h.number)?`${e.address.street} ${e.address.number}`.trim():((x=e.address)==null?void 0:x.street)||"",bairro:((b=e.address)==null?void 0:b.neighborhood)||"",cidade:((T=e.address)==null?void 0:T.city)||"",estado:((j=e.address)==null?void 0:j.state)||"",cep:((S=e.address)==null?void 0:S.zipCode)||"",coordenadas:e.coordinates},proprietario:{id:((v=e.owner)==null?void 0:v.id)||e.id||"",nome:((A=e.owner)==null?void 0:A.name)||"",email:((w=e.owner)==null?void 0:w.email)||"",telefone:((C=e.owner)==null?void 0:C.phone)||"",documento:((E=e.owner)==null?void 0:E.document)||"",avatarUrl:((I=e.owner)==null?void 0:I.avatarUrl)||""},caracteristicas:{area:e.totalArea||e.area||0,topografia:e.topography||"",formato:e.dimensions||"",acesso:e.accessType||"",documentacao:e.hasDocumentation?"sim":"n√£o"},imagens:e.images||[]};u(f)}}}catch(i){console.error("Error fetching terreno for edit:",i)}finally{n(!1)}})()},[a,s]),r.jsxs(r.Fragment,{children:[r.jsx(O,{children:r.jsxs("title",{children:[" ",U.title]})}),r.jsx(M,{terreno:l,loading:m})]})}export{ae as default};

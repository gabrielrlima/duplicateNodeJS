import{a9 as R,bk as U,r as f,j as e,B as i,ay as Q,I as a,S as u,U as B,ax as Y,f as V,bp as G,C as L,s as M,A as K,aJ as re,T as y,q as te,u as O,a as H,au as Z,a0 as ee,a1 as p,Y as k,ez as ae,fp as ie,aj as le,de as q,fq as se,eG as ce,aP as de,cn as xe,cI as pe,cH as he,br as X,a_ as N,d1 as ue,L as fe,be as J,bX as me,dv as je,V as ge,X as be,p as A,cV as ye,H as ve}from"./index-cNRh_qft.js";import{u as P}from"./index-ChnT1xRF.js";import{k as we}from"./keyBy-Dc3MaNHd.js";import{E}from"./empty-content-BzM3Az2z.js";import{S}from"./Skeleton-XGh2Uz0E.js";import{M as ke}from"./markdown-sdGgeBYa.js";import"./index-BDJJM9HW.js";import"./html-to-markdown-wPkGdeP1.js";const _={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function Ce(){const s=R.mail.labels,{data:n,isLoading:o,error:r,isValidating:t}=P(s,U,_);return f.useMemo(()=>({labels:(n==null?void 0:n.labels)||[],labelsLoading:o,labelsError:r,labelsValidating:t,labelsEmpty:!o&&!t&&!(n!=null&&n.labels.length)}),[n==null?void 0:n.labels,r,o,t])}function Ie(s){const n=s?[R.mail.list,{params:{labelId:s}}]:"",{data:o,isLoading:r,error:t,isValidating:l}=P(n,U,_);return f.useMemo(()=>{const x=o!=null&&o.mails.length?we(o==null?void 0:o.mails,m=>m.id):{},h=Object.keys(x);return{mails:{byId:x,allIds:h},mailsLoading:r,mailsError:t,mailsValidating:l,mailsEmpty:!r&&!l&&!h.length}},[o==null?void 0:o.mails,t,r,l])}function Se(s){const n=s?[R.mail.details,{params:{mailId:s}}]:"",{data:o,isLoading:r,error:t,isValidating:l}=P(n,U,_);return f.useMemo(()=>({mail:o==null?void 0:o.mail,mailLoading:r,mailError:t,mailValidating:l,mailEmpty:!r&&!l&&!(o!=null&&o.mail)}),[o==null?void 0:o.mail,t,r,l])}const Le={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function Me({selected:s,label:n,onClickNavItem:o,...r}){const t=Le[n.id];return e.jsx(i,{component:"li",sx:{display:"flex"},children:e.jsxs(Q,{disableGutters:!0,onClick:o,sx:{pl:1,pr:1.5,gap:2,borderRadius:.75,color:"text.secondary",...s&&{color:"text.primary"}},...r,children:[e.jsx(a,{icon:t,width:22,sx:{color:n.color}}),e.jsx(i,{component:"span",sx:{flexGrow:1,textTransform:"capitalize",typography:s?"subtitle2":"body2"},children:n.name}),!!n.unreadCount&&e.jsx(i,{component:"span",sx:{typography:"caption"},children:n.unreadCount})]})})}function Te({itemCount:s=6,sx:n,...o}){return Array.from({length:s},(r,t)=>e.jsxs(i,{sx:[l=>({py:1,gap:2,display:"flex",alignItems:"center",color:B(l.vars.palette.grey["500Channel"],.24)}),...Array.isArray(n)?n:[n]],...o,children:[e.jsx(S,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(S,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]},t))}function Ae({sx:s,itemCount:n=6,...o}){return Array.from({length:n},(r,t)=>e.jsxs(i,{sx:[{py:1,gap:2,display:"flex",alignItems:"center"},...Array.isArray(s)?s:[s]],...o,children:[e.jsx(S,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(u,{spacing:1,flexGrow:1,children:[e.jsx(S,{sx:{width:.75,height:10}}),e.jsx(S,{sx:{width:.5,height:10}})]})]},t))}function De({isEmpty:s,loading:n,labels:o,openNav:r,onCloseNav:t,onClickLabel:l,selectedLabelId:d,onToggleCompose:x}){const h=()=>e.jsx(u,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(Te,{})}),m=()=>e.jsx(u,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(E,{title:"No labels",imgUrl:`${L.assetsDir}/assets/icons/empty/ic-folder-empty.svg`})}),w=()=>s?m():e.jsx(G,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(i,{component:"ul",sx:{pb:1.5,px:{xs:1.5,md:.5}},children:o.map(j=>e.jsx(Me,{label:j,selected:d===j.id,onClickNavItem:()=>l(j.id)},j.id))})})}),v=()=>e.jsxs(e.Fragment,{children:[e.jsx(i,{sx:{p:{xs:2.5,md:"16px 12px"}},children:e.jsx(V,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(a,{icon:"solar:pen-bold"}),onClick:x,children:"Compose"})}),n?h():w()]});return e.jsxs(e.Fragment,{children:[v(),e.jsx(Y,{open:r,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:v()})]})}function Ee({slots:s,slotProps:n,sx:o,...r}){return e.jsxs($e,{sx:o,...r,children:[s.header,e.jsxs(ze,{...n==null?void 0:n.container,children:[e.jsx(Fe,{...n==null?void 0:n.nav,children:s.nav}),e.jsx(Ne,{...n==null?void 0:n.list,children:s.list}),e.jsx(We,{...n==null?void 0:n.details,children:s.details})]})]})}const $e=M("div")(()=>({display:"flex",flexDirection:"column"})),ze=M("div")(({theme:s})=>({gap:s.spacing(1),display:"flex",flex:"1 1 auto",overflow:"hidden"})),Fe=M("div")(({theme:s})=>({display:"none",flex:"0 0 200px",overflow:"hidden",flexDirection:"column",[s.breakpoints.up("md")]:{display:"flex"}})),Ne=M("div")(({theme:s})=>({display:"none",flex:"0 0 320px",overflow:"hidden",flexDirection:"column",borderRadius:s.shape.borderRadius*1.5,backgroundColor:s.vars.palette.background.default,[s.breakpoints.up("md")]:{display:"flex"}})),We=M("div")(({theme:s})=>({minWidth:0,display:"flex",flex:"1 1 auto",overflow:"hidden",flexDirection:"column",borderRadius:s.shape.borderRadius*1.5,backgroundColor:s.vars.palette.background.default}));function Be({mail:s,selected:n,sx:o,...r}){return e.jsx(i,{component:"li",sx:{display:"flex"},children:e.jsxs(Q,{disableGutters:!0,sx:[{p:1,gap:2,borderRadius:1,...n&&{bgcolor:"action.selected"}},...Array.isArray(o)?o:[o]],...r,children:[e.jsx(K,{alt:s.from.name,src:s.from.avatarUrl??"",children:s.from.name.charAt(0).toUpperCase()}),e.jsx(re,{primary:s.from.name,secondary:s.message,slotProps:{primary:{noWrap:!0},secondary:{noWrap:!0,sx:{...s.isUnread&&{color:"text.primary",fontWeight:"fontWeightSemiBold"}}}}}),e.jsxs(i,{sx:{display:"flex",alignSelf:"stretch",alignItems:"flex-end",flexDirection:"column"},children:[e.jsx(y,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:te(s.createdAt)}),!!s.isUnread&&e.jsx(i,{component:"span",sx:{width:8,height:8,borderRadius:"50%",bgcolor:"info.main"}})]})]})})}function Re({isEmpty:s,loading:n,mails:o,openMail:r,onCloseMail:t,onClickMail:l,selectedMailId:d,selectedLabelId:x}){const h=O(),m=H(h.breakpoints.up("md")),w=()=>e.jsx(u,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(Ae,{})}),v=()=>e.jsx(u,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(E,{title:`Nothing in ${x}`,description:"This folder is empty",imgUrl:`${L.assetsDir}/assets/icons/empty/ic-folder-empty.svg`})}),j=()=>s?v():e.jsx(G,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(i,{component:"ul",sx:{px:2,pb:1,gap:.5,display:"flex",flexDirection:"column"},children:o.allIds.map(c=>e.jsx(Be,{mail:o.byId[c],selected:d===c,onClick:()=>l(c)},c))})})}),C=()=>e.jsxs(e.Fragment,{children:[e.jsx(u,{sx:{p:2},children:m?e.jsx(Z,{placeholder:"Pesquisar...",slotProps:{input:{startAdornment:e.jsx(ee,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}}):e.jsx(y,{variant:"h6",sx:{textTransform:"capitalize"},children:x})}),n?w():j()]});return e.jsxs(e.Fragment,{children:[C(),e.jsx(Y,{open:r,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:C()})]})}function Ue({onOpenNav:s,onOpenMail:n,sx:o,...r}){return e.jsxs(i,{sx:[()=>({py:1,mb:1,display:"flex",alignItems:"center"}),...Array.isArray(o)?o:[o]],...r,children:[e.jsx(p,{onClick:s,children:e.jsx(a,{icon:"fluent:mail-24-filled"})}),n&&e.jsx(p,{onClick:n,children:e.jsx(a,{icon:"solar:chat-round-dots-bold"})}),e.jsx(Z,{fullWidth:!0,size:"small",placeholder:"Pesquisar...",slotProps:{input:{startAdornment:e.jsx(ee,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}},sx:{ml:2}})]})}const D=20;function Ve({onCloseCompose:s}){const n=O(),o=H(n.breakpoints.up("sm")),r=k(),[t,l]=f.useState(""),d=f.useCallback(x=>{l(x)},[]);return f.useEffect(()=>(r.value?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r.value]),e.jsxs(ae,{children:[(r.value||!o)&&e.jsx(ie,{open:!0,sx:[{zIndex:n.zIndex.modal-1}]}),e.jsxs(le,{sx:[{maxWidth:560,right:D,borderRadius:2,display:"flex",bottom:D,position:"fixed",overflow:"hidden",flexDirection:"column",zIndex:n.zIndex.modal,width:`calc(100% - ${D*2}px)`,boxShadow:n.vars.customShadows.dropdown,...r.value&&{maxWidth:1,height:`calc(100% - ${D*2}px)`}}],children:[e.jsxs(i,{sx:[{display:"flex",alignItems:"center",bgcolor:"background.neutral",p:n.spacing(1.5,1,1.5,2)}],children:[e.jsx(y,{variant:"h6",sx:{flexGrow:1},children:"New message"}),e.jsx(p,{onClick:r.onToggle,children:e.jsx(a,{icon:r.value?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(p,{onClick:s,children:e.jsx(a,{icon:"mingcute:close-line"})})]}),e.jsx(q,{id:"mail-compose-to",placeholder:"To",endAdornment:e.jsxs(i,{sx:{gap:.5,display:"flex",typography:"subtitle2"},children:[e.jsx(i,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(i,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:[{px:2,height:48,borderBottom:`solid 1px ${B(n.vars.palette.grey["500Channel"],.08)}`}]}),e.jsx(q,{id:"mail-compose-subject",placeholder:"Subject",sx:[{px:2,height:48,borderBottom:`solid 1px ${B(n.vars.palette.grey["500Channel"],.08)}`}]}),e.jsxs(u,{spacing:2,flexGrow:1,sx:{p:2,flex:"1 1 auto",overflow:"hidden"},children:[e.jsx(se,{value:t,onChange:d,placeholder:"Type a message",slotProps:{wrapper:{...r.value&&{minHeight:0,flex:"1 1 auto"}}},sx:{maxHeight:480,...r.value&&{maxHeight:1,flex:"1 1 auto"}}}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(i,{sx:{flexGrow:1,display:"flex",alignItems:"center"},children:[e.jsx(p,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:attach-2-fill"})})]}),e.jsx(V,{variant:"contained",color:"primary",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}function Ge({mail:s,renderLabel:n,isEmpty:o,error:r,loading:t}){const l=k(!0),d=k(s==null?void 0:s.isStarred),x=k(s==null?void 0:s.isImportant);if(t)return e.jsx(ce,{});if(r)return e.jsx(E,{title:r,imgUrl:`${L.assetsDir}/assets/icons/empty/ic-email-disabled.svg`});if(o)return e.jsx(E,{title:"No conversation selected",description:"Select a conversation to read",imgUrl:`${L.assetsDir}/assets/icons/empty/ic-email-selected.svg`});const h=()=>e.jsxs(e.Fragment,{children:[e.jsx(i,{sx:{gap:1,flexGrow:1,display:"flex"},children:s==null?void 0:s.labelIds.map(c=>{const g=n==null?void 0:n(c);return g?e.jsx(de,{sx:[T=>({color:pe(g.color,.24),bgcolor:xe(g.color,.16),...T.applyStyles("dark",{color:he(g.color,.24)})})],children:g.name},g.id):null})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(X,{color:"warning",icon:e.jsx(a,{icon:"eva:star-outline"}),checkedIcon:e.jsx(a,{icon:"eva:star-fill"}),checked:d.value,onChange:d.onToggle,inputProps:{id:"starred-checkbox","aria-label":"Starred checkbox"}}),e.jsx(X,{color:"warning",icon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checked:x.value,onChange:x.onToggle,inputProps:{id:"important-checkbox","aria-label":"Important checkbox"}}),e.jsx(N,{title:"Archive",children:e.jsx(p,{children:e.jsx(a,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(N,{title:"Mark Unread",children:e.jsx(p,{children:e.jsx(a,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(N,{title:"Trash",children:e.jsx(p,{children:e.jsx(a,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:more-vertical-fill"})})]})]}),m=()=>e.jsxs(e.Fragment,{children:[e.jsxs(y,{variant:"subtitle2",sx:[c=>({...c.mixins.maxLine({line:2}),flex:"1 1 auto"})],children:["Re: ",s==null?void 0:s.subject]}),e.jsxs(u,{spacing:.5,children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:reply-bold"})}),e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(y,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:ue(s==null?void 0:s.createdAt)})]})]}),w=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{alt:s==null?void 0:s.from.name,src:s!=null&&s.from.avatarUrl?`${s==null?void 0:s.from.avatarUrl}`:"",sx:{mr:2},children:s==null?void 0:s.from.name.charAt(0).toUpperCase()}),e.jsxs(u,{spacing:.5,sx:{width:0,flexGrow:1},children:[e.jsxs(i,{sx:{gap:.5,display:"flex"},children:[e.jsx(y,{component:"span",variant:"subtitle2",sx:{flexShrink:0},children:s==null?void 0:s.from.name}),e.jsx(y,{component:"span",noWrap:!0,variant:"body2",sx:{color:"text.secondary"},children:`<${s==null?void 0:s.from.email}>`})]}),e.jsxs(y,{noWrap:!0,component:"span",variant:"caption",sx:{color:"text.secondary"},children:["To: ",s==null?void 0:s.to.map(c=>e.jsx(fe,{color:"inherit",sx:{"&:hover":{color:"text.primary"}},children:`${c.email}, `},c.email))]})]})]}),v=()=>e.jsxs(u,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(J,{onClick:l.onToggle,sx:{borderRadius:.5,typography:"caption",color:"text.secondary"},children:[e.jsx(a,{icon:"eva:attach-2-fill",sx:{mr:.5}}),s==null?void 0:s.attachments.length," attachments",e.jsx(a,{icon:l.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsxs(J,{sx:{py:.5,gap:.5,px:.75,borderRadius:.75,typography:"caption",fontWeight:"fontWeightSemiBold"},children:[e.jsx(a,{width:18,icon:"eva:cloud-download-fill"})," Download"]})]}),e.jsx(me,{in:l.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(i,{sx:{gap:.75,display:"flex",flexWrap:"wrap"},children:s==null?void 0:s.attachments.map(c=>e.jsx(je,{tooltip:!0,imageView:!0,file:c.preview,onDownload:()=>console.info("DOWNLOAD"),slotProps:{icon:{sx:{width:24,height:24}}},sx:{width:48,height:48,bgcolor:"background.paper"}},c.id))})})]}),j=()=>e.jsx(ke,{children:s==null?void 0:s.message,sx:{px:2,"& p":{typography:"body2"}}}),C=()=>e.jsxs(e.Fragment,{children:[e.jsx(se,{sx:{maxHeight:320}}),e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(p,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:attach-2-fill"})}),e.jsx(u,{sx:{flexGrow:1}}),e.jsx(V,{color:"primary",variant:"contained",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return s&&e.jsxs(e.Fragment,{children:[e.jsx(i,{sx:{pl:2,pr:1,height:56,flexShrink:0,display:"flex",alignItems:"center"},children:h()}),e.jsx(i,{sx:[c=>({p:2,gap:2,flexShrink:0,display:"flex",borderTop:`1px dashed ${c.vars.palette.divider}`,borderBottom:`1px dashed ${c.vars.palette.divider}`})],children:m()}),e.jsx(i,{sx:{pt:2,px:2,flexShrink:0,display:"flex",alignItems:"center"},children:w()}),!!(s!=null&&s.attachments.length)&&e.jsxs(u,{sx:{px:2,mt:2},children:[" ",v()," "]}),e.jsx(G,{sx:{mt:3,flex:"1 1 240px"},children:j()}),e.jsx(u,{spacing:2,sx:{flexShrink:0,p:2},children:C()})]})}const W="inbox";function Oe(){const s=ge(),n=O(),o=H(n.breakpoints.up("md")),r=be(),t=r.get("label")??W,l=r.get("id")??"",d=k(),x=k(),h=k(),{labels:m,labelsLoading:w,labelsEmpty:v}=Ce(),{mail:j,mailLoading:C,mailError:c}=Se(l),{mails:g,mailsLoading:T,mailsEmpty:$}=Ie(t),z=g.allIds[0]||"",ne=f.useCallback(()=>{d.value&&d.onFalse(),h.onToggle()},[h,d]),oe=f.useCallback(b=>{o||d.onFalse();const I=b!==W?`${A.dashboard.mail}?label=${b}`:A.dashboard.mail;t!==b&&f.startTransition(()=>{s.push(I)})},[o,t,d,s]),F=f.useCallback(b=>{o||x.onFalse();const I=t!==W?`${A.dashboard.mail}?id=${b}&label=${t}`:`${A.dashboard.mail}?id=${b}`;l!==b&&f.startTransition(()=>{s.push(I)})},[o,x,s,t,l]);return f.useEffect(()=>{!l&&z&&F(z)},[z,F,l]),e.jsxs(e.Fragment,{children:[e.jsxs(ye,{maxWidth:!1,sx:{flex:"1 1 auto",display:"flex",flexDirection:"column"},children:[e.jsx(y,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsx(Ee,{sx:{p:1,borderRadius:2,flex:"1 1 auto",bgcolor:"background.neutral"},slots:{header:e.jsx(Ue,{onOpenNav:d.onTrue,onOpenMail:$?void 0:x.onTrue,sx:{display:{md:"none"}}}),nav:e.jsx(De,{labels:m,isEmpty:v,loading:w,openNav:d.value,onCloseNav:d.onFalse,selectedLabelId:t,onClickLabel:oe,onToggleCompose:ne}),list:e.jsx(Re,{mails:g,isEmpty:$,loading:T,openMail:x.value,onCloseMail:x.onFalse,onClickMail:F,selectedLabelId:t,selectedMailId:l}),details:e.jsx(Ge,{mail:j,isEmpty:$,error:c==null?void 0:c.message,loading:T||C,renderLabel:b=>m.find(I=>I.id===b)})}})]}),h.value&&e.jsx(Ve,{onCloseCompose:h.onFalse})]})}const He={title:`Mail | Dashboard - ${L.appName}`};function Ze(){return e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsxs("title",{children:[" ",He.title]})}),e.jsx(Oe,{})]})}export{Ze as default};

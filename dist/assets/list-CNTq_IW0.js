import{y as Q,z as $,O as G,c5 as R,j as e,aS as K,aT as Z,F as J,aU as Y,aq as X,B as j,K as C,ez as ee,cd as v,aV as se,f as w,N as ae,Q as y,a3 as te,V as ne,ca as V,Y as E,b1 as oe,A as le,S as P,L as re,aK as N,d0 as L,aP as O,a1 as I,I as D,cb as U,cc as W,R as M,p as S,r as f,bJ as z,dM as ie,dL as ce,dJ as de,dN as ue,dy as B,au as me,a0 as pe,a_ as k,e1 as he,dC as xe,b8 as je,aZ as ge,l as fe,U as be,n as Ce,c3 as ve,c4 as ye,H as De,C as Te}from"./index-D82XrlGq.js";import{C as H}from"./confirm-dialog-rvtuH5TT.js";import{u as Se,g as we,r as Pe,e as ke,T as Fe}from"./table-no-data-DH7CjOyR.js";import{T as Ae}from"./table-empty-rows-Vu5FyjZw.js";import{T as Re}from"./table-head-custom-CuFVaOdc.js";import{T as Ee}from"./table-selected-action-B1DH3GwP.js";import{T as Ie}from"./table-pagination-custom-D5_o9sKp.js";import{s as q}from"./schema-helper-BcHhi0sG.js";import{b as Ne,T as Le,a as ze}from"./TableHead-RMfhpLqX.js";import{T}from"./TableCell-9zzJlMjB.js";import{F as Be,a as F,c as A}from"./filters-result-BUC8QtIh.js";import{C as qe}from"./Card-Bw-3A9ev.js";import"./empty-content-CAmd9egU.js";import"./TablePagination-DsJAP4En.js";import"./LastPage-xOhVKZvt.js";import"./Toolbar-CnhKmG_y.js";const Ve=G({name:y().min(1,{message:"Name is required!"}),email:y().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),phoneNumber:q.phoneNumber({isValid:te}),country:q.nullableInput(y().min(1,{message:"Country is required!"}),{message:"Country is required!"}),state:y().min(1,{message:"State is required!"}),city:y().min(1,{message:"City is required!"}),address:y().min(1,{message:"Address is required!"}),zipCode:y().min(1,{message:"Zip code is required!"}),company:y().min(1,{message:"Company is required!"}),role:y().min(1,{message:"Role is required!"}),status:y()});function Oe({currentClient:s,open:d,onClose:l}){const g={name:"",email:"",phoneNumber:"",address:"",country:"",state:"",city:"",zipCode:"",status:"",company:"",role:""},n=Q({mode:"all",resolver:$(Ve),defaultValues:g,values:s}),{reset:a,handleSubmit:o,formState:{isSubmitting:r}}=n,h=o(async p=>{const i=new Promise(m=>setTimeout(m,1e3));try{a(),l(),R.promise(i,{loading:"Loading...",success:"Update success!",error:"Update error!"}),await i,console.info("DATA",p)}catch(m){console.error(m)}});return e.jsxs(K,{fullWidth:!0,maxWidth:!1,open:d,onClose:l,PaperProps:{sx:{maxWidth:720}},children:[e.jsx(Z,{children:"Quick update"}),e.jsxs(J,{methods:n,onSubmit:h,children:[e.jsxs(Y,{children:[e.jsx(X,{variant:"outlined",severity:"info",sx:{mb:3},children:"Account is waiting for confirmation"}),e.jsxs(j,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(C.Select,{name:"status",label:"Status",children:ee.map(p=>e.jsx(v,{value:p.value,children:p.label},p.value))}),e.jsx(j,{sx:{display:{xs:"none",sm:"block"}}}),e.jsx(C.Text,{name:"name",label:"Full name"}),e.jsx(C.Text,{name:"email",label:"Email address"}),e.jsx(C.Phone,{name:"phoneNumber",label:"Phone number"}),e.jsx(C.CountrySelect,{fullWidth:!0,name:"country",label:"Country",placeholder:"Choose a country"}),e.jsx(C.Text,{name:"state",label:"State/region"}),e.jsx(C.Text,{name:"city",label:"City"}),e.jsx(C.Text,{name:"address",label:"Address"}),e.jsx(C.Text,{name:"zipCode",label:"Zip/code"}),e.jsx(C.Text,{name:"company",label:"Company"}),e.jsx(C.Text,{name:"role",label:"Role"})]})]}),e.jsxs(se,{children:[e.jsx(w,{variant:"outlined",onClick:l,children:"Cancel"}),e.jsx(ae,{type:"submit",variant:"contained",loading:r,children:"Update"})]})]})]})}function Ue({row:s,selected:d,editHref:l,onSelectRow:g,onDeleteRow:n}){const a=ne(),o=V(),r=E(),h=E(),p=()=>{a.push(S.dashboard.client.profile(s.id))},i=()=>e.jsx(Oe,{currentClient:s,open:h.value,onClose:h.onFalse}),m=()=>e.jsx(U,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(W,{children:[e.jsx("li",{children:e.jsxs(v,{component:M,href:l,onClick:()=>o.onClose(),children:[e.jsx(D,{icon:"solar:pen-bold"}),"Editar"]})}),e.jsxs(v,{onClick:()=>{r.onTrue(),o.onClose()},sx:{color:"error.main"},children:[e.jsx(D,{icon:"solar:trash-bin-trash-bold"}),"Apagar"]})]})}),c=()=>e.jsx(H,{open:r.value,onClose:r.onFalse,title:"Delete",content:"Você tem certeza que deseja apagar este cliente?",action:e.jsx(w,{variant:"contained",color:"error",onClick:n,children:"Apagar"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Ne,{hover:!0,selected:d,"aria-checked":d,tabIndex:-1,onClick:p,sx:{cursor:"pointer"},children:[e.jsx(T,{padding:"checkbox",onClick:u=>{u.stopPropagation()},children:e.jsx(oe,{checked:d,onClick:u=>{u.stopPropagation(),g()},inputProps:{id:`${s.id}-checkbox`,"aria-label":`${s.id} checkbox`}})}),e.jsx(T,{children:e.jsxs(j,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(le,{alt:s.name,src:s.avatarUrl}),e.jsxs(P,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(re,{color:"inherit",sx:{cursor:"pointer"},children:s.name}),e.jsx(j,{component:"span",sx:{color:"text.disabled"},children:s.phoneNumber})]})]})}),e.jsx(T,{sx:{whiteSpace:"nowrap"},children:e.jsxs(P,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(j,{component:"span",color:"inherit",children:N(s.createdAt)}),e.jsx(j,{component:"span",sx:{color:"text.disabled"},children:L(s.createdAt)})]})}),e.jsx(T,{sx:{whiteSpace:"nowrap"},children:e.jsxs(P,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(j,{component:"span",color:"inherit",children:N(s.updatedAt)}),e.jsx(j,{component:"span",sx:{color:"text.disabled"},children:L(s.updatedAt)})]})}),e.jsxs(T,{sx:{whiteSpace:"nowrap"},children:["R$ ",s.value]}),e.jsx(T,{sx:{whiteSpace:"nowrap"},children:s.product}),e.jsx(T,{children:e.jsx(O,{variant:"soft",color:s.status==="vendido"&&"success"||s.status==="em andamento"&&"warning"||s.status==="vencendo"&&"error"||s.status==="prospecto"&&"info"||"default",children:s.status})}),e.jsx(T,{onClick:u=>{u.stopPropagation()},children:e.jsx(j,{sx:{display:"flex",alignItems:"center"},children:e.jsx(I,{color:o.open?"inherit":"default",onClick:u=>{u.stopPropagation(),o.onOpen(u)},children:e.jsx(D,{icon:"eva:more-vertical-fill"})})})})]}),i(),m(),c()]})}function We({filters:s,options:d,onResetPage:l,dateError:g}){const n=V(),{state:a,setState:o}=s,r=f.useCallback(x=>{l(),o({filterBy:x.target.value})},[l,o]),h=f.useCallback(x=>{l(),o({startDate:x})},[l,o]),p=f.useCallback(x=>{l(),o({endDate:x})},[l,o]),i=f.useCallback(x=>{l(),o({search:x.target.value})},[l,o]),m=()=>e.jsx(U,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(W,{children:[e.jsxs(v,{onClick:()=>n.onClose(),children:[e.jsx(D,{icon:"solar:printer-minimalistic-bold"}),"Imprimir"]}),e.jsxs(v,{onClick:()=>n.onClose(),children:[e.jsx(D,{icon:"solar:import-bold"}),"Importar"]}),e.jsxs(v,{onClick:()=>n.onClose(),children:[e.jsx(D,{icon:"solar:export-bold"}),"Exportar"]})]})}),c=a.startDate?typeof a.startDate=="string"?z(a.startDate):a.startDate:null,u=a.endDate?typeof a.endDate=="string"?z(a.endDate):a.endDate:null;return e.jsxs(e.Fragment,{children:[e.jsxs(j,{sx:{p:2.5,gap:2.5,display:"flex",flexWrap:"wrap",alignItems:"flex-end"},children:[e.jsxs(j,{sx:{width:{xs:"100%",sm:200}},children:[e.jsx(ie,{sx:{mb:1,fontSize:"0.875rem"},children:"Filtrar por"}),e.jsx(ce,{fullWidth:!0,children:e.jsxs(de,{value:a.filterBy||"name",onChange:r,input:e.jsx(ue,{}),displayEmpty:!0,sx:{height:56},children:[e.jsx(v,{value:"name",children:"Nome"}),e.jsx(v,{value:"phoneNumber",children:"Número de Telefone"}),e.jsx(v,{value:"email",children:"Email"}),e.jsx(v,{value:"company",children:"Empresa"}),e.jsx(v,{value:"product",children:"Produto"})]})})]}),e.jsx(j,{sx:{width:{xs:"100%",sm:200}},children:e.jsx(B,{label:"Data inicial",value:c,onChange:h,slotProps:{textField:{fullWidth:!0}}})}),e.jsx(j,{sx:{width:{xs:"100%",sm:200}},children:e.jsx(B,{label:"Data final",value:u,onChange:p,slotProps:{textField:{fullWidth:!0,error:g,helperText:g?"Data final deve ser posterior à data inicial":null}}})}),e.jsx(j,{sx:{flexGrow:1,width:{xs:"100%",sm:"auto"}},children:e.jsx(me,{fullWidth:!0,value:a.search||"",onChange:i,placeholder:"Pesquisar por...",InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(D,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(I,{onClick:n.onOpen,children:e.jsx(D,{icon:"solar:menu-dots-bold"})})]}),m()]})}function Me({filters:s,onResetPage:d,totalResults:l,sx:g}){const{state:n,setState:a,resetState:o}=s,r=f.useCallback(()=>{d(),a({name:""})},[d,a]),h=f.useCallback(()=>{d(),a({status:"todos"})},[d,a]),p=f.useCallback(m=>{const c=n.profession.filter(u=>u!==m);d(),a({profession:c})},[d,a,n.profession]),i=f.useCallback(()=>{d(),o()},[d,o]);return e.jsxs(Be,{totalResults:l,onReset:i,sx:g,children:[e.jsx(F,{label:"Status:",isShow:n.status!=="todos",children:e.jsx(k,{...A,label:n.status,onDelete:h,sx:{textTransform:"capitalize"}})}),e.jsx(F,{label:"Profession:",isShow:!!n.profession.length,children:n.profession.map(m=>f.createElement(k,{...A,key:m,label:m,onDelete:()=>p(m)}))}),e.jsx(F,{label:"Keyword:",isShow:!!n.name,children:e.jsx(k,{...A,label:n.name,onDelete:r})})]})}const He=[{value:"todos",label:"Todos"},{value:"vendido",label:"Vendas"},{value:"em andamento",label:"Em andamento"},{value:"vencendo",label:"Vencendo"},{value:"prospecto",label:"Prospecto"},{value:"desatualizado",label:"Desatualizados"}],_e=[{id:"name",label:"Cliente",width:300},{id:"phoneNumber",label:"Criado em"},{id:"company",label:"Última atualização"},{id:"profession",label:"Valor"},{id:"product",label:"Produto"},{id:"status",label:"Status"},{id:"actions"}];function Qe(){const s=Se(),d=E(),[l,g]=f.useState(he),n=xe({name:"",status:"todos",profession:[],filterBy:"name",startDate:"",endDate:"",search:""}),{state:a,setState:o}=n,r=$e({inputData:l,comparator:we(s.order,s.orderBy),filters:a}),h=Pe(r,s.page,s.rowsPerPage),p=!!a.name||a.profession.length>0||a.status!=="todos"||!!a.search,i=!r.length&&p||!r.length,m=f.useCallback(t=>{const b=l.filter(_=>_.id!==t);R.success("Apagado com sucesso!"),g(b),s.onUpdatePageDeleteRow(h.length)},[h.length,s,l]),c=f.useCallback(()=>{const t=l.filter(b=>!s.selected.includes(b.id));R.success("Apagado com sucesso!"),g(t),s.onUpdatePageDeleteRows(h.length,r.length)},[r.length,h.length,s,l]),u=f.useCallback((t,b)=>{s.onResetPage(),o({status:b})},[o,s]),x=()=>e.jsx(H,{open:d.value,onClose:d.onFalse,title:"Apagar",content:e.jsxs(e.Fragment,{children:["Você tem certeza que deseja apagar os ",e.jsxs("strong",{children:[" ",s.selected.length," "]})," clientes?"]}),action:e.jsx(w,{variant:"contained",color:"error",onClick:()=>{c(),d.onFalse()},children:"Apagar"})});return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx(ge,{heading:"Meus clientes",links:[{name:"Painel",href:S.dashboard.root},{name:"Clientes",href:S.dashboard.client.root},{name:"Meus Clientes"}],action:e.jsx(w,{component:M,href:S.dashboard.client.new,variant:"contained",startIcon:e.jsx(D,{icon:"mingcute:add-line"}),children:"Novo cliente"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(qe,{children:[e.jsx(fe,{value:a.status,onChange:u,sx:[t=>({px:2.5,boxShadow:`inset 0 -2px 0 0 ${be(t.vars.palette.grey["500Channel"],.08)}`})],children:He.map(t=>e.jsx(Ce,{iconPosition:"end",value:t.value,label:t.label,icon:e.jsx(O,{variant:(t.value==="todos"||t.value===a.status)&&"filled"||"soft",color:t.value==="vendido"&&"success"||t.value==="em andamento"&&"warning"||t.value==="vencendo"&&"error"||t.value==="prospectos"&&"info"||"default",children:["active","em andamento","vencendo","desatualizado"].includes(t.value)?l.filter(b=>b.status===t.value).length:l.length})},t.value))}),e.jsx(We,{filters:n,onResetPage:s.onResetPage,options:{filterOptions:["name","phoneNumber","email","company","product"]}}),p&&e.jsx(Me,{filters:n,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(Ee,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:t=>s.onSelectAllRows(t,r.map(b=>b.id)),action:e.jsx(ve,{title:"Apagar",children:e.jsx(I,{color:"primary",onClick:d.onTrue,children:e.jsx(D,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ye,{children:e.jsxs(Le,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Re,{order:s.order,orderBy:s.orderBy,headCells:_e,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:t=>s.onSelectAllRows(t,r.map(b=>b.id))}),e.jsxs(ze,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(t=>e.jsx(Ue,{row:t,selected:s.selected.includes(t.id),onSelectRow:()=>s.onSelectRow(t.id),onDeleteRow:()=>m(t.id),editHref:S.dashboard.client.edit(t.id)},t.id)),e.jsx(Ae,{height:s.dense?56:76,emptyRows:ke(s.page,s.rowsPerPage,r.length)}),e.jsx(Fe,{notFound:i})]})]})})]}),e.jsx(Ie,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]}),x()]})}function $e({inputData:s,comparator:d,filters:l}){const{name:g,status:n,profession:a,filterBy:o,search:r,startDate:h,endDate:p}=l;let i=[...s];const m=i.map((c,u)=>[c,u]);return m.sort((c,u)=>{const x=d(c[0],u[0]);return x!==0?x:c[1]-u[1]}),i=m.map(c=>c[0]),r&&o&&(i=i.filter(c=>{var x;return(((x=c[o])==null?void 0:x.toString().toLowerCase())||"").includes(r.toLowerCase())})),g&&(i=i.filter(c=>c.name.toLowerCase().includes(g.toLowerCase()))),n!=="todos"&&(i=i.filter(c=>c.status===n)),a.length&&(i=i.filter(c=>a.includes(c.profession))),h&&(i=i.filter(c=>new Date(c.createdAt)>=new Date(h))),p&&(i=i.filter(c=>new Date(c.createdAt)<=new Date(p))),i}const Ge={title:`Lista de clientes | Dashboard - ${Te.appName}`};function us(){return e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsxs("title",{children:[" ",Ge.title]})}),e.jsx(Qe,{})]})}export{us as default};

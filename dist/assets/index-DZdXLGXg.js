import{a9 as Pe,bk as Re,r as l,c0 as Y,j as e,s as M,c1 as te,U as R,_ as ee,e0 as Ee,fr as $e,e7 as be,aj as oe,de as ie,bu as V,bw as Ke,b0 as ye,Y as z,B as f,aP as Ue,a1 as E,I as j,b1 as je,b2 as Ce,b3 as J,f as B,cN as re,fs as Be,A as G,bV as We,u as ze,a as Me,a_ as q,be as _e,ft as He,S as Z,T as H,q as Ge,az as Ve,W as qe,ek as Ye,aS as Xe,aT as Qe,fu as de,au as le,a0 as Je,aU as Ze,bb as es,bp as ve,aJ as ss,k as as,c5 as ue,ax as ns,d8 as ts,n as rs,bc as os,aB as is,eH as ls,bq as ke,br as cs,ez as ds,cV as us,aQ as ps,H as xs,C as hs}from"./index-cNRh_qft.js";import{K as U,c as we,g as Te,u as Se,C as ms,d as gs,D as fs,a as bs,b as ys,e as se,f as ae,p as js,h as Cs,M as vs,S as pe,i as ks,v as ws,j as xe,k as Ts,T as Ss,l as Is}from"./sortable.esm-DKy7jZCP.js";import{u as Ds,m as K}from"./index-ChnT1xRF.js";import{E as As}from"./empty-content-BzM3Az2z.js";import{C as Ie}from"./ClickAwayListener-BiY6XgXj.js";import{C as De}from"./confirm-dialog-V5NQjZtL.js";import{A as Fs}from"./AvatarGroup-B32XWlKs.js";import{u as Os}from"./use-date-range-picker-DQjQ1x38.js";import{C as Ls}from"./custom-date-range-picker-DAtmegoI.js";import{U as Ns}from"./upload-box-DTVSHeZi.js";import{u as Ps,L as Rs}from"./use-light-box-Bxjny2_T.js";import{S as X}from"./Skeleton-XGh2Uz0E.js";import"./index-BDJJM9HW.js";const ne=!1,$=Pe.kanban,Es={revalidateIfStale:ne,revalidateOnFocus:ne,revalidateOnReconnect:ne};function $s(){const{data:s,isLoading:n,error:a,isValidating:t}=Ds($,Re,Es);return l.useMemo(()=>{const o=(s==null?void 0:s.board.tasks)??{},u=(s==null?void 0:s.board.columns)??[];return{board:{tasks:o,columns:u},boardLoading:n,boardError:a,boardValidating:t,boardEmpty:!n&&!t&&!u.length}},[s==null?void 0:s.board.columns,s==null?void 0:s.board.tasks,a,n,t])}async function Ks(s){K($,n=>{const{board:a}=n,t=[...a.columns,s],r={...a.tasks,[s.id]:[]};return{...n,board:{...a,columns:t,tasks:r}}},!1)}async function Us(s,n){l.startTransition(()=>{K($,a=>{const{board:t}=a,r=t.columns.map(o=>o.id===s?{...o,name:n}:o);return{...a,board:{...t,columns:r}}},!1)})}async function Bs(s){l.startTransition(()=>{K($,n=>{const{board:a}=n;return{...n,board:{...a,columns:s}}},!1)})}async function Ws(s){l.startTransition(()=>{K($,n=>{const{board:a}=n,t={...a.tasks,[s]:[]};return{...n,board:{...a,tasks:t}}},!1)})}async function zs(s){K($,n=>{const{board:a}=n,t=a.columns.filter(o=>o.id!==s),r=Object.keys(a.tasks).filter(o=>o!==s).reduce((o,u)=>(o[u]=a.tasks[u],o),{});return{...n,board:{...a,columns:t,tasks:r}}},!1)}async function Ms(s,n){l.startTransition(()=>{K($,a=>{const{board:t}=a,r={...t.tasks,[s]:[n,...t.tasks[s]]};return{...a,board:{...t,tasks:r}}},!1)})}async function _s(s,n){l.startTransition(()=>{K($,a=>{const{board:t}=a,o=t.tasks[s].map(x=>x.id===n.id?{...x,...n}:x),u={...t.tasks,[s]:o};return{...a,board:{...t,tasks:u}}},!1)})}async function he(s){l.startTransition(()=>{K($,n=>{const{board:a}=n;return{...n,board:{...a,tasks:s}}},!1)})}async function Hs(s,n){K($,a=>{const{board:t}=a,r={...t.tasks,[s]:t.tasks[s].filter(o=>o.id!==n)};return{...a,board:{...t,tasks:r}}},!1)}const y={item:Y("kanban__item"),column:Y("kanban__column"),itemWrap:Y("kanban__item__wrap"),columnList:Y("kanban__column_list"),state:{fadeIn:"--fade-in",sorting:"--sorting",dragging:"--dragging",disabled:"--disabled",dragOverlay:"--drag-overlay",overContainer:"--over-container"}},Gs=[U.Down,U.Right,U.Up,U.Left],Vs=(s,{context:{active:n,droppableRects:a,droppableContainers:t,collisionRect:r}})=>{var o;if(Gs.includes(s.code)){if(s.preventDefault(),!n||!r)return;const u=[];t.getEnabled().forEach(i=>{var C;if(!i||i!=null&&i.disabled)return;const p=a.get(i.id);if(!p)return;const g=i.data.current;if(g){const{type:v,children:k}=g;if(v==="container"&&(k==null?void 0:k.length)>0&&((C=n.data.current)==null?void 0:C.type)!=="container")return}switch(s.code){case U.Down:r.top<p.top&&u.push(i);break;case U.Up:r.top>p.top&&u.push(i);break;case U.Left:r.left>=p.left+p.width&&u.push(i);break;case U.Right:r.left+r.width<=p.left&&u.push(i);break}});const x=we({collisionRect:r,droppableRects:a,droppableContainers:u}),h=Te(x,"id");if(h!=null){const i=t.get(h),p=i==null?void 0:i.node.current,g=i==null?void 0:i.rect.current;if(p&&g)return i.id==="placeholder"?{x:g.left+(g.width-r.width)/2,y:g.top+(g.height-r.height)/2}:((o=i.data.current)==null?void 0:o.type)==="container"?{x:g.left+20,y:g.top+74}:{x:g.left,y:g.top}}}},qs=l.forwardRef((s,n)=>{const{slots:a,stateProps:t,sx:r,...o}=s;return e.jsxs(Ys,{ref:n,className:te([y.column],{[y.state.dragging]:t==null?void 0:t.dragging,[y.state.dragOverlay]:t==null?void 0:t.dragOverlay,[y.state.overContainer]:t==null?void 0:t.overContainer}),sx:r,...o,children:[(a==null?void 0:a.header)&&a.header,(a==null?void 0:a.action)&&(a==null?void 0:a.action),(a==null?void 0:a.main)&&e.jsx(Xs,{className:y.columnList,children:a.main})]})}),Ae=l.memo(qs),Ys=M("div")(({theme:s})=>{const n={default:{top:0,left:0,content:'""',width:"100%",height:"100%",position:"absolute",borderRadius:"inherit",backgroundColor:"transparent",transition:s.transitions.create(["background-color"])},over:{backgroundColor:R(s.vars.palette.grey["500Channel"],.08),...s.applyStyles("dark",{backgroundColor:R(s.vars.palette.grey["500Channel"],.16)})}};return{flexShrink:0,borderWidth:1,height:"100%",display:"flex",position:"relative",borderStyle:"solid",flexDirection:"column",gap:s.spacing(2.5),borderColor:"transparent",width:"var(--column-width)",padding:"var(--column-padding)",borderRadius:"var(--column-radius)",backgroundColor:s.vars.palette.background.neutral,...s.applyStyles("dark",{backgroundColor:s.vars.palette.grey[800]}),"&::before":n.default,[`&.${y.state.overContainer}`]:{"&::before":n.over},[`&.${y.state.dragOverlay}`]:{backdropFilter:"blur(6px)",borderColor:R(s.vars.palette.grey["500Channel"],.08),backgroundColor:R(s.vars.palette.background.neutralChannel,.48),...s.applyStyles("dark",{backgroundColor:R(s.vars.palette.grey["800Channel"],.48)})},[`&.${y.state.dragging}`]:{opacity:0}}}),Xs=M("ul")(()=>({minHeight:80,display:"flex",gap:"var(--item-gap)",flexDirection:"column"}));function Qs({status:s,openAddTask:n,onAddTask:a,onCloseAddTask:t}){const[r,o]=l.useState(""),u=l.useMemo(()=>({id:be(),status:s,name:r.trim()?r:"Untitled",priority:"medium",attachments:[],labels:[],comments:[],assignee:[],due:[Ee(),$e({days:1})],reporter:{id:ee.id(16),name:ee.fullName(16),avatarUrl:ee.image.avatar(16)}}),[s,r]),x=l.useCallback(p=>{o(p.target.value)},[]),h=l.useCallback(p=>{p.key==="Enter"&&(a(u),o(""))},[u,a]),i=l.useCallback(()=>{o(""),t()},[t]);return n?e.jsx(Ie,{onClickAway:i,children:e.jsxs("div",{children:[e.jsx(oe,{sx:[p=>({borderRadius:1.5,bgcolor:"background.default",boxShadow:p.vars.customShadows.z1})],children:e.jsx(ie,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:r,onChange:x,onKeyUp:h,sx:{px:2,height:56,[`& .${V.input}`]:{p:0,typography:"subtitle2"}}})}),e.jsx(Ke,{sx:{mx:1},children:"Press Enter to create the task."})]})}):null}function Fe({sx:s,...n}){return e.jsx(ie,{sx:[a=>({[`&.${V.root}`]:{py:.75,borderRadius:1,typography:"h6",borderWidth:2,borderStyle:"solid",borderColor:"transparent",transition:a.transitions.create(["padding-left","border-color"]),[`&.${V.focused}`]:{pl:.75,borderColor:"text.primary"}},[`& .${V.input}`]:{typography:"h6"}}),...Array.isArray(s)?s:[s]],...n})}function Oe({sx:s,columnName:n,totalTasks:a,handleProps:t,onClearColumn:r,onToggleAddTask:o,onDeleteColumn:u,onUpdateColumn:x}){const h=l.useId(),i=l.useRef(null),p=ye(),g=z(),[C,v]=l.useState(n);l.useEffect(()=>{p.open&&i.current&&i.current.focus()},[p.open]);const k=l.useCallback(I=>{v(I.target.value)},[]),F=l.useCallback(I=>{I.key==="Enter"&&(i.current&&i.current.blur(),x==null||x(C))},[C,x]),b=()=>e.jsx(je,{open:p.open,anchorEl:p.anchorEl,onClose:p.onClose,children:e.jsxs(Ce,{children:[e.jsxs(J,{onClick:p.onClose,children:[e.jsx(j,{icon:"solar:pen-bold"}),"Rename"]}),e.jsxs(J,{onClick:()=>{r==null||r(),p.onClose()},children:[e.jsx(j,{icon:"solar:eraser-bold"}),"Clear"]}),e.jsxs(J,{onClick:()=>{g.onTrue(),p.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),S=()=>e.jsx(De,{open:g.value,onClose:g.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete column?",e.jsxs(f,{sx:{typography:"caption",color:"error.main",mt:2},children:[e.jsx("strong",{children:" NOTE: "})," All tasks related to this category will also be deleted."]})]}),action:e.jsx(B,{variant:"contained",color:"error",onClick:()=>{u==null||u(),g.onFalse()},children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(f,{sx:[{display:"flex",alignItems:"center"},...Array.isArray(s)?s:[s]],children:[e.jsx(Ue,{sx:[I=>({borderRadius:"50%",borderColor:R(I.vars.palette.grey["500Channel"],.24)})],children:a}),e.jsx(Fe,{inputRef:i,placeholder:"Column name",value:C,onChange:k,onKeyUp:F,inputProps:{id:`${n}-${h}-column-input`},sx:{mx:1}}),e.jsx(E,{size:"small",color:"inherit",onClick:o,children:e.jsx(j,{icon:"solar:add-circle-bold"})}),e.jsx(E,{size:"small",color:p.open?"inherit":"default",onClick:p.onOpen,children:e.jsx(j,{icon:"solar:menu-dots-bold-duotone"})}),e.jsx(E,{size:"small",...t,children:e.jsx(j,{icon:"nimbus:drag-dots"})})]}),b(),S()]})}const Js=s=>gs({...s,wasDragging:!0});function Zs({children:s,column:n,tasks:a,disabled:t,sx:r}){var c;const o=z(),{attributes:u,isDragging:x,listeners:h,setNodeRef:i,transition:p,active:g,over:C,transform:v}=Se({id:n.id,data:{type:"container",children:a},animateLayoutChanges:Js}),k=a.map(m=>m.id),F=C?n.id===C.id&&((c=g==null?void 0:g.data.current)==null?void 0:c.type)!=="container"||k.includes(C.id):!1,b=l.useCallback(async m=>{try{n.name!==m&&(Us(n.id,m),re.success("Update success!",{position:"top-center"}))}catch(w){console.error(w)}},[n.id,n.name]),S=l.useCallback(async()=>{try{Ws(n.id)}catch(m){console.error(m)}},[n.id]),I=l.useCallback(async()=>{try{zs(n.id),re.success("Apagado com sucesso!",{position:"top-center"})}catch(m){console.error(m)}},[n.id]),P=l.useCallback(async m=>{try{Ms(n.id,m),o.onFalse()}catch(w){console.error(w)}},[n.id,o]);return e.jsx(Ae,{ref:t?void 0:i,style:{transition:p,transform:ms.Translate.toString(v)},sx:r,stateProps:{dragging:x,overContainer:F,handleProps:{...u,...h}},slots:{header:e.jsx(Oe,{handleProps:{...u,...h},totalTasks:a.length,columnName:n.name,onUpdateColumn:b,onClearColumn:S,onDeleteColumn:I,onToggleAddTask:o.onToggle}),main:s,action:e.jsx(Qs,{status:n.name,openAddTask:o.value,onAddTask:P,onCloseAddTask:o.onFalse})}})}const ea=l.forwardRef((s,n)=>{const{task:a,open:t,stateProps:r,sx:o,...u}=s,{fadeIn:x,sorting:h,disabled:i,dragging:p,dragOverlay:g,transition:C,transform:v,listeners:k}=r??{};l.useEffect(()=>{if(g)return document.body.style.cursor="grabbing",()=>{document.body.style.cursor=""}},[g]);const F=()=>e.jsx(j,{icon:a.priority==="low"&&"solar:double-alt-arrow-down-bold-duotone"||a.priority==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{top:4,right:4,position:"absolute",...a.priority==="low"&&{color:"info.main"},...a.priority==="medium"&&{color:"warning.main"},...a.priority==="hight"&&{color:"error.main"}}}),b=()=>{var I,P,c;return!!((I=a==null?void 0:a.attachments)!=null&&I.length)&&e.jsx(f,{sx:{p:"8px 8px 0 8px"},children:e.jsx(ta,{open:t,className:Be.root,alt:(P=a==null?void 0:a.attachments)==null?void 0:P[0],src:(c=a==null?void 0:a.attachments)==null?void 0:c[0]})})},S=()=>{var I,P,c,m,w;return e.jsxs(f,{sx:{display:"flex",alignItems:"center",mt:2},children:[e.jsxs(f,{sx:{flexGrow:1,display:"flex",alignItems:"center",typography:"caption",color:"text.disabled"},children:[!!((I=a==null?void 0:a.comments)!=null&&I.length)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{width:16,icon:"solar:chat-round-dots-bold",sx:{mr:.25}}),e.jsx(f,{component:"span",sx:{mr:1},children:(P=a==null?void 0:a.comments)==null?void 0:P.length})]}),!!((c=a==null?void 0:a.attachments)!=null&&c.length)&&e.jsxs(e.Fragment,{children:[e.jsx(j,{width:16,icon:"eva:attach-2-fill",sx:{mr:.25}}),e.jsx(f,{component:"span",children:(m=a==null?void 0:a.attachments)==null?void 0:m.length})]})]}),e.jsx(Fs,{sx:{[`& .${We.avatar}`]:{width:24,height:24}},children:(w=a==null?void 0:a.assignee)==null?void 0:w.map(T=>e.jsx(G,{alt:T.name,src:T.avatarUrl},T.id))})]})};return e.jsx(sa,{ref:n,className:te([y.itemWrap],{[y.state.fadeIn]:x,[y.state.dragOverlay]:g}),style:{...!!C&&{transition:C},...!!v&&{"--translate-x":`${Math.round(v.x)}px`,"--translate-y":`${Math.round(v.y)}px`,"--scale-x":`${v.scaleX}`,"--scale-y":`${v.scaleY}`}},children:e.jsxs(aa,{className:te([y.item],{[y.state.sorting]:h,[y.state.dragging]:p,[y.state.disabled]:i,[y.state.dragOverlay]:g}),"data-cypress":"draggable-item",tabIndex:0,sx:o,...k,...u,children:[b(),e.jsxs(na,{children:[F(),a.name,S()]})]})})}),ce=l.memo(ea),sa=M("li")(()=>({"@keyframes fadeIn":{"0%":{opacity:0},"100%":{opacity:1}},display:"flex",transform:"translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1))",transformOrigin:"0 0",touchAction:"manipulation",[`&.${y.state.fadeIn}`]:{animation:"fadeIn 500ms ease"},[`&.${y.state.dragOverlay}`]:{zIndex:999}})),aa=M("div")(({theme:s})=>({width:"100%",cursor:"grab",outline:"none",overflow:"hidden",position:"relative",transformOrigin:"50% 50%",touchAction:"manipulation",borderRadius:"var(--item-radius)",WebkitTapHighlightColor:"transparent",boxShadow:s.vars.customShadows.z1,backgroundColor:s.vars.palette.common.white,transition:s.transitions.create(["box-shadow"]),...s.applyStyles("dark",{backgroundColor:s.vars.palette.grey[900]}),[`&.${y.state.disabled}`]:{},[`&.${y.state.sorting}`]:{},[`&.${y.state.dragOverlay}`]:{backdropFilter:"blur(6px)",boxShadow:s.vars.customShadows.z20,backgroundColor:R(s.vars.palette.common.whiteChannel,.48),...s.applyStyles("dark",{backgroundColor:R(s.vars.palette.grey["900Channel"],.48)})},[`&.${y.state.dragging}`]:{opacity:.2,filter:"grayscale(1)"}})),na=M("div")(({theme:s})=>({...s.typography.subtitle2,position:"relative",padding:s.spacing(2.5,2)})),ta=M("img",{shouldForwardProp:s=>!["open","sx"].includes(s)})(({theme:s})=>({width:320,height:"auto",aspectRatio:"4/3",objectFit:"cover",borderRadius:s.shape.borderRadius*1.5,variants:[{props:{open:!0},style:{opacity:.8}}]}));function ra({sx:s,liked:n,taskName:a,onDelete:t,taskStatus:r,onLikeToggle:o,onCloseDetails:u,...x}){const h=ze(),i=Me(h.breakpoints.up("sm")),p=ye(),g=z(),[C,v]=l.useState(r),k=l.useCallback(S=>{p.onClose(),v(S)},[p]),F=()=>e.jsx(je,{open:p.open,anchorEl:p.anchorEl,onClose:p.onClose,slotProps:{arrow:{placement:"top-right"}},children:e.jsx(Ce,{children:["To do","In progress","Ready to test","Done"].map(S=>e.jsx(J,{selected:C===S,onClick:()=>k(S),children:S},S))})}),b=()=>e.jsx(De,{open:g.value,onClose:g.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",a," "]}),"?"]}),action:e.jsx(B,{variant:"contained",color:"error",onClick:t,children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(f,{sx:[{display:"flex",alignItems:"center",p:h.spacing(2.5,1,2.5,2.5),borderBottom:`solid 1px ${h.vars.palette.divider}`},...Array.isArray(s)?s:[s]],...x,children:[!i&&e.jsx(q,{title:"Back",children:e.jsx(E,{onClick:u,sx:{mr:1},children:e.jsx(j,{icon:"eva:arrow-ios-back-fill"})})}),e.jsx(B,{size:"small",variant:"soft",endIcon:e.jsx(j,{icon:"eva:arrow-ios-downward-fill",width:16,sx:{ml:-.5}}),onClick:p.onOpen,children:C}),e.jsx(f,{component:"span",sx:{flexGrow:1}}),e.jsxs(f,{sx:{display:"flex"},children:[e.jsx(q,{title:"Like",children:e.jsx(E,{color:n?"default":"primary",onClick:o,children:e.jsx(j,{icon:"ic:round-thumb-up"})})}),e.jsx(q,{title:"Delete task",children:e.jsx(E,{onClick:g.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(E,{children:e.jsx(j,{icon:"eva:more-vertical-fill"})})]})]}),F(),b()]})}function oa({priority:s,onChangePriority:n,sx:a,...t}){return e.jsx(f,{sx:[()=>({gap:1,display:"flex",flexWrap:"wrap"}),...Array.isArray(a)?a:[a]],...t,children:["low","medium","hight"].map(r=>e.jsxs(_e,{onClick:()=>n(r),sx:o=>({py:.5,pl:.75,pr:1.25,fontSize:12,borderRadius:1,lineHeight:"20px",textTransform:"capitalize",fontWeight:"fontWeightBold",boxShadow:`inset 0 0 0 1px ${R(o.vars.palette.grey["500Channel"],.24)}`,...r===s&&{boxShadow:`inset 0 0 0 2px ${o.vars.palette.text.primary}`}}),children:[e.jsx(j,{icon:r==="low"&&"solar:double-alt-arrow-down-bold-duotone"||r==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{mr:.5,...r==="low"&&{color:"info.main"},...r==="medium"&&{color:"warning.main"},...r==="hight"&&{color:"error.main"}}}),r]},r))})}function ia({attachments:s}){const[n,a]=l.useState(s),t=l.useCallback(o=>{a([...n,...o])},[n]),r=l.useCallback(o=>{const u=n.filter(x=>x!==o);a(u)},[n]);return e.jsx(He,{thumbnail:!0,files:n,onRemove:o=>r(o),slotProps:{thumbnail:{sx:{width:64,height:64}}},lastNode:e.jsx(Ns,{onDrop:t})})}function la({comments:s}){const n=s.filter(t=>t.messageType==="image").map(t=>({src:t.message})),a=Ps(n);return e.jsxs(e.Fragment,{children:[e.jsx(Z,{component:"ul",spacing:3,children:s.map(t=>e.jsxs(f,{component:"li",sx:{gap:2,display:"flex"},children:[e.jsx(G,{src:t.avatarUrl}),e.jsxs(Z,{spacing:t.messageType==="image"?1:.5,flexGrow:1,children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(H,{variant:"subtitle2",children:[" ",t.name]}),e.jsx(H,{variant:"caption",sx:{color:"text.disabled"},children:Ge(t.createdAt)})]}),t.messageType==="image"?e.jsx(Ve,{alt:t.message,src:t.message,onClick:()=>a.onOpen(t.message),sx:r=>({borderRadius:1.5,cursor:"pointer",transition:r.transitions.create(["opacity"]),"&:hover":{opacity:.8}})}):e.jsx(H,{variant:"body2",children:t.message})]})]},t.id))}),e.jsx(Rs,{index:a.selected,slides:n,open:a.open,close:a.onClose})]})}function ca(){const{user:s}=qe(),n=(s==null?void 0:s.photoURL)&&s.photoURL.trim()!=="",a=Ye((s==null?void 0:s.displayName)||"",s==null?void 0:s.lastName);return e.jsxs(f,{sx:{py:3,gap:2,px:2.5,display:"flex"},children:[e.jsx(G,{src:n?s==null?void 0:s.photoURL:void 0,alt:s==null?void 0:s.displayName,children:a}),e.jsxs(oe,{variant:"outlined",sx:{p:1,flexGrow:1,bgcolor:"transparent"},children:[e.jsx(ie,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Type a message",sx:{px:1}}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(f,{sx:{flexGrow:1,display:"flex"},children:[e.jsx(E,{children:e.jsx(j,{icon:"solar:gallery-add-bold"})}),e.jsx(E,{children:e.jsx(j,{icon:"eva:attach-2-fill"})})]}),e.jsx(B,{variant:"contained",children:"Comment"})]})]})]})}const me=64;function da({assignee:s=[],open:n,onClose:a}){const[t,r]=l.useState(""),o=l.useCallback(h=>{r(h.target.value)},[]),u=ua({inputData:de,query:t}),x=!u.length&&!!t;return e.jsxs(Xe,{fullWidth:!0,maxWidth:"xs",open:n,onClose:a,children:[e.jsxs(Qe,{sx:{pb:0},children:["Contacts ",e.jsxs(H,{component:"span",children:["(",de.length,")"]})]}),e.jsx(f,{sx:{px:3,py:2.5},children:e.jsx(le,{fullWidth:!0,value:t,onChange:o,placeholder:"Pesquisar...",slotProps:{input:{startAdornment:e.jsx(Je,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}})}),e.jsx(Ze,{sx:{p:0},children:x?e.jsx(es,{query:t,sx:{mt:3,mb:10}}):e.jsx(ve,{sx:{height:me*6,px:2.5},children:e.jsx(f,{component:"ul",children:u.map(h=>{const i=s.map(p=>p.name).includes(h.name);return e.jsxs(f,{component:"li",sx:{gap:2,display:"flex",height:me,alignItems:"center"},children:[e.jsx(G,{src:h.avatarUrl}),e.jsx(ss,{primary:h.name,secondary:h.email}),e.jsx(B,{size:"small",color:i?"primary":"inherit",startIcon:e.jsx(j,{width:16,icon:i?"eva:checkmark-fill":"mingcute:add-line",sx:{mr:-.5}}),children:i?"Assigned":"Assign"})]},h.id)})})})})]})}function ua({inputData:s,query:n}){return n?s.filter(({name:a,email:t})=>[a,t].some(r=>r==null?void 0:r.toLowerCase().includes(n.toLowerCase()))):s}const Q=["Complete project proposal","Conduct market research","Design user interface mockups","Develop backend api","Implement authentication system"],W=M("span")(({theme:s})=>({...s.typography.caption,width:100,flexShrink:0,color:s.vars.palette.text.secondary,fontWeight:s.typography.fontWeightSemiBold}));function pa({task:s,open:n,onUpdateTask:a,onDeleteTask:t,onClose:r}){const o=as("overview"),u=z(),x=z(),[h,i]=l.useState(s.name),[p,g]=l.useState(s.priority),[C,v]=l.useState(s.description),[k,F]=l.useState(Q.slice(0,2)),b=Os(ue(s.due[0]),ue(s.due[1])),S=l.useCallback(d=>{i(d.target.value)},[]),I=l.useCallback(d=>{try{d.key==="Enter"&&h&&a({...s,name:h})}catch(O){console.error(O)}},[a,s,h]),P=l.useCallback(d=>{v(d.target.value)},[]),c=l.useCallback(d=>{g(d)},[]),m=d=>{const O=k.includes(d)?k.filter(N=>N!==d):[...k,d];F(O)},w=()=>e.jsx(ra,{taskName:s.name,onDelete:t,taskStatus:s.status,liked:u.value,onCloseDetails:r,onLikeToggle:u.onToggle}),T=()=>e.jsx(ts,{value:o.value,onChange:o.onChange,variant:"fullWidth",slotProps:{tab:{px:0}},children:[{value:"overview",label:"Overview"},{value:"subTasks",label:"Subtasks"},{value:"comments",label:`Comments (${s.comments.length})`}].map(d=>e.jsx(rs,{value:d.value,label:d.label},d.value))}),D=()=>e.jsxs(f,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsx(Fe,{placeholder:"Task name",value:h,onChange:S,onKeyUp:I,inputProps:{id:`${h}-task-input`}}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:"Reporter"}),e.jsx(G,{alt:s.reporter.name,src:s.reporter.avatarUrl})]}),e.jsxs(f,{sx:{display:"flex"},children:[e.jsx(W,{sx:{height:40,lineHeight:"40px"},children:"Assignee"}),e.jsxs(f,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:[s.assignee.map(d=>e.jsx(G,{alt:d.name,src:d.avatarUrl},d.id)),e.jsx(q,{title:"Add assignee",children:e.jsx(E,{onClick:x.onTrue,sx:[d=>({border:`dashed 1px ${d.vars.palette.divider}`,bgcolor:R(d.vars.palette.grey["500Channel"],.08)})],children:e.jsx(j,{icon:"mingcute:add-line"})})}),e.jsx(da,{assignee:s.assignee,open:x.value,onClose:x.onFalse})]})]}),e.jsxs(f,{sx:{display:"flex"},children:[e.jsx(W,{sx:{height:24,lineHeight:"24px"},children:"Labels"}),!!s.labels.length&&e.jsx(f,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:s.labels.map(d=>e.jsx(os,{color:"info",label:d,size:"small",variant:"soft"},d))})]}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:" Due date "}),b.selected?e.jsx(B,{size:"small",onClick:b.onOpen,children:b.shortLabel}):e.jsx(q,{title:"Add due date",children:e.jsx(E,{onClick:b.onOpen,sx:[d=>({border:`dashed 1px ${d.vars.palette.divider}`,bgcolor:R(d.vars.palette.grey["500Channel"],.08)})],children:e.jsx(j,{icon:"mingcute:add-line"})})}),e.jsx(Ls,{variant:"calendar",title:"Choose due date",startDate:b.startDate,endDate:b.endDate,onChangeStartDate:b.onChangeStartDate,onChangeEndDate:b.onChangeEndDate,open:b.open,onClose:b.onClose,selected:b.selected,error:b.error})]}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:"Priority"}),e.jsx(oa,{priority:p,onChangePriority:c})]}),e.jsxs(f,{sx:{display:"flex"},children:[e.jsx(W,{children:" Description "}),e.jsx(le,{fullWidth:!0,multiline:!0,size:"small",minRows:4,value:C,onChange:P,slotProps:{input:{sx:{typography:"body2"}}}})]}),e.jsxs(f,{sx:{display:"flex"},children:[e.jsx(W,{children:"Attachments"}),e.jsx(ia,{attachments:s.attachments})]})]}),A=()=>e.jsxs(f,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{children:[e.jsxs(H,{variant:"body2",sx:{mb:1},children:[k.length," of ",Q.length]}),e.jsx(is,{variant:"determinate",value:k.length/Q.length*100})]}),e.jsx(ls,{children:Q.map(d=>e.jsx(ke,{control:e.jsx(cs,{disableRipple:!0,name:d,checked:k.includes(d)}),label:d,onChange:()=>m(d)},d))}),e.jsx(B,{variant:"outlined",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-start"},children:"Subtask"})]}),L=()=>!!s.comments.length&&e.jsx(la,{comments:s.comments});return e.jsxs(ns,{open:n,onClose:r,anchor:"right",slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:{xs:1,sm:480}}},children:[w(),T(),e.jsxs(ve,{fillContent:!0,sx:{py:3,px:2.5},children:[o.value==="overview"&&D(),o.value==="subTasks"&&A(),o.value==="comments"&&L()]}),o.value==="comments"&&e.jsx(ca,{})]})}function xa({task:s,disabled:n,columnId:a,sx:t}){const r=z(),{setNodeRef:o,listeners:u,isDragging:x,isSorting:h,transform:i,transition:p}=Se({id:s==null?void 0:s.id}),g=ha(),C=x&&!g,v=l.useCallback(async()=>{try{Hs(a,s.id),re.success("Apagado com sucesso!",{position:"top-center"})}catch(b){console.error(b)}},[a,s.id]),k=l.useCallback(async b=>{try{_s(a,b)}catch(S){console.error(S)}},[a]),F=()=>e.jsx(pa,{task:s,open:r.value,onClose:r.onFalse,onUpdateTask:k,onDeleteTask:v});return e.jsxs(e.Fragment,{children:[e.jsx(ce,{ref:n?void 0:o,task:s,open:r.value,onClick:r.onTrue,stateProps:{transform:i,listeners:u,transition:p,sorting:h,dragging:x,fadeIn:C},sx:t}),F()]})}function ha(){const[s,n]=l.useState(!1);return l.useEffect(()=>{const a=setTimeout(()=>n(!0),500);return()=>clearTimeout(a)},[]),s}function ma({sx:s,...n}){const[a,t]=l.useState(""),r=z(),o=l.useCallback(i=>{t(i.target.value)},[]),u=l.useCallback(async()=>{try{const i={id:be(),name:a.trim()?a:"Untitled"};Ks(i),t(""),r.onFalse()}catch(i){console.error(i)}},[a,r]),x=l.useCallback(i=>{i.key==="Enter"&&u()},[u]),h=l.useCallback(()=>{t(""),r.onFalse()},[r]);return e.jsxs(e.Fragment,{children:[e.jsx(f,{sx:[()=>({flex:"0 0 auto",width:"var(--column-width)"}),...Array.isArray(s)?s:[s]],...n,children:r.value?e.jsx(Ie,{onClickAway:h,children:e.jsx(le,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:a,onChange:o,onKeyUp:x,helperText:"Press Enter to create the column.",sx:{[`& .${V.input}`]:{typography:"h6"}}})}):e.jsx(B,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(j,{icon:"mingcute:add-line",sx:{mr:-.5}}),onClick:r.onTrue,children:"Add column"})}),e.jsx(f,{sx:{width:"1px",flexShrink:0}})]})}function ga({itemCount:s=3,sx:n,...a}){return Array.from({length:s},(t,r)=>e.jsxs(oe,{variant:"outlined",sx:[()=>({display:"flex",gap:"var(--item-gap)",flexDirection:"column",p:"var(--column-padding)",width:"var(--column-width)",borderRadius:"var(--column-radius)"}),...Array.isArray(n)?n:[n]],...a,children:[e.jsx(X,{sx:{pt:"75%",borderRadius:1.5}}),[0].includes(r)&&e.jsx(X,{sx:{pt:"50%",borderRadius:1.5}}),[0,1].includes(r)&&e.jsx(X,{sx:{pt:"25%",borderRadius:1.5}}),[0,1,2].includes(r)&&e.jsx(X,{sx:{pt:"25%",borderRadius:1.5}})]},r))}const fa={sideEffects:bs({styles:{active:{opacity:"0.5"}}})};function ba({columns:s,tasks:n,activeId:a,sx:t}){const r=l.useId(),o=s.map(i=>i.id),u=s.find(i=>i.id===a),h=Object.values(n).flat().find(i=>i.id===a);return e.jsx(ds,{children:e.jsx(fs,{adjustScale:!1,dropAnimation:fa,children:a!=null?o.includes(a)?e.jsx(ya,{column:u,tasks:n[a],sx:t},r):e.jsx(ja,{task:h,sx:t},r):null})})}function ya({column:s,tasks:n,sx:a}){return e.jsx(Ae,{slots:{header:e.jsx(Oe,{columnName:s.name,totalTasks:n.length}),main:n.map(t=>e.jsx(ce,{task:t},t.id))},stateProps:{dragOverlay:!0},sx:a})}function ja({task:s,sx:n}){return e.jsx(ce,{task:s,sx:n,stateProps:{dragOverlay:!0}})}const ge="placeholder",fe={"--item-gap":"16px","--item-radius":"12px","--column-gap":"24px","--column-width":"336px","--column-radius":"16px","--column-padding":"20px 16px 16px 16px"};function Ca(){const{board:s,boardLoading:n,boardEmpty:a}=$s(),t=l.useRef(!1),r=l.useRef(null),[o,u]=l.useState(!0),[x,h]=l.useState(null),i=s.columns.map(c=>c.id),p=x!=null?i.includes(x):!1,g=ys(se(Is,{activationConstraint:{distance:3}}),se(Ss,{activationConstraint:{delay:250,tolerance:5}}),se(Ts,{coordinateGetter:Vs})),C=l.useCallback(c=>{var L;if(x&&x in s.tasks)return ae({...c,droppableContainers:c.droppableContainers.filter(d=>d.id in s.tasks)});const m=js(c),w=we(c),T=ae(c),D=m.length&&T.length&&w.length?m:null;let A=Te(D,"id");if(A!=null){if(A in s.tasks){const d=s.tasks[A].map(O=>O.id);d.length>0&&(A=(L=ae({...c,droppableContainers:c.droppableContainers.filter(O=>O.id!==A&&d.includes(O.id))})[0])==null?void 0:L.id)}return r.current=A,[{id:A}]}return t.current&&(r.current=x),r.current?[{id:r.current}]:[]},[x,s==null?void 0:s.tasks]),v=c=>c in s.tasks?c:Object.keys(s.tasks).find(m=>s.tasks[m].map(w=>w.id).includes(c));l.useEffect(()=>{requestAnimationFrame(()=>{t.current=!1})},[]);const k=({active:c})=>{h(c.id)},F=({active:c,over:m})=>{const w=m==null?void 0:m.id;if(w==null||c.id in s.tasks)return;const T=v(w),D=v(c.id);if(!(!T||!D)&&D!==T){const A=s.tasks[D].map(_=>_.id),L=s.tasks[T].map(_=>_.id),d=L.indexOf(w),O=A.indexOf(c.id);let N;if(w in s.tasks)N=L.length+1;else{const Ne=m&&c.rect.current.translated&&c.rect.current.translated.top>m.rect.top+m.rect.height?1:0;N=d>=0?d+Ne:L.length+1}t.current=!0;const Le={...s.tasks,[D]:s.tasks[D].filter(_=>_.id!==c.id),[T]:[...s.tasks[T].slice(0,N),s.tasks[D][O],...s.tasks[T].slice(N,s.tasks[T].length)]};he(Le)}},b=({active:c,over:m})=>{if(c.id in s.tasks&&(m!=null&&m.id)){const A=i.indexOf(c.id),L=i.indexOf(m.id),d=xe(s.columns,A,L);Bs(d)}const w=v(c.id);if(!w){h(null);return}const T=m==null?void 0:m.id;if(T==null){h(null);return}const D=v(T);if(D){const A=s.tasks[w].map(N=>N.id),L=s.tasks[D].map(N=>N.id),d=A.indexOf(c.id),O=L.indexOf(T);if(d!==O){const N={...s.tasks,[D]:xe(s.tasks[D],d,O)};he(N)}}h(null)},S=()=>e.jsx(f,{sx:{gap:"var(--column-gap)",display:"flex",alignItems:"flex-start"},children:e.jsx(ga,{})}),I=()=>e.jsx(As,{filled:!0,sx:{py:10,maxHeight:{md:480}}}),P=()=>e.jsxs(Cs,{id:"dnd-kanban",sensors:g,collisionDetection:C,measuring:{droppable:{strategy:vs.Always}},onDragStart:k,onDragOver:F,onDragEnd:b,children:[e.jsx(Z,{sx:{flex:"1 1 auto",overflowX:"auto"},children:e.jsx(Z,{sx:{pb:3,display:"unset",...o&&{minHeight:0,display:"flex",flex:"1 1 auto"}},children:e.jsx(f,{sx:[c=>({display:"flex",gap:"var(--column-gap)",...o&&{minHeight:0,flex:"1 1 auto",[`& .${y.columnList}`]:{...c.mixins.hideScrollY,flex:"1 1 auto"}}})],children:e.jsxs(pe,{items:[...i,ge],strategy:ks,children:[s==null?void 0:s.columns.map(c=>e.jsx(Zs,{column:c,tasks:s.tasks[c.id],children:e.jsx(pe,{items:s.tasks[c.id],strategy:ws,children:s.tasks[c.id].map(m=>e.jsx(xa,{task:m,columnId:c.id,disabled:p},m.id))})},c.id)),e.jsx(ma,{id:ge})]})})})}),e.jsx(ba,{columns:s==null?void 0:s.columns,tasks:s==null?void 0:s.tasks,activeId:x,sx:fe})]});return e.jsxs(us,{maxWidth:!1,sx:{...fe,pb:0,pl:{sm:3},pr:{sm:0},flex:"1 1 0",display:"flex",overflow:"hidden",flexDirection:"column"},children:[e.jsxs(f,{sx:{pr:{sm:3},mb:{xs:3,md:5},display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(H,{variant:"h4",children:"Kanban"}),e.jsx(ke,{label:"Fixed column",labelPlacement:"start",control:e.jsx(ps,{checked:o,onChange:c=>{u(c.target.checked)},inputProps:{id:"fixed-column-switch"}})})]}),n?S():e.jsx(e.Fragment,{children:a?I():P()})]})}const va={title:`Kanban | Dashboard - ${hs.appName}`};function Ea(){return e.jsxs(e.Fragment,{children:[e.jsx(xs,{children:e.jsxs("title",{children:[" ",va.title]})}),e.jsx(Ca,{})]})}export{Ea as default};

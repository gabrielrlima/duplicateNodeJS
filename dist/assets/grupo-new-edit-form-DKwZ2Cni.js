import{V as D,r as N,y as R,z as k,O as z,cN as c,p as g,j as e,F as U,G as h,aP as B,B as l,K as i,T as n,dt as q,bq as V,bg as j,aQ as M,S as f,f as T,b8 as G,au as Q,b3 as W,N as H,ee as K,Q as m,bl as $}from"./index-cNRh_qft.js";import{u as J}from"./use-corretores-B0nlkCck.js";import{C as X}from"./confirm-dialog-V5NQjZtL.js";import{s as Y}from"./schema-helper-D18en8Wv.js";import{C as y}from"./Card-C_-31fGp.js";const Z=z({avatarUrl:Y.file().optional(),name:m().min(1,{message:"Nome é obrigatório!"}),description:m().min(1,{message:"Descrição é obrigatória!"}),leader:m().min(1,{message:"Gerente é obrigatório!"}),meta:$().min(0,{message:"Meta deve ser um número positivo!"}).optional(),tipo:m().min(1,{message:"Tipo é obrigatório!"}),status:K(["ativo","inativo","suspenso"])});function oe({currentGrupo:t}){const d=D(),[C,u]=N.useState(!1),{corretores:b,loading:S}=J(),w={avatarUrl:null,name:"",description:"",leader:"",meta:0,tipo:"",status:"ativo"},p=R({mode:"onSubmit",resolver:k(Z),defaultValues:w,values:t?{avatarUrl:t.avatarUrl||null,name:t.name,description:t.description,leader:t.leader,meta:t.meta||0,tipo:t.tipo||"",status:t.status}:void 0}),A=async()=>{try{await new Promise(a=>setTimeout(a,500)),c.success("Grupo excluído com sucesso!"),d.push(g.dashboard.grupos.list),u(!1)}catch(a){console.error(a),c.error("Erro ao excluir grupo")}},{reset:v,watch:I,control:E,handleSubmit:O,formState:{isSubmitting:P}}=p,x=I(),F=O(async a=>{try{if(await new Promise(o=>setTimeout(o,500)),t)v(),c.success("Grupo atualizado com sucesso!"),d.push(g.dashboard.grupos.details(t.id));else{const o=`grupo-${Date.now()}`;v(),c.success("Grupo criado com sucesso!"),d.push(g.dashboard.grupos.details(o))}console.info("DATA",a)}catch(o){console.error(o)}}),L=[{value:"Residencial",label:"Residencial"},{value:"Comercial",label:"Comercial"},{value:"Rural",label:"Rural"},{value:"Lançamentos",label:"Lançamentos"},{value:"Aluguel",label:"Aluguel"},{value:"Venda",label:"Venda"},{value:"Aluguel por Temporada",label:"Aluguel por Temporada"},{value:"Industrial",label:"Industrial"},{value:"Terrenos e Lotes",label:"Terrenos e Lotes"},{value:"Imóveis de Alto Padrão",label:"Imóveis de Alto Padrão"},{value:"Oportunidades",label:"Oportunidades"}];return e.jsxs(U,{methods:p,onSubmit:F,children:[e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{size:{xs:12,md:4},children:e.jsxs(y,{sx:{pt:10,pb:5,px:3},children:[t&&e.jsx(B,{color:x.status==="ativo"&&"success"||x.status==="suspenso"&&"error"||"warning",sx:{position:"absolute",top:24,right:24},children:x.status}),e.jsx(l,{sx:{mb:5,textAlign:"center"},children:e.jsx(i.UploadAvatar,{name:"avatarUrl",maxSize:3145728,helperText:e.jsxs(n,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Permitido *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," tamanho máximo de ",q(3145728)]})})}),t&&e.jsx(V,{labelPlacement:"start",control:e.jsx(j,{name:"status",control:E,render:({field:a})=>e.jsx(M,{...a,checked:a.value==="ativo",onChange:o=>a.onChange(o.target.checked?"ativo":"inativo")})}),label:e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:.5},children:"Status Ativo"}),e.jsx(n,{variant:"body2",sx:{color:"text.secondary"},children:"Ativar ou desativar o grupo"})]}),sx:{mx:0,mb:3,width:1,justifyContent:"space-between"}}),t&&e.jsx(f,{sx:{mt:3,alignItems:"center",justifyContent:"center"},children:e.jsx(T,{variant:"soft",color:"error",onClick:()=>u(!0),children:"Excluir grupo"})})]})}),e.jsx(h,{size:{xs:12,md:8},children:e.jsxs(y,{sx:{p:3},children:[e.jsxs(l,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(i.Text,{name:"name",label:"Nome do Grupo"}),e.jsx(j,{name:"leader",control:p.control,render:({field:a,fieldState:{error:o}})=>e.jsx(G,{...a,options:b.filter(s=>s.status==="ativo"),getOptionLabel:s=>typeof s=="string"?s:s.name,isOptionEqualToValue:(s,r)=>typeof r=="string"?s.name===r:s.id===r.id,onChange:(s,r)=>{a.onChange(r?r.name:"")},value:b.find(s=>s.name===a.value)||null,loading:S,renderInput:s=>e.jsx(Q,{...s,label:"Gerente",error:!!o,helperText:o==null?void 0:o.message,placeholder:"Pesquisar gerente..."}),renderOption:(s,r)=>e.jsx(l,{component:"li",...s,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(n,{variant:"body2",children:r.name}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[r.email," • CRECI: ",r.creci]})]})}),noOptionsText:"Nenhum corretor encontrado"})}),e.jsx(l,{sx:{gridColumn:{sm:"span 2"}},children:e.jsx(i.Text,{name:"description",label:"Descrição",multiline:!0,rows:3})}),e.jsx(i.Text,{name:"meta",label:"Meta",type:"number",InputProps:{inputProps:{min:0}}}),e.jsx(i.Select,{name:"tipo",label:"Tipo",children:L.map(a=>e.jsx(W,{value:a.value,children:a.label},a.value))})]}),e.jsx(f,{sx:{mt:3,alignItems:"flex-end"},children:e.jsx(H,{type:"submit",variant:"contained",loading:P,children:t?"Salvar alterações":"Criar grupo"})})]})})]}),e.jsx(X,{open:C,onClose:()=>u(!1),title:"Excluir grupo",content:e.jsxs(e.Fragment,{children:["Tem certeza de que deseja excluir este grupo?",e.jsx("br",{}),e.jsx(n,{component:"span",sx:{color:"error.main",fontWeight:"fontWeightBold"},children:"Esta ação é irreversível e não pode ser desfeita."})]}),action:e.jsx(T,{variant:"contained",color:"error",onClick:A,children:"Excluir"})})]})}export{oe as G};

import{u as L,Y as _,r as T,e5 as H,bd as O,dO as z,cN as y,j as e,cV as U,bj as $,p as v,f as S,R as M,I as q,bp as V,S as G,D as Q,l as W,U as Y,n as J,aP as K,e6 as X,B as Z,dQ as ee,H as ae,C as te}from"./index-cNRh_qft.js";import{C as se}from"./confirm-dialog-V5NQjZtL.js";import{u as oe,g as ne,r as re,e as le,T as ie}from"./table-no-data-CeEeU6Ls.js";import{T as de}from"./table-empty-rows-BTCIE_YQ.js";import{T as ce}from"./table-head-custom-DSpcVu4-.js";import{T as me}from"./table-pagination-custom-xTp1jojO.js";import{V as m,a as ue,b as pe,c as ge}from"./vendas-table-filters-result-BVaiGC1R.js";import{C as B}from"./Card-C_-31fGp.js";import{s as F}from"./sumBy-ofy1HSRF.js";import{a as he,b as xe}from"./TableHead-DBnjkyMB.js";import"./calendar-form-BWQs_1hE.js";import"./vendas-new-edit-form-CFjQN1J_.js";import"./empty-content-BzM3Az2z.js";import"./styles-BI8UEJk6.js";import"./TableCell-CGwO8Re3.js";import"./TablePagination-CNNZgEcm.js";import"./LastPage-ChYIEhQh.js";import"./Toolbar-BaRJzfzK.js";import"./filters-result-BTXXEhsP.js";import"./index-ChnT1xRF.js";import"./index-BDJJM9HW.js";import"./color-preview-C96dy_lS.js";import"./property-_4o4UaMH.js";import"./CardHeader-CZZHKPlX.js";const be=[{id:"invoiceNumber",label:"Cliente"},{id:"createDate",label:"Criado"},{id:"dueDate",label:"Ultima atualização"},{id:"price",label:"Valor"},{id:"sent",label:"Produto",align:"center"},{id:"status",label:"Status"},{id:"actions"}];function fe(){var w,D;const s=L(),a=oe({defaultOrderBy:"createDate"}),x=_(),[r,u]=T.useState(H),p=O({name:"",service:[],status:"all",startDate:null,endDate:null}),{state:l,setState:b}=p,f=z(l.startDate,l.endDate),d=ve({inputData:r,comparator:ne(a.order,a.orderBy),filters:l,dateError:f}),o=re(d,a.page,a.rowsPerPage),c=!!l.name||l.service.length>0||l.status!=="all"||!!l.startDate&&!!l.endDate,j=!d.length&&c||!d.length,i=t=>r.filter(n=>n.status===t).length,g=t=>F(r.filter(n=>n.status===t),n=>n.totalAmount),h=t=>i(t)/r.length*100,I=[{value:"all",label:"Todos",color:"default",count:r.length},{value:"atendimento",label:"Atendimento",color:"warning",count:i("atendimento")},{value:"visita",label:"Visita",color:"info",count:i("visita")},{value:"interesse",label:"Interesse",color:"primary",count:i("interesse")},{value:"proposta",label:"Proposta",color:"secondary",count:i("proposta")},{value:"assinatura_pagamento",label:"Pagamento",color:"success",count:i("assinatura_pagamento")},{value:"cancelado",label:"Cancelado",color:"error",count:i("cancelado")}],A=T.useCallback(t=>{const n=r.filter(P=>P.id!==t);y.success("Desistencia confirmada com sucesso"),u(n),a.onUpdatePageDeleteRow(o.length)},[o.length,a,r]),E=T.useCallback(()=>{const t=r.filter(n=>!a.selected.includes(n.id));y.success("Apagado com sucesso!"),u(t),a.onUpdatePageDeleteRows(o.length,d.length)},[d.length,o.length,a,r]),N=T.useCallback((t,n)=>{a.onResetPage(),b({status:n})},[b,a]),k=()=>e.jsx(se,{open:x.value,onClose:x.onFalse,title:"Excluir",content:e.jsxs(e.Fragment,{children:["Tem certeza que deseja excluir ",e.jsxs("strong",{children:[" ",a.selected.length," "]})," itens?"]}),action:e.jsx(S,{variant:"contained",color:"error",onClick:()=>{E(),x.onFalse()},children:"Excluir"})});return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx($,{heading:"Minhas vendas",links:[{name:"Dashboard",href:v.dashboard.root},{name:"Vendas",href:((w=v.dashboard.vendas)==null?void 0:w.root)||"/dashboard/vendas"},{name:"Minhas vendas"}],action:e.jsx(S,{component:M,href:((D=v.dashboard.vendas)==null?void 0:D.new)||"/dashboard/vendas/new",variant:"contained",startIcon:e.jsx(q,{icon:"mingcute:add-line"}),children:"Novo atendimento"}),sx:{mb:{xs:3,md:5}}}),e.jsx(B,{sx:{mb:{xs:3,md:5}},children:e.jsx(V,{sx:{minHeight:108},children:e.jsxs(G,{divider:e.jsx(Q,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2,flexDirection:"row"},children:[e.jsx(m,{title:"Todos",total:r.length,percent:100,price:F(r,t=>t.totalAmount),icon:"solar:bill-list-bold-duotone",color:s.vars.palette.info.main}),e.jsx(m,{title:"Atendimento",total:i("atendimento"),percent:h("atendimento"),price:g("atendimento"),icon:"solar:user-speak-bold-duotone",color:s.vars.palette.warning.main}),e.jsx(m,{title:"Visita",total:i("visita"),percent:h("visita"),price:g("visita"),icon:"solar:home-bold-duotone",color:s.vars.palette.info.main}),e.jsx(m,{title:"Interesse",total:i("interesse"),percent:h("interesse"),price:g("interesse"),icon:"solar:heart-bold-duotone",color:s.vars.palette.primary.main}),e.jsx(m,{title:"Proposta",total:i("proposta"),percent:h("proposta"),price:g("proposta"),icon:"solar:document-text-bold-duotone",color:s.vars.palette.secondary.main}),e.jsx(m,{title:"Pagamento",total:i("assinatura_pagamento"),percent:h("assinatura_pagamento"),price:g("assinatura_pagamento"),icon:"solar:file-check-bold-duotone",color:s.vars.palette.success.main}),e.jsx(m,{title:"Cancelado",total:i("cancelado"),percent:h("cancelado"),price:g("cancelado"),icon:"solar:close-circle-bold-duotone",color:s.vars.palette.error.main})]})})}),e.jsxs(B,{children:[e.jsx(W,{value:l.status,onChange:N,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${Y(s.vars.palette.grey["500Channel"],.08)}`},children:I.map(t=>e.jsx(J,{value:t.value,label:t.label,iconPosition:"end",icon:e.jsx(K,{variant:(t.value==="all"||t.value===l.status)&&"filled"||"soft",color:t.color,children:t.count})},t.value))}),e.jsx(ue,{filters:p,dateError:f,onResetPage:a.onResetPage,options:{services:X.map(t=>t.name)}}),c&&e.jsx(pe,{filters:p,onResetPage:a.onResetPage,totalResults:d.length,sx:{p:2.5,pt:0}}),e.jsx(Z,{sx:{position:"relative"},children:e.jsx(V,{sx:{minHeight:444},children:e.jsxs(he,{size:a.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(ce,{order:a.order,orderBy:a.orderBy,headCells:be,onSort:a.onSort}),e.jsxs(xe,{children:[d.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(t=>{var n,P,C,R;return e.jsx(ge,{row:t,onDeleteRow:()=>A(t.id),editHref:((P=(n=v.dashboard.vendas)==null?void 0:n.edit)==null?void 0:P.call(n,t.id))||`/dashboard/vendas/${t.id}/edit`,detailsHref:((R=(C=v.dashboard.vendas)==null?void 0:C.details)==null?void 0:R.call(C,t.id))||`/dashboard/vendas/${t.id}`},t.id)}),e.jsx(de,{height:a.dense?56:76,emptyRows:le(a.page,a.rowsPerPage,d.length)}),e.jsx(ie,{notFound:j,title:"Nenhuma opção para o filtro selecionado"})]})]})})}),e.jsx(me,{page:a.page,dense:a.dense,count:d.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})]}),k()]})}function ve({inputData:s,comparator:a,filters:x,dateError:r}){const{name:u,status:p,service:l,startDate:b,endDate:f}=x,d=s.map((o,c)=>[o,c]);return d.sort((o,c)=>{const j=a(o[0],c[0]);return j!==0?j:o[1]-c[1]}),s=d.map(o=>o[0]),u&&(s=s.filter(o=>o.invoiceNumber.toLowerCase().indexOf(u.toLowerCase())!==-1||o.invoiceTo.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),p!=="all"&&(s=s.filter(o=>o.status===p)),l.length&&(s=s.filter(o=>o.items.some(c=>l.includes(c.service)))),r||b&&f&&(s=s.filter(o=>ee(o.createDate,b,f))),s}const je={title:`Vendas list | Dashboard - ${te.appName}`};function qe(){return e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsxs("title",{children:[" ",je.title]})}),e.jsx(fe,{})]})}export{qe as default};

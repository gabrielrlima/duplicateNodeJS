import{bk as le,r as h,ea as _e,W as ie,eb as qe,ec as Ce,a9 as Je,a8 as Ke,j as e,aS as N,a1 as R,I as g,aU as q,A as O,S,T as j,B as m,Y as K,bX as Q,ay as Qe,bo as ve,aJ as E,dv as Xe,d1 as Ye,aP as re,ax as Ze,bp as be,q as ye,aB as es,ed as ss,e7 as ge,V as os,e0 as ns,p as as,de as ts,u as rs,a as ls,b0 as is,f as T,aT as H,aV as ae,e9 as cs,au as Ae,a0 as ds,dI as hs,dJ as pe,bV as ms,b1 as xs,b2 as us,b3 as je,D as fs,cN as _,b8 as gs,bc as ps,U as js,bb as Cs}from"./index-cNRh_qft.js";import{a as X}from"./styles-BI8UEJk6.js";import{u as vs,L as bs}from"./use-light-box-Bxjny2_T.js";import{u as ce,m as J}from"./index-ChnT1xRF.js";import{k as ys}from"./keyBy-Dc3MaNHd.js";import{S as k}from"./Skeleton-XGh2Uz0E.js";import{C as As}from"./calendar-form-BWQs_1hE.js";import{A as ks}from"./AvatarGroup-B32XWlKs.js";const te=!1,U=Je.chat,de={revalidateIfStale:te,revalidateOnFocus:te,revalidateOnReconnect:te};function Ks(){const{data:o,isLoading:l,error:r,isValidating:a}=ce(null,le,de);return h.useMemo(()=>({contacts:_e,contactsLoading:!1,contactsError:null,contactsValidating:!1,contactsEmpty:!1}),[o==null?void 0:o.contacts,r,l,a])}function Qs(){const{data:o,isLoading:l,error:r,isValidating:a}=ce(null,le,de);return h.useMemo(()=>{const t=Ce,d=t.length?ys(t,u=>u.id):{},c=Object.keys(d);return{conversations:{byId:d,allIds:c},conversationsLoading:!1,conversationsError:null,conversationsValidating:!1,conversationsEmpty:!1}},[o==null?void 0:o.conversations,r,l,a])}function Xs(s){const{user:o}=ie(),l=null,{data:r,isLoading:a,error:n,isValidating:t}=ce(l,le,de);return h.useMemo(()=>{let c;if(s.startsWith("venda-")){const u=s.replace("venda-",""),I=(o==null?void 0:o.displayName)||(o==null?void 0:o.name)||"Corretor",C=o==null?void 0:o.id;c=qe(u,I,{name:"João Silva",email:"joao.silva@email.com",phone:"(11) 99999-9999"},C)}else c=Ce.find(u=>u.id===s);return{conversation:c,conversationLoading:!1,conversationError:null,conversationValidating:!1,conversationEmpty:!c}},[s,r==null?void 0:r.conversation,n,a,t,o])}async function ws(s,o){const l=[U,{params:{endpoint:"conversations"}}];J([U,{params:{conversationId:s,endpoint:"conversation"}}],a=>{const n=a.conversation,t={...n,messages:[...n.messages,o]};return{...a,conversation:t}},!1),J(l,a=>{const t=a.conversations.map(d=>d.id===s?{...d,messages:[...d.messages,o]}:d);return{...a,conversations:t}},!1)}async function Ss(s){const o=[U,{params:{endpoint:"conversations"}}],l={conversationData:s},r=await Ke.post(U,l);return J(o,a=>{const t=[...a.conversations,s];return{...a,conversations:t}},!1),r.data}async function Ys(s){J([U,{params:{endpoint:"conversations"}}],o=>{const r=o.conversations.map(a=>a.id===s?{...a,unreadCount:0}:a);return{...o,conversations:r}},!1)}function Is({participant:s,open:o,onClose:l}){return e.jsxs(N,{fullWidth:!0,maxWidth:"xs",open:o,onClose:l,children:[e.jsx(R,{onClick:l,sx:{position:"absolute",right:8,top:8},children:e.jsx(g,{icon:"mingcute:close-line"})}),e.jsxs(q,{sx:{py:5,px:3,display:"flex"},children:[e.jsx(O,{alt:s.name,sx:{width:96,height:96,mr:3},children:s.name.split(" ").length>1?`${s.name.split(" ")[0].charAt(0)}${s.name.split(" ")[s.name.split(" ").length-1].charAt(0)}`.toUpperCase():s.name.charAt(0).toUpperCase()}),e.jsxs(S,{spacing:1,children:[e.jsx(j,{variant:"caption",sx:{color:"primary.main"},children:s.role}),e.jsx(j,{variant:"subtitle1",children:s.name}),e.jsxs(m,{sx:{display:"flex",typography:"caption",color:"text.disabled"},children:[e.jsx(g,{icon:"mingcute:mail-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),s.email]}),e.jsxs(m,{sx:{display:"flex",typography:"caption",color:"text.disabled"},children:[e.jsx(g,{icon:"mingcute:phone-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),s.phoneNumber]})]})]})]})}function Rs({participants:s}){const o=K(!0),[l,r]=h.useState(null),a=h.useCallback(c=>{r(c)},[]),n=h.useCallback(()=>{r(null)},[]),t=s.length,d=()=>e.jsx(e.Fragment,{children:s.map(c=>e.jsxs(Qe,{onClick:()=>a(c),children:[e.jsx(ve,{variant:c.status,badgeContent:"",children:e.jsx(O,{alt:c.name,children:(()=>{const u=c.name.split(" ");return u.length>1?`${u[0].charAt(0)}${u[u.length-1].charAt(0)}`.toUpperCase():c.name.charAt(0).toUpperCase()})()})}),e.jsx(E,{primary:c.name,secondary:c.role,slotProps:{primary:{noWrap:!0},secondary:{noWrap:!0,sx:{typography:"caption"}}},sx:{ml:2}})]},c.id))});return e.jsxs(e.Fragment,{children:[e.jsx(X,{selected:o.value,disabled:!t,onClick:o.onToggle,children:`Participantes (${t})`}),e.jsx(Q,{in:o.value,children:d()}),l&&e.jsx(Is,{participant:l,open:!!l,onClose:n})]})}function Zs({sx:s,itemCount:o=6,...l}){return Array.from({length:o},(r,a)=>e.jsxs(m,{sx:[()=>({gap:2,px:2.5,py:1.5,display:"flex",alignItems:"center"}),...Array.isArray(s)?s:[s]],...l,children:[e.jsx(k,{variant:"circular",sx:{width:48,height:48}}),e.jsxs(S,{spacing:1,flexGrow:1,children:[e.jsx(k,{sx:{width:.75,height:10}}),e.jsx(k,{sx:{width:.5,height:10}})]})]},a))}function Ds({sx:s,...o}){return e.jsxs(m,{sx:[{width:1,display:"flex",alignItems:"center"},...Array.isArray(s)?s:[s]],...o,children:[e.jsx(k,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(S,{spacing:1,flexGrow:1,sx:{mx:2},children:[e.jsx(k,{sx:{width:96,height:10}}),e.jsx(k,{sx:{width:40,height:10}})]}),e.jsx(k,{variant:"circular",sx:{width:28,height:28}}),e.jsx(k,{variant:"circular",sx:{width:28,height:28,mx:1}}),e.jsx(k,{variant:"circular",sx:{width:28,height:28,mr:1}})]})}function Ms({sx:s,...o}){return e.jsx(m,{sx:[()=>({pt:5,flexGrow:1,display:"flex",flexDirection:"column"}),...Array.isArray(s)?s:[s]],...o,children:e.jsxs(S,{alignItems:"center",children:[e.jsx(k,{variant:"circular",sx:{width:96,height:96}}),e.jsx(k,{sx:{mb:1,mt:2,height:10,width:.65}}),e.jsx(k,{sx:{mb:5,width:.35,height:10}}),e.jsx("span",{style:{fontFamily:"Inter",fontWeight:600,fontSize:"24px",letterSpacing:"-0.5px",color:"#1a1a1a"},children:"duplicate"})]})})}function Ts({participant:s}){const o=K(!0),l=()=>e.jsxs(S,{alignItems:"center",sx:{py:5},children:[e.jsx(O,{alt:s==null?void 0:s.name,src:s==null?void 0:s.avatarUrl,sx:{width:96,height:96,mb:2}}),e.jsx(j,{variant:"subtitle1",children:s==null?void 0:s.name}),e.jsx(j,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:s==null?void 0:s.role})]}),r=()=>e.jsx(S,{spacing:2,sx:{px:2,py:2.5},children:[{icon:"mingcute:location-fill",value:s==null?void 0:s.address},{icon:"solar:phone-bold",value:s==null?void 0:s.phoneNumber},{icon:"fluent:mail-24-filled",value:s==null?void 0:s.email}].map(a=>e.jsxs(m,{sx:{gap:1,display:"flex",typography:"body2",wordBreak:"break-all"},children:[e.jsx(g,{icon:a.icon,sx:{flexShrink:0,color:"text.disabled"}}),a.value]},a.icon))});return e.jsxs(e.Fragment,{children:[l(),e.jsx(X,{selected:o.value,onClick:o.onToggle,children:"Information"}),e.jsx(Q,{in:o.value,children:r()})]})}function Os({attachments:s}){const o=K(!0),l=s.length,r=()=>s.map((a,n)=>e.jsxs(m,{sx:{gap:1.5,display:"flex",alignItems:"center"},children:[e.jsx(Xe,{imageView:!0,file:a.preview,onDownload:()=>console.info("DOWNLOAD"),slotProps:{icon:{sx:{width:24,height:24}}},sx:{width:40,height:40,bgcolor:"background.neutral"}}),e.jsx(E,{primary:a.name,secondary:Ye(a.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{noWrap:!0,sx:{mt:.25,typography:"caption",color:"text.disabled"}}}})]},a.name+n));return e.jsxs(e.Fragment,{children:[e.jsx(X,{selected:o.value,disabled:!l,onClick:o.onToggle,children:`Anexos (${l})`}),!!l&&e.jsx(Q,{in:o.value,children:e.jsx(S,{spacing:2,sx:{p:2},children:r()})})]})}function Vs({salesDetails:s=[]}){const o=K(!0),l=[{label:"Imóvel",value:"Residencial Jardim das Flores",icon:"solar:buildings-bold",color:"info"},{label:"Valor do m²",value:"R$ 8.500,00",icon:"solar:home-bold",color:"success"},{label:"Minha comissão",value:"5,5%",icon:"solar:dollar-minimalistic-bold",color:"warning"},{label:"Corretor Responsável",value:"João Silva",icon:"solar:user-bold",color:"default"}],r=s.length>0?s:l,a=()=>r.map((n,t)=>e.jsxs(m,{sx:{gap:1.5,display:"flex",alignItems:"center"},children:[n.icon&&e.jsx(m,{sx:{width:40,height:40,display:"flex",borderRadius:1,alignItems:"center",justifyContent:"center",bgcolor:"background.neutral"},children:e.jsx(g,{icon:n.icon,width:24})}),e.jsx(m,{sx:{flexGrow:1},children:e.jsx(E,{primary:n.label,secondary:e.jsx(re,{variant:"soft",color:n.color||"default",children:n.value}),slotProps:{primary:{noWrap:!0,sx:{typography:"body2",fontWeight:"fontWeightMedium"}},secondary:{sx:{mt:.5}}}})})]},t));return e.jsxs(e.Fragment,{children:[e.jsx(X,{selected:o.value,disabled:!r.length,onClick:o.onToggle,children:`Detalhes da Venda (${r.length})`}),!!r.length&&e.jsx(Q,{in:o.value,children:e.jsx(S,{spacing:2,sx:{p:2},children:a()})})]})}const $s=280,Ls=320;function eo({collapseNav:s,participants:o,messages:l,loading:r,sx:a,...n}){const{collapseDesktop:t,openMobile:d,onCloseMobile:c}=s,u=o.length>1,I=l.map(v=>v.attachments).flat(1)||[],C=()=>r?e.jsx(Ms,{}):e.jsx(be,{children:e.jsxs("div",{children:[u?e.jsx(Rs,{participants:o}):e.jsx(Ts,{participant:o[0]}),e.jsx(Os,{attachments:I}),e.jsx(Vs,{})]})});return e.jsxs(e.Fragment,{children:[e.jsx(m,{sx:[v=>({minHeight:0,flex:"1 1 auto",width:$s,flexDirection:"column",display:{xs:"none",lg:"flex"},borderLeft:`solid 1px ${v.vars.palette.divider}`,transition:v.transitions.create(["width"],{duration:v.transitions.duration.shorter}),...t&&{width:0}}),...Array.isArray(a)?a:[a]],...n,children:!t&&C()}),e.jsx(Ze,{anchor:"right",open:d,onClose:c,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:Ls}},children:C()})]})}function Ws({message:s,participants:o,currentUserId:l}){var d;const r=o.find(c=>c.id===s.senderId),a=s.senderId===l,n=a?{type:"me"}:{avatarUrl:r==null?void 0:r.avatarUrl,firstName:((d=r==null?void 0:r.name)==null?void 0:d.split(" ")[0])??"Unknown"};return{hasImage:s.contentType==="image",me:a,senderDetails:n}}function Ns({message:s,participants:o,onOpenLightbox:l}){const{user:r}=ie(),{me:a,senderDetails:n,hasImage:t}=Ws({message:s,participants:o,currentUserId:`${r==null?void 0:r.id}`}),{firstName:d}=n,{body:c,createdAt:u}=s,I=()=>e.jsxs(j,{noWrap:!0,variant:"caption",sx:{mb:1,color:"text.disabled",...!a&&{mr:"auto"}},children:[!a&&`${d}, `,ye(u)]}),C=()=>e.jsx(S,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral",...a&&{color:"grey.800",bgcolor:"primary.lighter"},...t&&{p:0,bgcolor:"transparent"}},children:t?e.jsx(m,{component:"img",alt:"Attachment",src:c,onClick:()=>l(c),sx:{width:400,height:"auto",borderRadius:1.5,cursor:"pointer",objectFit:"cover",aspectRatio:"16/11","&:hover":{opacity:.9}}}):c}),v=()=>e.jsxs(m,{className:"message-actions",sx:b=>({pt:.5,left:0,opacity:0,top:"100%",display:"flex",position:"absolute",transition:b.transitions.create(["opacity"],{duration:b.transitions.duration.shorter}),...a&&{right:0,left:"unset"}}),children:[e.jsx(R,{size:"small",children:e.jsx(g,{icon:"solar:reply-bold",width:16})}),e.jsx(R,{size:"small",children:e.jsx(g,{icon:"eva:smiling-face-fill",width:16})}),e.jsx(R,{size:"small",children:e.jsx(g,{icon:"solar:trash-bin-trash-bold",width:16})})]});return s.body?e.jsxs(m,{sx:{mb:5,display:"flex",justifyContent:a?"flex-end":"unset"},children:[!a&&e.jsx(O,{alt:d,sx:{width:32,height:32,mr:2},children:(()=>{const b=d.split(" ");return b.length>1?`${b[0].charAt(0)}${b[b.length-1].charAt(0)}`.toUpperCase():d.charAt(0).toUpperCase()})()}),e.jsxs(S,{alignItems:a?"flex-end":"flex-start",children:[I(),e.jsxs(m,{sx:{display:"flex",alignItems:"center",position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[C(),v()]})]})]}):null}function Es(s){const o=h.useRef(null),l=h.useCallback(()=>{s&&o.current&&o.current&&(o.current.scrollTop=o.current.scrollHeight)},[s]);return h.useEffect(()=>{l()},[s]),{messagesEndRef:o}}function so({messages:s=[],participants:o,loading:l}){const{messagesEndRef:r}=Es(s),a=s.filter(t=>t.contentType==="image").map(t=>({src:t.body})),n=vs(a);return l?e.jsx(S,{sx:{flex:"1 1 auto",position:"relative"},children:e.jsx(es,{color:"inherit",sx:{top:0,left:0,width:1,height:2,borderRadius:0,position:"absolute"}})}):e.jsxs(e.Fragment,{children:[e.jsx(be,{ref:r,sx:{px:3,pt:5,pb:3,flex:"1 1 auto"},children:s.map(t=>e.jsx(Ns,{message:t,participants:o,onOpenLightbox:()=>n.onOpen(t.body)},t.id))}),e.jsx(bs,{slides:a,open:n.open,close:n.onClose,index:n.selected})]})}function Us({message:s="",recipients:o,me:l}){var t;const r=o.length>1,a={id:ge(),attachments:[],body:s,contentType:"text",createdAt:ss({minutes:1}),senderId:l.id},n={id:r?ge():(t=o[0])==null?void 0:t.id,messages:[a],participants:[...o,l],type:r?"GROUP":"ONE_TO_ONE",unreadCount:0};return{messageData:a,conversationData:n}}function oo({disabled:s,recipients:o,onAddRecipients:l,selectedConversationId:r}){const a=os(),{user:n}=ie(),t=h.useRef(null),[d,c]=h.useState(""),u=h.useMemo(()=>({id:`${n==null?void 0:n.id}`,role:`${n==null?void 0:n.role}`,email:`${n==null?void 0:n.email}`,address:`${n==null?void 0:n.address}`,name:`${n==null?void 0:n.displayName}`,lastActivity:ns(),avatarUrl:`${n==null?void 0:n.photoURL}`,phoneNumber:`${n==null?void 0:n.phoneNumber}`,status:"online"}),[n]),{messageData:I,conversationData:C}=Us({message:d,recipients:o,me:u}),v=h.useCallback(()=>{t.current&&t.current.click()},[]),b=h.useCallback(D=>{c(D.target.value)},[]),Y=h.useCallback(async D=>{if(!(D.key!=="Enter"||!d))try{if(r)await ws(r,I);else{const M=await Ss(C);a.push(`${as.dashboard.chat}?id=${M.conversation.id}`),l([])}}catch(M){console.error(M)}finally{c("")}},[C,d,I,l,a,r]);return e.jsxs(e.Fragment,{children:[e.jsx(ts,{name:"chat-message",id:"chat-message-input",value:d,onKeyUp:Y,onChange:b,placeholder:"Escreva sua mensagem",disabled:s,startAdornment:e.jsx(R,{children:e.jsx(g,{icon:"eva:smiling-face-fill"})}),endAdornment:e.jsxs(m,{sx:{flexShrink:0,display:"none"},children:[e.jsx(R,{onClick:v,children:e.jsx(g,{icon:"solar:gallery-add-bold"})}),e.jsx(R,{onClick:v,children:e.jsx(g,{icon:"eva:attach-2-fill"})}),e.jsx(R,{children:e.jsx(g,{icon:"solar:microphone-bold"})})]}),sx:[D=>({px:1,height:56,flexShrink:0,borderTop:`solid 1px ${D.vars.palette.divider}`})]}),e.jsx("input",{type:"file",ref:t,style:{display:"none"}})]})}function no({collapseNav:s,participants:o,loading:l,vendaStatus:r,onStatusChange:a,onAddParticipant:n,onRemoveParticipant:t}){const d=rs(),c=ls(d.breakpoints.up("lg")),u=is(),[I,C]=h.useState(!1),[v,b]=h.useState(!1),[Y,D]=h.useState(!1),[M,Z]=h.useState(!1),[y,ee]=h.useState(r||"atendimento"),[se,ke]=h.useState(!1),[we,P]=h.useState(!1),[oe,F]=h.useState(""),[A,G]=h.useState({toAdd:[],toRemove:[]}),he=[{id:"1",name:"Maria Santos",email:"maria.santos@imobiliaria.com",phone:"+55 21 98888-5678"},{id:"2",name:"Carlos Oliveira",email:"carlos.oliveira@imobiliaria.com",phone:"+55 31 97777-9012"},{id:"3",name:"Pedro Ferreira",email:"pedro.ferreira@imobiliaria.com",phone:"+55 71 95555-7890"},{id:"4",name:"Ana Costa",email:"ana.costa@imobiliaria.com",phone:"+55 51 96666-3456"},{id:"5",name:"João Silva",email:"joao.silva@imobiliaria.com",phone:"+55 11 99999-1234"},{id:"6",name:"Fernanda Lima",email:"fernanda.lima@imobiliaria.com",phone:"+55 85 94444-5678"},{id:"7",name:"Roberto Santos",email:"roberto.santos@imobiliaria.com",phone:"+55 47 93333-9012"}].filter(i=>i.name.toLowerCase().includes(oe.toLowerCase())||i.email.toLowerCase().includes(oe.toLowerCase())),Se=o.length>1,x=o[0],{collapseDesktop:Ie,onCollapseDesktop:Re,onOpenMobile:De}=s,Me=h.useCallback(()=>{c?Re():De()},[c]),Te=()=>{u.onClose(),C(!0)},Oe=()=>{C(!1),ee("cancelado"),ke(!0),a&&a("cancelado"),console.log("Atendimento marcado como desistente")},me=()=>{C(!1)},Ve=()=>{M?D(!0):b(!0)},$e=()=>{Z(!1),D(!1),console.log("Visita cancelada")},xe=()=>{D(!1)},ue=()=>{b(!1)},Le=i=>{console.log("Visita agendada para:",i),Z(!0),ee("visita"),b(!1),a&&a("visita")},We=()=>{Z(!1),ee("interesse"),a&&a("interesse"),console.log("Visita concluída")},Ne=()=>{u.onClose(),P(!0)},Ee=()=>{P(!1),F("")},Ue=()=>{A.toAdd.forEach(w=>{n&&n(w)}),A.toRemove.forEach(w=>{t&&t(w)});const i=A.toAdd.length,f=A.toRemove.length;i>0&&f>0?_.success(`${i} corretor(es) adicionado(s) e ${f} removido(s)`):i>0?_.success(`${i} corretor(es) adicionado(s)`):f>0&&_.success(`${f} corretor(es) removido(s)`),G({toAdd:[],toRemove:[]}),P(!1),F("")},Pe=()=>{G({toAdd:[],toRemove:[]}),P(!1),F("")},Fe=i=>{const f=o.some(p=>p.email===i.email),w=A.toAdd.some(p=>p.email===i.email);if(f||w)return;const V={id:i.id,name:i.name,role:"Corretor",email:i.email,address:"Imobiliária",avatarUrl:"",phoneNumber:i.phone,lastActivity:new Date().toISOString(),status:"online"};G(p=>({...p,toAdd:[...p.toAdd,V]}))},Ge=i=>{const f=o.find(V=>V.email===i.email),w=A.toRemove.includes((f==null?void 0:f.id)||"");f&&!w&&(G(V=>({...V,toRemove:[...V.toRemove,f.id]})),_.success(`${i.name} foi adicionado à lista de remoção`))},ze=()=>e.jsxs(m,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(ks,{max:3,sx:{[`& .${ms.avatar}`]:{width:32,height:32}},children:o.map(i=>{const f=i.name.split(" "),w=f.length>1?`${f[0].charAt(0)}${f[f.length-1].charAt(0)}`:i.name.charAt(0);return e.jsx(O,{alt:i.name,children:w.toUpperCase()},i.id)})}),y&&e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(j,{variant:"body2",sx:{color:"text.secondary",fontSize:"0.75rem"},children:"Status da Venda"}),e.jsxs(re,{variant:"soft",color:y==="atendimento"&&"warning"||y==="visita"&&"info"||y==="interesse"&&"primary"||y==="proposta"&&"secondary"||y==="assinatura_pagamento"&&"success"||y==="cancelado"&&"error"||"default",children:[y==="atendimento"&&"Atendimento",y==="visita"&&"Visita",y==="interesse"&&"Interesse",y==="proposta"&&"Proposta",y==="assinatura_pagamento"&&"Pagamento",y==="cancelado"&&"Cancelado"]})]})]}),Be=()=>{const i=(x==null?void 0:x.name.split(" "))||[],f=i.length>1?`${i[0].charAt(0)}${i[i.length-1].charAt(0)}`:(x==null?void 0:x.name.charAt(0))||"";return e.jsxs(m,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(ve,{variant:x==null?void 0:x.status,badgeContent:"",children:e.jsx(O,{alt:x==null?void 0:x.name,children:f.toUpperCase()})}),e.jsx(E,{primary:x==null?void 0:x.name,secondary:(x==null?void 0:x.status)==="offline"?ye(x==null?void 0:x.lastActivity):x==null?void 0:x.status})]})};if(l)return e.jsx(Ds,{});const ne=o.some(i=>i.role==="Corretor"||i.role==="Corretora"),He=()=>e.jsx(xs,{open:u.open,anchorEl:u.anchorEl,onClose:u.onClose,children:e.jsxs(us,{children:[e.jsxs(je,{onClick:Ne,children:[e.jsx(g,{icon:ne?"solar:pen-bold":"mingcute:add-line"}),ne?"Gerenciar corretores":"Adicionar corretor"]}),e.jsx(fs,{sx:{borderStyle:"dashed"}}),e.jsxs(je,{onClick:Te,sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Desistiu"]})]})});return e.jsxs(e.Fragment,{children:[Se?ze():Be(),e.jsxs(m,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end",alignItems:"center",gap:1},children:[M&&e.jsx(T,{variant:"contained",color:"success",size:"small",startIcon:e.jsx(g,{icon:"eva:checkmark-circle-2-fill"}),onClick:We,disabled:se,sx:{mr:1},children:"Concluir visita"}),e.jsx(T,{variant:"contained",color:M?"error":"primary",size:"small",startIcon:e.jsx(g,{icon:M?"eva:close-fill":"solar:calendar-add-bold"}),onClick:Ve,disabled:se,sx:{mr:1},children:M?"Cancelar visita":"Agendar visita"}),e.jsx(R,{onClick:Me,children:e.jsx(g,{icon:Ie?"ri:sidebar-fold-fill":"ri:sidebar-unfold-fill"})}),e.jsx(R,{onClick:u.onOpen,disabled:se,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})]}),He(),e.jsxs(N,{open:I,onClose:me,maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Confirmar Desistência"}),e.jsxs(q,{children:[e.jsx(j,{variant:"body1",sx:{mb:2},children:"Tem certeza que deseja marcar este atendimento como desistente?"}),e.jsxs(j,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Atenção:"}),' Esta ação não poderá ser desfeita. O atendimento passará para o status "Cancelado" e não será mais possível alterar o status.']})]}),e.jsxs(ae,{children:[e.jsx(T,{onClick:me,color:"inherit",children:"Cancelar"}),e.jsx(T,{onClick:Oe,color:"error",variant:"contained",children:"Confirmar Desistência"})]})]}),e.jsxs(N,{fullWidth:!0,maxWidth:"xs",open:v,onClose:ue,transitionDuration:{enter:d.transitions.duration.shortest,exit:d.transitions.duration.shortest-80},PaperProps:{sx:{display:"flex",overflow:"hidden",flexDirection:"column","& form":{flex:"1 1 auto",display:"flex",flexDirection:"column",minHeight:0}}},children:[e.jsx(H,{sx:{minHeight:76},children:"Agendar Visita"}),e.jsx(As,{colorOptions:cs,onClose:ue,onSuccess:Le})]}),e.jsxs(N,{open:Y,onClose:xe,maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Cancelar Visita Agendada"}),e.jsxs(q,{children:[e.jsx(j,{variant:"body1",sx:{mb:2},children:"Tem certeza que deseja cancelar a visita agendada?"}),e.jsxs(j,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Atenção:"})," Esta ação não poderá ser desfeita e uma nova visita deverá ser registrada caso necessário."]})]}),e.jsxs(ae,{children:[e.jsx(T,{onClick:xe,color:"inherit",children:"Manter Visita"}),e.jsx(T,{onClick:$e,color:"error",variant:"contained",children:"Cancelar Visita"})]})]}),e.jsxs(N,{open:we,onClose:Ee,maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:ne?"Gerenciar corretores do atendimento":"Adicionar corretor ao atendimento"}),e.jsxs(q,{children:[e.jsx(Ae,{fullWidth:!0,placeholder:"Pesquisar corretor por nome ou email...",value:oe,onChange:i=>F(i.target.value),sx:{mb:2},InputProps:{startAdornment:e.jsx(ds,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(hs,{sx:{maxHeight:300,overflow:"auto"},children:he.length>0?he.map(i=>{var fe;const f=o.some($=>$.email===i.email),w=A.toAdd.some($=>$.email===i.email),V=A.toRemove.includes(((fe=o.find($=>$.email===i.email))==null?void 0:fe.id)||"");let p="Adicionar",L="primary",z="mingcute:add-line",W="",B="success";return V?(p="Cancelar Remoção",L="success",z="mingcute:refresh-2-line",W="Será removido",B="error"):w?(p="Cancelar",L="error",z="mingcute:close-line",W="Será adicionado",B="warning"):f&&(p="Remover",L="error",z="mingcute:delete-2-line",W="Participando",B="success"),e.jsx(pe,{disablePadding:!0,children:e.jsxs(m,{sx:{display:"flex",alignItems:"center",width:"100%",p:1},children:[e.jsx(O,{sx:{mr:2,bgcolor:f?"grey.400":"primary.main"},children:i.name.split(" ").map($=>$.charAt(0)).slice(0,2).join("")}),e.jsxs(m,{sx:{flexGrow:1},children:[e.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(j,{variant:"body1",children:i.name}),W&&e.jsx(re,{color:B,children:W})]}),e.jsx(j,{variant:"body2",color:"text.secondary",children:i.email}),e.jsx(j,{variant:"body2",color:"text.secondary",children:i.phone})]}),e.jsx(T,{variant:L==="primary"?"contained":"outlined",color:L,size:"small",onClick:()=>p==="Remover"||p==="Cancelar"||p==="Cancelar Remoção"?Ge(i):Fe(i),startIcon:e.jsx(g,{icon:z}),children:p})]})},i.id)}):e.jsx(pe,{children:e.jsx(E,{primary:"Nenhum corretor encontrado",secondary:"Tente ajustar os termos da pesquisa",sx:{textAlign:"center"}})})})]}),e.jsxs(ae,{children:[e.jsx(T,{onClick:Pe,color:"inherit",children:"Cancelar"}),(A.toAdd.length>0||A.toRemove.length>0)&&e.jsxs(T,{onClick:Ue,color:"primary",variant:"contained",children:["Confirmar (",A.toAdd.length+A.toRemove.length,")"]})]})]})]})}function ao({contacts:s,onAddRecipients:o}){const[l,r]=h.useState(""),a=h.useCallback(n=>{r(""),o(n)},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),e.jsx(gs,{sx:{minWidth:{md:320},flexGrow:{xs:1,md:"unset"}},multiple:!0,limitTags:3,popupIcon:null,defaultValue:[],disableCloseOnSelect:!0,noOptionsText:e.jsx(Cs,{query:l}),onChange:(n,t)=>a(t),onInputChange:(n,t)=>r(t),options:s,getOptionLabel:n=>n.name,isOptionEqualToValue:(n,t)=>n.id===t.id,renderInput:n=>e.jsx(Ae,{...n,placeholder:"+ Recipients"}),renderOption:(n,t,{selected:d})=>h.createElement("li",{...n,key:t.id},e.jsxs(m,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[e.jsx(O,{alt:t.name,src:t.avatarUrl,sx:{width:1,height:1}}),e.jsx(m,{sx:[c=>({top:0,left:0,width:1,height:1,opacity:0,display:"flex",position:"absolute",alignItems:"center",justifyContent:"center",bgcolor:js(c.vars.palette.grey["900Channel"],.8),transition:c.transitions.create(["opacity"],{easing:c.transitions.easing.easeInOut,duration:c.transitions.duration.shorter}),...d&&{opacity:1,color:"primary.main"}})],children:e.jsx(g,{icon:"eva:checkmark-fill"})})]},t.id),t.name),renderTags:(n,t)=>n.map((d,c)=>h.createElement(ps,{...t({index:c}),key:d.id,label:d.name,avatar:e.jsx(O,{alt:d.name,src:d.avatarUrl}),size:"small",variant:"soft"}))})]})}function to(){const[s,o]=h.useState(!1),[l,r]=h.useState(!1),a=h.useCallback(()=>{r(c=>!c)},[]),n=h.useCallback(()=>{r(!1)},[]),t=h.useCallback(()=>{o(!0)},[]),d=h.useCallback(()=>{o(!1)},[]);return{collapseDesktop:l,onCloseDesktop:n,onCollapseDesktop:a,openMobile:s,onOpenMobile:t,onCloseMobile:d}}export{eo as C,Xs as a,to as b,so as c,oo as d,no as e,ao as f,Ys as g,Ss as h,Us as i,Zs as j,Qs as k,Ks as u};

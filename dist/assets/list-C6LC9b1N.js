import{Y as O,ca as Q,j as e,cb as Z,cc as X,cd as k,R,I as C,aJ as W,D as ee,f as B,B as s,aP as K,a1 as U,bw as ae,aj as te,S,cG as V,r as v,au as se,a0 as oe,dy as _,a_ as E,dA as ne,dC as ie,dD as le,c5 as re,eA as ce,b8 as q,T as H,aZ as de,p as M,l as he,U as xe,n as me,c4 as ue,dF as ge,H as pe,C as fe}from"./index-D82XrlGq.js";import{u as je}from"./property-D2aquZ-Y.js";import{u as be,g as ve,r as Ce,e as ye,T as Pe}from"./table-no-data-DH7CjOyR.js";import{T as Te}from"./table-empty-rows-Vu5FyjZw.js";import{T as De}from"./table-head-custom-CuFVaOdc.js";import{T as Se}from"./table-pagination-custom-D5_o9sKp.js";import{C as Fe}from"./confirm-dialog-rvtuH5TT.js";import{b as w,T as ze,a as Ae}from"./TableHead-RMfhpLqX.js";import{T as D}from"./TableCell-9zzJlMjB.js";import{F as Me,a as L,c as $}from"./filters-result-BUC8QtIh.js";import{C as Ie}from"./Card-Bw-3A9ev.js";import"./index-nX3EE7Rc.js";import"./index-AY8D22yG.js";import"./empty-content-CAmd9egU.js";import"./TablePagination-DsJAP4En.js";import"./LastPage-xOhVKZvt.js";import"./Toolbar-CnhKmG_y.js";function ke({row:a,onDeleteRow:d,detailsHref:r,onUpdateStatus:j}){const o=O(),i=Q(),x=O(),b=()=>{var n,m,f;return e.jsxs(w,{hover:!0,children:[e.jsx(D,{children:e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:a.titulo})}),e.jsxs(D,{children:[e.jsx(s,{sx:{typography:"body2"},children:typeof a.localizacao=="string"?a.localizacao:typeof a.localizacao=="object"&&((n=a.localizacao)!=null&&n.bairro)&&((m=a.localizacao)!=null&&m.cidade)?`${a.localizacao.bairro}, ${a.localizacao.cidade}`:"Localização não informada"}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:typeof a.localizacao=="object"&&((f=a.localizacao)!=null&&f.estado)?a.localizacao.estado:""})]}),e.jsx(D,{children:e.jsx(s,{sx:{typography:"body2"},children:{apartment:"Apartamento",house:"Casa",commercial:"Comercial",land:"Terreno",penthouse:"Cobertura",studio:"Studio",loft:"Loft",farm:"Fazenda",warehouse:"Galpão",office:"Escritório",empreendimento:"Empreendimento",imovel:"Imóvel",terreno:"Terreno"}[a.tipo]||a.tipo||"Não informado"})}),e.jsx(D,{children:e.jsxs(K,{variant:"soft",color:a.status==="available"&&"success"||a.status==="reserved"&&"warning"||a.status==="sold"&&"info"||a.status==="inactive"&&"default"||"default",children:[a.status==="available"&&"Disponível",a.status==="reserved"&&"Reservado",a.status==="sold"&&"Vendido",a.status==="inactive"&&"Inativo"]})}),e.jsxs(D,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(U,{color:x.value?"inherit":"default",onClick:x.onToggle,sx:{...x.value&&{bgcolor:"action.hover"}},children:e.jsx(C,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(U,{color:i.open?"inherit":"default",onClick:i.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})})]})]})},p=()=>{var n,m,f,u;return e.jsx(w,{children:e.jsx(D,{sx:{p:0,border:"none"},colSpan:5,children:e.jsx(ae,{in:x.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(te,{sx:{m:1.5},children:e.jsxs(s,{sx:h=>({display:"flex",alignItems:"flex-start",p:h.spacing(2),gap:2}),children:[a.imagens&&a.imagens.length>0&&a.imagens[0]&&e.jsx(s,{component:"img",src:a.imagens[0],alt:a.titulo,sx:{width:120,height:80,borderRadius:1,objectFit:"cover",flexShrink:0}}),e.jsxs(S,{sx:{flex:1},spacing:1.5,children:[e.jsx(s,{children:e.jsx(s,{sx:{typography:"subtitle2",mb:.5},children:a.titulo})}),e.jsxs(S,{spacing:1.5,children:[e.jsxs(s,{children:[e.jsx(s,{sx:{typography:"caption",color:"text.secondary",mb:.5},children:"Localização"}),e.jsx(s,{sx:{typography:"body2"},children:typeof a.localizacao=="string"?a.localizacao:(n=a.localizacao)!=null&&n.endereco?`${a.localizacao.endereco}, ${a.localizacao.bairro}, ${a.localizacao.cidade} - ${a.localizacao.estado}`:"Localização não informada"})]}),e.jsxs(s,{children:[e.jsx(s,{sx:{typography:"caption",color:"text.secondary",mb:.5},children:"Características"}),e.jsxs(s,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(80px, 1fr))",gap:1},children:[e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:(()=>{if(a.tipo==="empreendimento"){const h=[];if(h&&h.length>0){const g=h.filter(c=>(c.precoPorM2||c.pricePerM2||c.price_per_m2)>0);if(g.length>0){const c=g.map(P=>P.precoPorM2||P.pricePerM2||P.price_per_m2),y=c.reduce((P,I)=>P+I,0)/c.length;return`R$ ${Math.round(y)}/m²`}}return a.preco?V(a.preco):"Consulte"}return a.preco?V(a.preco):"Consulte"})()}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Preço"})]}),a.tipo==="empreendimento"?e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:[].length||0}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Plantas"})]}),e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:(()=>{const h=[];if(h&&h.length>0){const g=h.map(c=>c.area).filter(c=>c>0);if(g.length>0){const c=Math.min(...g),y=Math.max(...g);return c===y?`${c}m²`:`${c}-${y}m²`}}return a.area||0})()}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Área"})]})]}):a.tipo==="terreno"?e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:(()=>{var c;const h=a.preco||0,g=a.area||((c=a.caracteristicas)==null?void 0:c.area)||0;return h>0&&g>0?`R$ ${Math.round(h/g)}/m²`:"N/A"})()}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Valor/m²"})]}),e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:(()=>{var g;const h=a.area||((g=a.caracteristicas)==null?void 0:g.area)||0;return h>0?`${h}m²`:"N/A"})()}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Área"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:((m=a.caracteristicas)==null?void 0:m.quartos)||0}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Quartos"})]}),e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:((f=a.caracteristicas)==null?void 0:f.banheiros)||0}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Banheiros"})]}),e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(s,{sx:{typography:"body2",fontWeight:"fontWeightMedium"},children:((u=a.caracteristicas)==null?void 0:u.vagasGaragem)||0}),e.jsx(s,{sx:{typography:"caption",color:"text.disabled"},children:"Vagas"})]})]})]})]}),a.descricao&&e.jsxs(s,{children:[e.jsx(s,{sx:{typography:"caption",color:"text.secondary",mb:.5},children:"Descrição"}),e.jsx(s,{sx:{typography:"body2",color:"text.secondary"},children:a.descricao.length>150?`${a.descricao.substring(0,150)}...`:a.descricao})]})]}),e.jsx(S,{direction:"row",spacing:1,sx:{pt:1},children:e.jsx(B,{component:R,href:r,size:"small",variant:"outlined",startIcon:e.jsx(C,{icon:"solar:eye-bold"}),children:"Ver detalhes"})})]})]})})})})})};return e.jsxs(e.Fragment,{children:[b(),p(),e.jsx(Z,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(X,{children:[e.jsxs(k,{component:R,href:r,onClick:i.onClose,children:[e.jsx(C,{icon:"solar:eye-bold"}),e.jsx(W,{primary:"Ver detalhes"})]}),e.jsxs(k,{component:R,href:`${r}/edit`,onClick:i.onClose,children:[e.jsx(C,{icon:"solar:pen-bold"}),e.jsx(W,{primary:"Editar"})]}),e.jsx(ee,{sx:{borderStyle:"dashed"}}),e.jsxs(k,{onClick:()=>{o.onTrue(),i.onClose()},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),e.jsx(W,{primary:"Excluir"})]})]})}),e.jsx(Fe,{open:o.value,onClose:o.onFalse,title:"Excluir imóvel",content:"Tem certeza de que deseja excluir este imóvel?",action:e.jsx(B,{variant:"contained",color:"error",onClick:()=>{d(),o.onFalse()},children:"Excluir"})})]})}function Re({filters:a,onResetPage:d,dateError:r}){const{state:j,setState:o}=a,i=v.useCallback(p=>{d(),o({name:p.target.value})},[d,o]),x=v.useCallback(p=>{d(),o({startDate:p})},[d,o]),b=v.useCallback(p=>{d(),o({endDate:p})},[d,o]);return e.jsx(S,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:e.jsxs(S,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:[e.jsx(se,{fullWidth:!0,value:j.name,onChange:i,placeholder:"Buscar produto...",InputProps:{startAdornment:e.jsx(oe,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(_,{label:"Data inicial",value:j.startDate,onChange:x,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:200}}}),e.jsx(_,{label:"Data final",value:j.endDate,onChange:b,slotProps:{textField:{fullWidth:!0,error:r,helperText:r?"A data final deve ser posterior à data inicial":null}},sx:{maxWidth:{md:200}}})]})})}function We({filters:a,totalResults:d,onResetPage:r,sx:j}){const{state:o,setState:i,resetState:x}=a,b=v.useCallback(()=>{r(),i({name:""})},[r,i]),p=v.useCallback(()=>{r(),i({status:"all"})},[r,i]),n=v.useCallback(()=>{r(),i({startDate:null,endDate:null})},[r,i]),m=v.useCallback(()=>{r(),x()},[r,x]);return e.jsxs(Me,{totalResults:d,onReset:m,sx:j,children:[e.jsx(L,{label:"Status:",isShow:o.status!=="all",children:e.jsx(E,{...$,label:o.status,onDelete:p,sx:{textTransform:"capitalize"}})}),e.jsx(L,{label:"Date:",isShow:!!(o.startDate&&o.endDate),children:e.jsx(E,{...$,label:ne(o.startDate,o.endDate),onDelete:n})}),e.jsx(L,{label:"Keyword:",isShow:!!o.name,children:e.jsx(E,{...$,label:o.name,onDelete:b})})]})}const Ee=[{value:"all",label:"Todos os tipos",color:"default"},{value:"imovel",label:"Imóveis",color:"primary"},{value:"terreno",label:"Terrenos",color:"success"},{value:"empreendimento",label:"Empreendimentos",color:"warning"}],Le=[{id:"titulo",label:"Título"},{id:"localizacao",label:"Localização",width:180},{id:"tipo",label:"Tipo",width:120},{id:"status",label:"Status",width:110},{id:"",width:88}];function $e(){const a=be({defaultOrderBy:"titulo"}),{properties:d,propertiesLoading:r,propertiesError:j}=je(),[o,i]=v.useState([]);v.useEffect(()=>{if(d&&d.length>0){const l=d.map((t,F)=>{var z,A,T,N,G;return{id:t.id,codigo:`IMO-${(t.id||`${F}`).toString().slice(-4).padStart(4,"0")}`,titulo:t.name||t.title||"Imóvel sem título",descricao:t.description||"Sem descrição",area:t.totalArea||0,preco:t.value||t.salePrice||0,precoM2:t.pricePerSquareMeter||(t.value&&t.totalArea?Math.round(t.value/t.totalArea):0),finalidade:t.purpose||"venda",status:t.status||"available",tipo:t.tipo||t.type||"imovel",condicao:t.condition||"usado",quartos:t.bedrooms||0,banheiros:t.bathrooms||0,suites:t.suites||0,vagasGaragem:t.parkingSpaces||0,mobiliado:t.furnished||!1,anoConstucao:t.yearBuilt||"",elevador:t.elevator||!1,sacada:t.balcony||!1,posicaoSolar:t.sunPosition||"",createdAt:t.createdAt,updatedAt:t.updatedAt,localizacao:t.address||"Localização não informada",proprietario:{id:t.ownerId||"",nome:((z=t.owner)==null?void 0:z.name)||"Proprietário não informado",email:((A=t.owner)==null?void 0:A.email)||"",telefone:((T=t.owner)==null?void 0:T.phone)||"",avatarUrl:((N=t.owner)==null?void 0:N.avatarUrl)||"",documento:((G=t.owner)==null?void 0:G.document)||""},caracteristicas:{area:t.totalArea||0,quartos:t.bedrooms||0,banheiros:t.bathrooms||0,suites:t.suites||0,vagasGaragem:t.parkingSpaces||0,anoConstucao:t.yearBuilt||"",elevador:t.elevator||!1,sacada:t.balcony||!1,mobiliado:t.furnished||!1,condicao:t.condition||"usado",documentacao:t.hasDocumentation?"Completa":"Incompleta"},valores:{valorVenda:t.salePrice||0,valorAluguel:t.rentPrice||0,valorCondominio:t.condominiumFee||0,valorIPTU:t.propertyTax||0,aceitaFinanciamento:t.acceptsFinancing||!1},imagens:t.images||[],destaque:t.highlightProperty||!1,negociavel:t.acceptsFinancing||!1,observacoes:t.description||"",corretor:t.broker?t.broker:"Sem corretor"}});i(l)}else!r&&(!d||d.length===0)&&i([])},[d,r]);const x=ie({name:"",status:"all",startDate:null,endDate:null}),[b,p]=v.useState("all"),{state:n,setState:m}=x,f=le(n.startDate,n.endDate),u=Be({inputData:o,comparator:ve(a.order,a.orderBy),filters:n,typeFilter:b,dateError:f}),h=Ce(u,a.page,a.rowsPerPage),g=!!n.name||b!=="all"||!!n.startDate&&!!n.endDate,c=o.length===0&&!r&&!j,y=!u.length&&g,P=c||y,I=v.useCallback(l=>{const t=o.filter(F=>F.id!==l);re.success("Imóvel removido com sucesso!"),i(t),a.onUpdatePageDeleteRow(h.length)},[h.length,a,o]),Y=v.useCallback((l,t)=>{const z={disponivel:"available",reservado:"reserved",vendido:"sold",suspenso:"inactive"}[t]||t,A=o.map(T=>T.id===l?{...T,status:z}:T);i(A)},[o]),J=v.useCallback((l,t)=>{a.onResetPage(),p(t)},[a]);return r?e.jsx(ce,{}):j?e.jsx(q,{children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",minHeight:400,textAlign:"center"},children:[e.jsx(C,{icon:"eva:alert-triangle-fill",sx:{width:64,height:64,color:"error.main",mb:2}}),e.jsx(H,{variant:"h6",sx:{mb:1},children:"Erro ao carregar produtos"}),e.jsx(H,{variant:"body2",color:"text.secondary",children:j.message||"Ocorreu um erro inesperado"})]})}):e.jsx(e.Fragment,{children:e.jsxs(q,{children:[e.jsxs(S,{direction:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},justifyContent:"space-between",spacing:{xs:2,sm:0},sx:{mb:{xs:3,md:5}},children:[e.jsx(de,{heading:"Todos os produtos",links:[{name:"Dashboard",href:M.dashboard.root},{name:"Produtos",href:M.dashboard.property.root},{name:"Lista de produtos"}],sx:{".MuiTypography-h4":{fontSize:{xs:"1.25rem",md:"1.5rem"}}}}),e.jsx(B,{variant:"contained",startIcon:e.jsx(C,{icon:"eva:plus-fill"}),href:M.dashboard.property.new,sx:{fontSize:{xs:"0.875rem",md:"1rem"},width:{xs:"100%",sm:"auto"}},children:"Novo produto"})]}),e.jsxs(Ie,{children:[e.jsx(he,{value:b,onChange:J,sx:[l=>({px:2.5,boxShadow:`inset 0 -2px 0 0 ${xe(l.vars.palette.grey["500Channel"],.08)}`})],children:Ee.map(l=>e.jsx(me,{iconPosition:"end",value:l.value,label:l.label,icon:e.jsx(K,{variant:(l.value==="all"||l.value===b)&&"filled"||"soft",color:l.color||"default",children:l.value==="all"?o.length:o.filter(t=>t.tipo===l.value).length})},l.value))}),e.jsx(Re,{filters:x,onResetPage:a.onResetPage,dateError:f}),g&&e.jsx(We,{filters:x,totalResults:u.length,onResetPage:a.onResetPage,sx:{p:2.5,pt:0}}),e.jsx(s,{sx:{position:"relative"},children:e.jsx(ue,{sx:{minHeight:444},children:e.jsxs(ze,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(De,{order:a.order,orderBy:a.orderBy,headCells:Le,rowCount:u.length,numSelected:0,onSort:a.onSort}),e.jsxs(Ae,{children:[u.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(l=>e.jsx(ke,{row:l,onDeleteRow:()=>I(l.id),onUpdateStatus:t=>Y(l.id,t),detailsHref:M.dashboard.property.details(l.id)},l.id)),e.jsx(Te,{height:a.dense?56:76,emptyRows:ye(a.page,a.rowsPerPage,u.length)}),e.jsx(Pe,{notFound:P,title:c?"Nenhum produto registrado":"Nenhum resultado encontrado"})]})]})})}),e.jsx(Se,{page:a.page,dense:a.dense,count:u.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})]})})}function Be({inputData:a,comparator:d,filters:r,typeFilter:j,dateError:o}){const{name:i,startDate:x,endDate:b}=r,p=a.map((n,m)=>[n,m]);return p.sort((n,m)=>{const f=d(n[0],m[0]);return f!==0?f:n[1]-m[1]}),a=p.map(n=>n[0]),i&&(a=a.filter(({codigo:n,titulo:m,proprietario:f})=>[n,m,f.nome,f.email].some(u=>u==null?void 0:u.toLowerCase().includes(i.toLowerCase())))),j!=="all"&&(a=a.filter(n=>n.tipo===j)),o||x&&b&&(a=a.filter(n=>ge(n.createdAt,x,b))),a}const Ne={title:`Lista de imóveis | Painel - ${fe.appName}`};function sa(){return e.jsxs(e.Fragment,{children:[e.jsx(pe,{children:e.jsxs("title",{children:[" ",Ne.title]})}),e.jsx($e,{})]})}export{sa as default};

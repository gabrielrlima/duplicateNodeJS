import{j as e,B as C,S as E,I as m,dV as L,U as _,T as N,bf as oe,a$ as U,b0 as K,Y as G,br as Y,A as re,aJ as R,L as ie,R as A,df as O,aK as W,aP as J,a1 as y,b1 as Q,b2 as X,b3 as f,D as Z,f as B,r as b,dW as ce,dX as de,dU as he,dY as xe,dL as V,bh as ue,au as pe,a0 as me,bc as P,dM as je,u as be,dZ as ge,bd as ve,dO as fe,cN as z,cV as Ce,bj as ye,p as D,bp as H,l as De,n as Se,d_ as Te,a_ as w,dQ as ke,H as Pe,C as we}from"./index-cNRh_qft.js";import{C as q}from"./confirm-dialog-V5NQjZtL.js";import{u as Fe,g as Ie,r as Ae,e as Re,T as Ee}from"./table-no-data-CeEeU6Ls.js";import{T as Be}from"./table-empty-rows-BTCIE_YQ.js";import{T as Le}from"./table-head-custom-DSpcVu4-.js";import{T as Ne}from"./table-selected-action-DJkdQzwk.js";import{T as Oe}from"./table-pagination-custom-xTp1jojO.js";import{T as We,a as Ve,b as ze}from"./TableHead-DBnjkyMB.js";import{T as v}from"./TableCell-CGwO8Re3.js";import{F as He,a as F,c as I}from"./filters-result-BTXXEhsP.js";import{C as $}from"./Card-C_-31fGp.js";import{s as M}from"./sumBy-ofy1HSRF.js";import"./invoice-pdf-op1XGN9c.js";import"./empty-content-BzM3Az2z.js";import"./TablePagination-CNNZgEcm.js";import"./LastPage-ChYIEhQh.js";import"./Toolbar-BaRJzfzK.js";import"./schema-helper-D18en8Wv.js";import"./address-new-form-DjRCGj6o.js";function S({title:s,total:t,icon:d,color:o,percent:n,price:i}){return e.jsxs(C,{sx:{width:1,gap:2.5,minWidth:200,display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsxs(E,{alignItems:"center",justifyContent:"center",sx:{position:"relative"},children:[e.jsx(m,{icon:d,width:32,sx:{color:o,position:"absolute"}}),e.jsx(L,{size:56,thickness:2,value:n,variant:"determinate",sx:{color:o,opacity:.48}}),e.jsx(L,{size:56,value:100,thickness:3,variant:"determinate",sx:[a=>({top:0,left:0,opacity:.48,position:"absolute",color:_(a.vars.palette.grey["500Channel"],.16)})]})]}),e.jsxs(E,{spacing:.5,children:[e.jsx(N,{variant:"subtitle1",children:s}),e.jsxs(C,{component:"span",sx:{color:"text.disabled",typography:"body2"},children:[oe(t)," invoices"]}),e.jsx(N,{variant:"subtitle2",children:U(i)})]})]})}function $e({row:s,selected:t,editHref:d,onSelectRow:o,onDeleteRow:n,detailsHref:i}){const a=K(),j=G(),g=()=>e.jsx(Q,{open:a.open,anchorEl:a.anchorEl,onClose:a.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(X,{children:[e.jsx("li",{children:e.jsxs(f,{component:A,href:i,onClick:a.onClose,children:[e.jsx(m,{icon:"solar:eye-bold"}),"View"]})}),e.jsx("li",{children:e.jsxs(f,{component:A,href:d,onClick:a.onClose,children:[e.jsx(m,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(Z,{sx:{borderStyle:"dashed"}}),e.jsxs(f,{onClick:()=>{j.onTrue(),a.onClose()},sx:{color:"error.main"},children:[e.jsx(m,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),h=()=>e.jsx(q,{open:j.value,onClose:j.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(B,{variant:"contained",color:"error",onClick:n,children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(We,{hover:!0,selected:t,children:[e.jsx(v,{padding:"checkbox",children:e.jsx(Y,{checked:t,onClick:o,inputProps:{id:`${s.id}-checkbox`,"aria-label":`${s.id} checkbox`}})}),e.jsx(v,{children:e.jsxs(C,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(re,{alt:s.invoiceTo.name,children:s.invoiceTo.name.charAt(0).toUpperCase()}),e.jsx(R,{primary:s.invoiceTo.name,secondary:e.jsx(ie,{component:A,href:i,color:"inherit",children:s.invoiceNumber}),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{color:"text.disabled","&:hover":{color:"text.secondary"}}}}})]})}),e.jsx(v,{children:e.jsx(R,{primary:W(s.createDate),secondary:O(s.createDate),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{mt:.5,typography:"caption"}}}})}),e.jsx(v,{children:e.jsx(R,{primary:W(s.dueDate),secondary:O(s.dueDate),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{mt:.5,typography:"caption"}}}})}),e.jsx(v,{children:U(s.totalAmount)}),e.jsx(v,{align:"center",children:s.sent}),e.jsx(v,{children:e.jsx(J,{variant:"soft",color:s.status==="paid"&&"success"||s.status==="pending"&&"warning"||s.status==="overdue"&&"error"||"default",children:s.status})}),e.jsx(v,{align:"right",sx:{px:1},children:e.jsx(y,{color:a.open?"inherit":"default",onClick:a.onOpen,children:e.jsx(m,{icon:"eva:more-vertical-fill"})})})]}),g(),h()]})}function Me({filters:s,options:t,dateError:d,onResetPage:o}){const n=K(),{state:i,setState:a}=s,j=b.useCallback(r=>{o(),a({name:r.target.value})},[o,a]),g=b.useCallback(r=>{const u=typeof r.target.value=="string"?r.target.value.split(","):r.target.value;o(),a({service:u})},[o,a]),h=b.useCallback(r=>{o(),a({startDate:r})},[o,a]),c=b.useCallback(r=>{o(),a({endDate:r})},[o,a]),x=()=>e.jsx(Q,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(X,{children:[e.jsxs(f,{onClick:()=>n.onClose(),children:[e.jsx(m,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),e.jsxs(f,{onClick:()=>n.onClose(),children:[e.jsx(m,{icon:"solar:import-bold"}),"Import"]}),e.jsxs(f,{onClick:()=>n.onClose(),children:[e.jsx(m,{icon:"solar:export-bold"}),"Export"]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(C,{sx:{p:2.5,gap:2,display:"flex",pr:{xs:2.5,md:1},flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"}},children:[e.jsxs(ce,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[e.jsx(de,{htmlFor:"filter-service-select",children:"Service"}),e.jsx(he,{multiple:!0,value:i.service,onChange:g,input:e.jsx(xe,{label:"Service"}),renderValue:r=>r.map(u=>u).join(", "),inputProps:{id:"filter-service-select"},sx:{textTransform:"capitalize"},children:t.services.map(r=>e.jsxs(f,{value:r,children:[e.jsx(Y,{disableRipple:!0,size:"small",checked:i.service.includes(r),inputProps:{id:`${r}-checkbox`,"aria-label":`${r} checkbox`}}),r]},r))})]}),e.jsx(V,{label:"Data inicial",value:i.endDate,onChange:h,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:180}}}),e.jsx(V,{label:"Data final",value:i.endDate,onChange:c,slotProps:{textField:{fullWidth:!0,error:d,helperText:d?"End date must be later than start date":null}},sx:{maxWidth:{md:180},[`& .${ue.root}`]:{bottom:{md:-40},position:{md:"absolute"}}}}),e.jsxs(C,{sx:{gap:2,width:1,flexGrow:1,display:"flex",alignItems:"center"},children:[e.jsx(pe,{fullWidth:!0,value:i.name,onChange:j,placeholder:"Search customer or invoice number...",slotProps:{input:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(m,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}}),e.jsx(y,{onClick:n.onOpen,children:e.jsx(m,{icon:"eva:more-vertical-fill"})})]})]}),x()]})}function _e({filters:s,totalResults:t,onResetPage:d,sx:o}){const{state:n,setState:i,resetState:a}=s,j=b.useCallback(()=>{d(),i({name:""})},[d,i]),g=b.useCallback(x=>{const r=n.service.filter(u=>u!==x);d(),i({service:r})},[d,i,n.service]),h=b.useCallback(()=>{d(),i({status:"all"})},[d,i]),c=b.useCallback(()=>{d(),i({startDate:null,endDate:null})},[d,i]);return e.jsxs(He,{totalResults:t,onReset:()=>a(),sx:o,children:[e.jsx(F,{label:"Service:",isShow:!!n.service.length,children:n.service.map(x=>b.createElement(P,{...I,key:x,label:x,onDelete:()=>g(x)}))}),e.jsx(F,{label:"Status:",isShow:n.status!=="all",children:e.jsx(P,{...I,label:n.status,onDelete:h,sx:{textTransform:"capitalize"}})}),e.jsx(F,{label:"Date:",isShow:!!(n.startDate&&n.endDate),children:e.jsx(P,{...I,label:je(n.startDate,n.endDate),onDelete:c})}),e.jsx(F,{label:"Keyword:",isShow:!!n.name,children:e.jsx(P,{...I,label:n.name,onDelete:j})})]})}const Ue=[{id:"invoiceNumber",label:"Customer"},{id:"createDate",label:"Create"},{id:"dueDate",label:"Due"},{id:"price",label:"Amount"},{id:"sent",label:"Sent",align:"center"},{id:"status",label:"Status"},{id:""}];function Ke(){const s=be(),t=Fe({defaultOrderBy:"createDate"}),d=G(),[o,n]=b.useState(ge),i=ve({name:"",service:[],status:"all",startDate:null,endDate:null}),{state:a,setState:j}=i,g=fe(a.startDate,a.endDate),h=Ge({inputData:o,comparator:Ie(t.order,t.orderBy),filters:a,dateError:g}),c=Ae(h,t.page,t.rowsPerPage),x=!!a.name||a.service.length>0||a.status!=="all"||!!a.startDate&&!!a.endDate,r=!h.length&&x||!h.length,u=l=>o.filter(p=>p.status===l).length,T=l=>M(o.filter(p=>p.status===l),p=>p.totalAmount),k=l=>u(l)/o.length*100,ee=[{value:"all",label:"All",color:"default",count:o.length},{value:"paid",label:"Paid",color:"success",count:u("paid")},{value:"pending",label:"Pending",color:"warning",count:u("pending")},{value:"overdue",label:"Overdue",color:"error",count:u("overdue")},{value:"draft",label:"Draft",color:"default",count:u("draft")}],te=b.useCallback(l=>{const p=o.filter(ne=>ne.id!==l);z.success("Apagado com sucesso!"),n(p),t.onUpdatePageDeleteRow(c.length)},[c.length,t,o]),se=b.useCallback(()=>{const l=o.filter(p=>!t.selected.includes(p.id));z.success("Apagado com sucesso!"),n(l),t.onUpdatePageDeleteRows(c.length,h.length)},[h.length,c.length,t,o]),ae=b.useCallback((l,p)=>{t.onResetPage(),j({status:p})},[j,t]),le=()=>e.jsx(q,{open:d.value,onClose:d.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(B,{variant:"contained",color:"error",onClick:()=>{se(),d.onFalse()},children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{children:[e.jsx(ye,{heading:"List",links:[{name:"Dashboard",href:D.dashboard.root},{name:"Invoice",href:D.dashboard.invoice.root},{name:"List"}],action:e.jsx(B,{component:A,href:D.dashboard.invoice.new,variant:"contained",startIcon:e.jsx(m,{icon:"mingcute:add-line"}),children:"New invoice"}),sx:{mb:{xs:3,md:5}}}),e.jsx($,{sx:{mb:{xs:3,md:5}},children:e.jsx(H,{sx:{minHeight:108},children:e.jsxs(E,{divider:e.jsx(Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2,flexDirection:"row"},children:[e.jsx(S,{title:"Total",total:o.length,percent:100,price:M(o,l=>l.totalAmount),icon:"solar:bill-list-bold-duotone",color:s.vars.palette.info.main}),e.jsx(S,{title:"Paid",total:u("paid"),percent:k("paid"),price:T("paid"),icon:"solar:file-check-bold-duotone",color:s.vars.palette.success.main}),e.jsx(S,{title:"Pending",total:u("pending"),percent:k("pending"),price:T("pending"),icon:"solar:sort-by-time-bold-duotone",color:s.vars.palette.warning.main}),e.jsx(S,{title:"Overdue",total:u("overdue"),percent:k("overdue"),price:T("overdue"),icon:"solar:bell-bing-bold-duotone",color:s.vars.palette.error.main}),e.jsx(S,{title:"Draft",total:u("draft"),percent:k("draft"),price:T("draft"),icon:"solar:file-corrupted-bold-duotone",color:s.vars.palette.text.secondary})]})})}),e.jsxs($,{children:[e.jsx(De,{value:a.status,onChange:ae,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${_(s.vars.palette.grey["500Channel"],.08)}`},children:ee.map(l=>e.jsx(Se,{value:l.value,label:l.label,iconPosition:"end",icon:e.jsx(J,{variant:(l.value==="all"||l.value===a.status)&&"filled"||"soft",color:l.color,children:l.count})},l.value))}),e.jsx(Me,{filters:i,dateError:g,onResetPage:t.onResetPage,options:{services:Te.map(l=>l.name)}}),x&&e.jsx(_e,{filters:i,onResetPage:t.onResetPage,totalResults:h.length,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Ne,{dense:t.dense,numSelected:t.selected.length,rowCount:h.length,onSelectAllRows:l=>{t.onSelectAllRows(l,h.map(p=>p.id))},action:e.jsxs(C,{sx:{display:"flex"},children:[e.jsx(w,{title:"Sent",children:e.jsx(y,{color:"primary",children:e.jsx(m,{icon:"iconamoon:send-fill"})})}),e.jsx(w,{title:"Download",children:e.jsx(y,{color:"primary",children:e.jsx(m,{icon:"eva:download-outline"})})}),e.jsx(w,{title:"Print",children:e.jsx(y,{color:"primary",children:e.jsx(m,{icon:"solar:printer-minimalistic-bold"})})}),e.jsx(w,{title:"Delete",children:e.jsx(y,{color:"primary",onClick:d.onTrue,children:e.jsx(m,{icon:"solar:trash-bin-trash-bold"})})})]})}),e.jsx(H,{sx:{minHeight:444},children:e.jsxs(Ve,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(Le,{order:t.order,orderBy:t.orderBy,headCells:Ue,rowCount:h.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:l=>t.onSelectAllRows(l,h.map(p=>p.id))}),e.jsxs(ze,{children:[h.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(l=>e.jsx($e,{row:l,selected:t.selected.includes(l.id),onSelectRow:()=>t.onSelectRow(l.id),onDeleteRow:()=>te(l.id),editHref:D.dashboard.invoice.edit(l.id),detailsHref:D.dashboard.invoice.details(l.id)},l.id)),e.jsx(Be,{height:t.dense?56:76,emptyRows:Re(t.page,t.rowsPerPage,h.length)}),e.jsx(Ee,{notFound:r})]})]})})]}),e.jsx(Oe,{page:t.page,dense:t.dense,count:h.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]})]}),le()]})}function Ge({inputData:s,comparator:t,filters:d,dateError:o}){const{name:n,status:i,service:a,startDate:j,endDate:g}=d,h=s.map((c,x)=>[c,x]);return h.sort((c,x)=>{const r=t(c[0],x[0]);return r!==0?r:c[1]-x[1]}),s=h.map(c=>c[0]),n&&(s=s.filter(({invoiceNumber:c,invoiceTo:x})=>[c,x.name,x.company,x.phoneNumber].some(r=>r==null?void 0:r.toLowerCase().includes(n.toLowerCase())))),i!=="all"&&(s=s.filter(c=>c.status===i)),a.length&&(s=s.filter(c=>c.items.some(x=>a.includes(x.service)))),o||j&&g&&(s=s.filter(c=>ke(c.createDate,j,g))),s}const Ye={title:`Invoice list | Dashboard - ${we.appName}`};function pt(){return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[" ",Ye.title]})}),e.jsx(Ke,{})]})}export{pt as default};

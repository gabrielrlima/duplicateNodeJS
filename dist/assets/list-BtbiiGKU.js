import{y as M,z as V,O as W,c5 as E,j as e,aS as q,aT as H,F as G,aU as Q,aq as $,B as T,K as b,cd as p,aV as K,f as F,N as J,Q as f,a3 as Y,V as Z,ca as R,Y as A,b1 as X,A as ee,S as ae,L as se,aP as N,a1 as I,I as v,cb as B,cc as U,p as D,R as O,r as j,dM as te,dL as oe,dJ as le,dN as re,au as ne,a0 as ie,a_ as k,dC as de,b8 as ce,aZ as ue,l as me,U as he,n as pe,c3 as xe,c4 as be,H as je,C as ge}from"./index-D82XrlGq.js";import{L as fe,B as Ce,P as ve,U as Se,_ as Te}from"./_lead-DfGz-726.js";import{C as z}from"./confirm-dialog-rvtuH5TT.js";import{u as Pe,g as De,r as ke,e as ye,T as we}from"./table-no-data-DH7CjOyR.js";import{T as Fe}from"./table-empty-rows-Vu5FyjZw.js";import{T as Ee}from"./table-head-custom-CuFVaOdc.js";import{T as Ae}from"./table-selected-action-B1DH3GwP.js";import{T as Ie}from"./table-pagination-custom-D5_o9sKp.js";import{s as L}from"./schema-helper-BcHhi0sG.js";import{b as Le,T as Re,a as Ne}from"./TableHead-RMfhpLqX.js";import{T as P}from"./TableCell-9zzJlMjB.js";import{F as Be,a as y,c as w}from"./filters-result-BUC8QtIh.js";import{C as Ue}from"./Card-Bw-3A9ev.js";import"./empty-content-CAmd9egU.js";import"./TablePagination-DsJAP4En.js";import"./LastPage-xOhVKZvt.js";import"./Toolbar-CnhKmG_y.js";const Oe=W({name:f().min(1,{message:"Nome é obrigatório!"}),email:f().min(1,{message:"Email é obrigatório!"}).email({message:"Email deve ser um endereço válido!"}),phoneNumber:L.phoneNumber({isValid:Y}),country:L.nullableInput(f().min(1,{message:"País é obrigatório!"}),{message:"País é obrigatório!"}),state:f().min(1,{message:"Estado é obrigatório!"}),city:f().min(1,{message:"Cidade é obrigatória!"}),address:f().min(1,{message:"Endereço é obrigatório!"}),zipCode:f().min(1,{message:"CEP é obrigatório!"}),productInterest:f().min(1,{message:"Produto de interesse é obrigatório!"}),interestUnit:f().min(1,{message:"Unidade de interesse é obrigatória!"}),broker:f().min(1,{message:"Corretor é obrigatório!"}),status:f()});function ze({currentLead:a,open:i,onClose:u}){const x={name:"",email:"",phoneNumber:"",address:"",country:"",state:"",city:"",zipCode:"",status:"",productInterest:"",interestUnit:"",broker:""},o=M({mode:"all",resolver:V(Oe),defaultValues:x,values:a}),{reset:l,handleSubmit:c,formState:{isSubmitting:d}}=o,m=c(async r=>{const h=new Promise(n=>setTimeout(n,1e3));try{l(),u(),E.promise(h,{loading:"Loading...",success:"Update success!",error:"Update error!"}),await h,console.info("DATA",r)}catch(n){console.error(n)}});return e.jsxs(q,{fullWidth:!0,maxWidth:!1,open:i,onClose:u,PaperProps:{sx:{maxWidth:720}},children:[e.jsx(H,{children:"Edição rápida de lead"}),e.jsxs(G,{methods:o,onSubmit:m,children:[e.jsxs(Q,{children:[e.jsx($,{variant:"outlined",severity:"info",sx:{mb:3},children:"Lead aguardando qualificação"}),e.jsxs(T,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(b.Select,{name:"status",label:"Status",children:fe.map(r=>e.jsx(p,{value:r.value,children:r.label},r.value))}),e.jsx(b.Select,{name:"broker",label:"Corretor",children:Ce.map(r=>e.jsx(p,{value:r,children:r},r))}),e.jsx(b.Text,{name:"name",label:"Nome"}),e.jsx(b.Text,{name:"email",label:"Email"}),e.jsx(b.Phone,{name:"phoneNumber",label:"Telefone"}),e.jsx(b.Text,{name:"address",label:"Endereço"}),e.jsx(b.CountrySelect,{fullWidth:!0,name:"country",label:"País",placeholder:"Escolha um país"}),e.jsx(b.Text,{name:"state",label:"Estado"}),e.jsx(b.Text,{name:"city",label:"Cidade"}),e.jsx(b.Text,{name:"zipCode",label:"CEP"}),e.jsx(b.Select,{name:"productInterest",label:"Produto interessado",children:ve.map(r=>e.jsx(p,{value:r.value,children:r.label},r.value))}),e.jsx(b.Select,{name:"interestUnit",label:"Unidade de interesse",children:Se.map(r=>e.jsx(p,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs(K,{children:[e.jsx(F,{variant:"outlined",onClick:u,children:"Cancelar"}),e.jsx(J,{type:"submit",variant:"contained",loading:d,children:"Atualizar"})]})]})]})}function _e({row:a,selected:i,editHref:u,onSelectRow:x,onDeleteRow:o}){const l=Z(),c=R(),d=A(),m=A(),r=()=>{l.push(D.dashboard.lead.details(a.id))},h=()=>e.jsx(ze,{currentLead:a,open:m.value,onClose:m.onFalse}),n=()=>e.jsx(B,{open:c.open,anchorEl:c.anchorEl,onClose:c.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(U,{children:[e.jsxs(p,{component:O,href:D.dashboard.lead.details(a.id),onClick:()=>c.onClose(),children:[e.jsx(v,{icon:"solar:pen-bold"}),"Editar"]}),e.jsxs(p,{onClick:()=>{d.onTrue(),c.onClose()},sx:{color:"error.main"},children:[e.jsx(v,{icon:"solar:trash-bin-trash-bold"}),"Apagar"]})]})}),S=()=>e.jsx(z,{open:d.value,onClose:d.onFalse,title:"Delete",content:"Você tem certeza que deseja apagar este lead?",action:e.jsx(F,{variant:"contained",color:"error",onClick:o,children:"Apagar"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Le,{hover:!0,selected:i,"aria-checked":i,tabIndex:-1,onClick:r,sx:{cursor:"pointer"},children:[e.jsx(P,{padding:"checkbox",onClick:t=>{t.stopPropagation()},children:e.jsx(X,{checked:i,onClick:t=>{t.stopPropagation(),x()},inputProps:{id:`${a.id}-checkbox`,"aria-label":`${a.id} checkbox`}})}),e.jsx(P,{children:e.jsxs(T,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{alt:a.name,src:a.avatarUrl}),e.jsxs(ae,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(se,{color:"inherit",sx:{cursor:"pointer"},children:a.name}),e.jsx(T,{component:"span",sx:{color:"text.disabled"},children:a.phoneNumber})]})]})}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:a.email}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:a.productInterest}),e.jsx(P,{sx:{whiteSpace:"nowrap"},children:a.broker}),e.jsx(P,{children:e.jsxs(N,{variant:"soft",color:a.status==="ativo"&&"success"||a.status==="convertido"&&"info"||a.status==="perdido"&&"error"||a.status==="desativados"&&"default"||"default",children:[a.status==="ativo"&&"Ativo",a.status==="convertido"&&"Convertido",a.status==="perdido"&&"Perdido",a.status==="desativados"&&"Desativado"]})}),e.jsx(P,{onClick:t=>{t.stopPropagation()},children:e.jsx(T,{sx:{display:"flex",alignItems:"center"},children:e.jsx(I,{color:c.open?"inherit":"default",onClick:t=>{t.stopPropagation(),c.onOpen(t)},children:e.jsx(v,{icon:"eva:more-vertical-fill"})})})})]}),h(),n(),S()]})}function Me({filters:a,options:i,onResetPage:u,dateError:x}){const o=R(),{state:l,setState:c}=a,d=j.useCallback(h=>{u(),c({filterBy:h.target.value})},[u,c]),m=j.useCallback(h=>{u(),c({search:h.target.value})},[u,c]),r=()=>e.jsx(B,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(U,{children:[e.jsxs(p,{onClick:()=>o.onClose(),children:[e.jsx(v,{icon:"solar:printer-minimalistic-bold"}),"Imprimir"]}),e.jsxs(p,{onClick:()=>o.onClose(),children:[e.jsx(v,{icon:"solar:import-bold"}),"Importar"]}),e.jsxs(p,{onClick:()=>o.onClose(),children:[e.jsx(v,{icon:"solar:export-bold"}),"Exportar"]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(T,{sx:{p:2.5,gap:2.5,display:"flex",flexWrap:"wrap",alignItems:"flex-end"},children:[e.jsxs(T,{sx:{width:{xs:"100%",sm:200}},children:[e.jsx(te,{sx:{mb:1,fontSize:"0.875rem"},children:"Filtrar por"}),e.jsx(oe,{fullWidth:!0,children:e.jsxs(le,{value:l.filterBy||"name",onChange:d,input:e.jsx(re,{}),displayEmpty:!0,sx:{height:56},children:[e.jsx(p,{value:"name",children:"Nome"}),e.jsx(p,{value:"phoneNumber",children:"Número de Telefone"}),e.jsx(p,{value:"email",children:"Email"}),e.jsx(p,{value:"company",children:"Empresa"}),e.jsx(p,{value:"product",children:"Produto"})]})})]}),e.jsx(T,{sx:{flexGrow:1,width:{xs:"100%",sm:"auto"}},children:e.jsx(ne,{fullWidth:!0,value:l.search||"",onChange:m,placeholder:"Pesquisar por...",InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(I,{onClick:o.onOpen,children:e.jsx(v,{icon:"solar:menu-dots-bold"})})]}),r()]})}function Ve({filters:a,onResetPage:i,totalResults:u,sx:x}){const{state:o,setState:l,resetState:c}=a,d=j.useCallback(()=>{i(),l({search:""})},[i,l]),m=j.useCallback(()=>{i(),l({status:"todos"})},[i,l]),r=j.useCallback(()=>{i(),l({filterBy:"name"})},[i,l]),h=j.useCallback(()=>{i(),l({startDate:""})},[i,l]),n=j.useCallback(()=>{i(),l({endDate:""})},[i,l]),S=j.useCallback(()=>{i(),c()},[i,c]),t=C=>({name:"Nome",phoneNumber:"Telefone",email:"Email",company:"Empresa",product:"Produto"})[C]||C;return e.jsxs(Be,{totalResults:u,onReset:S,sx:x,children:[e.jsx(y,{label:"Filtrar por:",isShow:o.filterBy!=="name",children:e.jsx(k,{...w,label:t(o.filterBy||"name"),onDelete:r,sx:{textTransform:"capitalize"}})}),e.jsx(y,{label:"Status:",isShow:o.status!=="todos",children:e.jsx(k,{...w,label:o.status,onDelete:m,sx:{textTransform:"capitalize"}})}),e.jsx(y,{label:"Pesquisa:",isShow:!!o.search,children:e.jsx(k,{...w,label:o.search,onDelete:d})}),e.jsx(y,{label:"Data inicial:",isShow:!!o.startDate,children:e.jsx(k,{...w,label:o.startDate,onDelete:h})}),e.jsx(y,{label:"Data final:",isShow:!!o.endDate,children:e.jsx(k,{...w,label:o.endDate,onDelete:n})})]})}const We=[{value:"todos",label:"Todos"},{value:"ativo",label:"Ativos"},{value:"desativados",label:"Desativado"}],qe=[{id:"name",label:"Nome",width:300},{id:"email",label:"E-mail"},{id:"product",label:"Produto"},{id:"broker",label:"Corretor"},{id:"status",label:"Status"},{id:""}];function He(){const a=Pe(),i=A(),[u,x]=j.useState(Te),o=de({name:"",status:"todos",product:[],filterBy:"name",startDate:"",endDate:"",search:"",broker:""}),{state:l,setState:c}=o,d=Ge({inputData:u,comparator:De(a.order,a.orderBy),filters:l}),m=ke(d,a.page,a.rowsPerPage),r=!!l.name||l.product.length>0||l.status!=="todos"||!!l.search||!!l.broker,h=!d.length&&r||!d.length,n=j.useCallback(s=>{const g=u.filter(_=>_.id!==s);E.success("Apagado com sucesso!"),x(g),a.onUpdatePageDeleteRow(m.length)},[m.length,a,u]),S=j.useCallback(()=>{const s=u.filter(g=>!a.selected.includes(g.id));E.success("Apagado com sucesso!"),x(s),a.onUpdatePageDeleteRows(m.length,d.length)},[d.length,m.length,a,u]),t=j.useCallback((s,g)=>{a.onResetPage(),c({status:g})},[c,a]),C=()=>e.jsx(z,{open:i.value,onClose:i.onFalse,title:"Apagar",content:e.jsxs(e.Fragment,{children:["Você tem certeza que deseja apagar os ",e.jsxs("strong",{children:[" ",a.selected.length," "]})," leads?"]}),action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{S(),i.onFalse()},children:"Apagar"})});return e.jsxs(e.Fragment,{children:[e.jsxs(ce,{children:[e.jsx(ue,{heading:"Meus leads",links:[{name:"Painel",href:D.dashboard.root},{name:"Leads",href:D.dashboard.lead.list},{name:"Meus Leads"}],action:e.jsx(F,{component:O,href:D.dashboard.lead.new,variant:"contained",startIcon:e.jsx(v,{icon:"mingcute:add-line"}),children:"Novo lead"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(Ue,{children:[e.jsx(me,{value:l.status,onChange:t,sx:[s=>({px:2.5,boxShadow:`inset 0 -2px 0 0 ${he(s.vars.palette.grey["500Channel"],.08)}`})],children:We.map(s=>e.jsx(pe,{iconPosition:"end",value:s.value,label:s.label,icon:e.jsx(N,{variant:(s.value==="todos"||s.value===l.status)&&"filled"||"soft",color:s.value==="ativo"&&"success"||s.value==="desativados"&&"default"||"default",children:s.value==="todos"?u.length:u.filter(g=>g.status===s.value).length})},s.value))}),e.jsx(Me,{filters:o,onResetPage:a.onResetPage,options:{filterOptions:["name","phoneNumber","email","productInterest","broker"]}}),r&&e.jsx(Ve,{filters:o,totalResults:d.length,onResetPage:a.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(T,{sx:{position:"relative"},children:[e.jsx(Ae,{dense:a.dense,numSelected:a.selected.length,rowCount:d.length,onSelectAllRows:s=>a.onSelectAllRows(s,d.map(g=>g.id)),action:e.jsx(xe,{title:"Apagar",children:e.jsx(I,{color:"primary",onClick:i.onTrue,children:e.jsx(v,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(be,{children:e.jsxs(Re,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ee,{order:a.order,orderBy:a.orderBy,headCells:qe,rowCount:d.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:s=>a.onSelectAllRows(s,d.map(g=>g.id))}),e.jsxs(Ne,{children:[d.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(s=>e.jsx(_e,{row:s,selected:a.selected.includes(s.id),onSelectRow:()=>a.onSelectRow(s.id),onDeleteRow:()=>n(s.id),editHref:D.dashboard.client.edit(s.id)},s.id)),e.jsx(Fe,{height:a.dense?56:76,emptyRows:ye(a.page,a.rowsPerPage,d.length)}),e.jsx(we,{notFound:h})]})]})})]}),e.jsx(Ie,{page:a.page,dense:a.dense,count:d.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})]}),C()]})}function Ge({inputData:a,comparator:i,filters:u}){const{name:x,status:o,product:l,filterBy:c,search:d,startDate:m,endDate:r,broker:h}=u;let n=[...a];const S=n.map((t,C)=>[t,C]);return S.sort((t,C)=>{const s=i(t[0],C[0]);return s!==0?s:t[1]-C[1]}),n=S.map(t=>t[0]),d&&c&&(n=n.filter(t=>{var s;return(((s=t[c])==null?void 0:s.toString().toLowerCase())||"").includes(d.toLowerCase())})),x&&(n=n.filter(t=>t.name.toLowerCase().includes(x.toLowerCase()))),o!=="todos"&&(n=n.filter(t=>t.status===o)),l.length&&(n=n.filter(t=>l.includes(t.productInterest))),h&&(n=n.filter(t=>t.broker===h)),m&&(n=n.filter(t=>new Date(t.createdAt)>=new Date(m))),r&&(n=n.filter(t=>new Date(t.createdAt)<=new Date(r))),n}const Qe={title:`Lista de leads | Dashboard - ${ge.appName}`};function ua(){return e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsxs("title",{children:[" ",Qe.title]})}),e.jsx(He,{})]})}export{ua as default};

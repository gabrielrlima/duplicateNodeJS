import{bv as V,r as d,d$ as W,j as e,f as B,I as p,D as b,B as c,T as n,S as o,K as i,a0 as q,V as H,y as J,z as Q,O as T,cN as K,p as X,F as Y,ff as Z,Q as t,bm as ee,fg as $,bn as F,bl as g,bg as z,a1 as U,f7 as ae,f8 as se,f6 as re,fe as ne,bc as L,fh as ie,f5 as oe,fd as te,fc as le,fb as ce,fa as de,f9 as pe,N as me}from"./index-cNRh_qft.js";import{s as G}from"./schema-helper-D18en8Wv.js";import{C as A}from"./Card-C_-31fGp.js";import{C as I}from"./CardHeader-CZZHKPlX.js";import{A as ue,a as xe,b as he}from"./AccordionDetails-C25973Gc.js";function ge({caracteristicasOptions:j=[]}){const{control:O,watch:E}=V(),[x,v]=d.useState("panel-0"),{fields:m,append:C,remove:P}=W({control:O,name:"plantas"}),N=E("plantas"),S=d.useCallback(()=>{const a={id:`planta-${Date.now()}`,nome:`Planta Tipo ${m.length+1}`,descricao:"",area:0,quartos:2,banheiros:1,vagas:1,suites:0,disponivel:!0,caracteristicas:[],imagens:[]};C(a),v(`panel-${m.length}`)},[C,m.length]),D=d.useCallback(l=>{P(l),x===`panel-${l}`&&v(l>0?`panel-${l-1}`:"panel-0")},[P,x]),k=d.useCallback(l=>(a,s)=>{v(s?l:!1)},[]),M=l=>e.jsxs(o,{spacing:3,children:[e.jsxs(c,{sx:{display:"grid",gap:2,gridTemplateColumns:"repeat(2, 1fr)"},children:[e.jsx(i.Text,{name:`plantas.${l}.nome`,label:"Nome da planta",placeholder:"Ex: Planta Tipo 1 ou Cobertura Duplex"}),e.jsx(i.Text,{name:`plantas.${l}.area`,label:"Área (m²)",type:"number",slotProps:{input:{endAdornment:e.jsx(q,{position:"end",children:e.jsx(c,{component:"span",sx:{color:"text.disabled"},children:"m²"})})}}})]}),e.jsx(i.Text,{name:`plantas.${l}.descricao`,label:"Descrição",placeholder:"Descrição da planta...",multiline:!0,rows:2}),e.jsxs(c,{sx:{display:"grid",gap:2,gridTemplateColumns:"repeat(4, 1fr)"},children:[e.jsx(i.Text,{name:`plantas.${l}.quartos`,label:"Quartos",type:"number",slotProps:{input:{inputProps:{min:0}}}}),e.jsx(i.Text,{name:`plantas.${l}.banheiros`,label:"Banheiros",type:"number",slotProps:{input:{inputProps:{min:1}}}}),e.jsx(i.Text,{name:`plantas.${l}.vagas`,label:"Vagas",type:"number",slotProps:{input:{inputProps:{min:0}}}}),e.jsx(i.Text,{name:`plantas.${l}.suites`,label:"Suítes",type:"number",slotProps:{input:{inputProps:{min:0}}}})]}),j.length>0&&e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Características específicas"}),e.jsx(i.Autocomplete,{name:`plantas.${l}.caracteristicas`,placeholder:"+ Características",multiple:!0,disableCloseOnSelect:!0,options:j,getOptionLabel:a=>a||"",renderOption:(a,s)=>e.jsx(c,{component:"li",...a,children:s})})]}),e.jsx(b,{sx:{borderStyle:"dashed"}}),e.jsxs(o,{spacing:2,children:[e.jsx(n,{variant:"subtitle2",children:"Preço específico (opcional)"}),e.jsx(c,{sx:{display:"grid",gap:2,gridTemplateColumns:"1fr"},children:e.jsx(i.Text,{name:`plantas.${l}.preco.valor`,label:"Preço Total",type:"number",placeholder:"0.00",slotProps:{input:{startAdornment:e.jsx(q,{position:"start",sx:{mr:.75},children:e.jsx(c,{component:"span",sx:{color:"text.disabled"},children:"R$"})})}}})}),e.jsx(i.Switch,{name:`plantas.${l}.preco.negociavel`,label:"Preço negociável"})]}),e.jsx(b,{sx:{borderStyle:"dashed"}}),e.jsxs(o,{spacing:2,children:[e.jsx(n,{variant:"subtitle2",children:"Imagens"}),e.jsx(i.Upload,{name:`plantas.${l}.imagens`,multiple:!0,maxSize:3145728,helperText:"Faça upload das imagens da planta (máx. 3MB cada)"})]})]});return e.jsxs(A,{children:[e.jsx(I,{title:"Plantas do empreendimento",subheader:"Adicione as diferentes plantas disponíveis",action:e.jsx(B,{size:"small",color:"primary",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),onClick:S,children:"Adicionar planta"}),sx:{mb:3}}),e.jsx(b,{}),e.jsx(c,{sx:{p:3},children:m.length===0?e.jsxs(c,{sx:{py:6,textAlign:"center",color:"text.secondary"},children:[e.jsx(p,{icon:"solar:home-2-bold-duotone",width:64,sx:{mb:2,opacity:.5}}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Nenhuma planta adicionada"}),e.jsx(n,{variant:"body2",children:'Clique em "Adicionar planta" para começar'})]}):e.jsx(o,{spacing:2,children:m.map((l,a)=>{const s=N[a],r=`panel-${a}`;return e.jsxs(ue,{expanded:x===r,onChange:k(r),children:[e.jsx(xe,{expandIcon:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"}),sx:{"&.Mui-expanded":{minHeight:56},"& .MuiAccordionSummary-content":{"&.Mui-expanded":{margin:"12px 0"}}},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsxs(c,{sx:{flexGrow:1},children:[e.jsx(n,{variant:"subtitle1",children:(s==null?void 0:s.nome)||`Planta ${a+1}`}),e.jsxs(n,{variant:"body2",sx:{color:"text.secondary"},children:[s!=null&&s.area?`${s.area}m²`:"Área não definida"," •"," ",(s==null?void 0:s.quartos)||0," quartos • ",(s==null?void 0:s.banheiros)||0," banheiros"]})]}),m.length>1&&e.jsx(c,{onClick:u=>{u.stopPropagation(),D(a)},sx:{ml:1,p:.5,borderRadius:1,cursor:"pointer",color:"error.main",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{bgcolor:"error.lighter"}},children:e.jsx(p,{icon:"solar:trash-bin-trash-bold",width:18})})]})}),e.jsx(he,{children:M(a)})]},l.id)})})})]})}const je=T({titulo:t().min(1,{message:"Título é obrigatório!"}),descricao:t().min(1,{message:"Descrição é obrigatória!"}),book:$().optional(),avatar:$().optional(),tiposUnidade:t().array().min(1,{message:"Escolha pelo menos uma opção!"}),caracteristicas:t().array().min(1,{message:"Escolha pelo menos uma opção!"}),cronograma:t().array().min(1,{message:"Escolha pelo menos uma opção!"}),cidade:t().min(1,{message:"Cidade é obrigatória!"}),estado:t().min(1,{message:"Estado é obrigatório!"}),dataEntrega:G.date({message:{required:"Data de entrega é obrigatória!"}}),preco:T({valor:G.nullableInput(g({coerce:!0}).min(1,{message:"Preço é obrigatório!"}),{message:"Preço é obrigatório!"}),tipo:t(),negociavel:F()}),beneficios:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),diferenciaisEdificio:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),diferenciaisApartamento:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),tipoApartamento:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),tipoSacada:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),oportunidadesDisponiveis:t().array().min(0,{message:"Escolha pelo menos uma opção!"}),plantas:ee(T({id:t(),nome:t().min(1,{message:"Nome da planta é obrigatório!"}),descricao:t().optional(),area:g({coerce:!0}).min(1,{message:"Área é obrigatória!"}),quartos:g({coerce:!0}).min(0,{message:"Número de quartos é obrigatório!"}),banheiros:g({coerce:!0}).min(1,{message:"Número de banheiros é obrigatório!"}),vagas:g({coerce:!0}).min(0,{message:"Número de vagas é obrigatório!"}),suites:g({coerce:!0}).min(0).optional(),disponivel:F(),caracteristicas:t().array().optional(),imagens:$().array().optional(),preco:T({valor:g({coerce:!0}).min(0).optional(),negociavel:F().optional()}).optional()})).min(1,{message:"Adicione pelo menos uma planta!"}),tipoEmpreendimento:t(),construtora:T({name:t().min(1,{message:"Nome da construtora é obrigatório!"}),logo:t().optional(),phoneNumber:t().optional(),fullAddress:t().optional()}),statusEmpreendimento:t().min(1,{message:"Status do empreendimento é obrigatório!"})});function Te({currentEmpreendimento:j}){const O=H(),E=d.useRef(null),x=d.useRef(null),v={titulo:"",descricao:"",book:null,avatar:null,tiposUnidade:[],tipoEmpreendimento:"Residencial",caracteristicas:[],cronograma:[],cidade:"",estado:"",dataEntrega:null,preco:{valor:null,negociavel:!1},beneficios:[],diferenciaisEdificio:[],diferenciaisApartamento:[],tipoApartamento:[],tipoSacada:[],oportunidadesDisponiveis:[],plantas:[{id:"1",nome:"Planta Tipo 1",descricao:"",area:0,quartos:2,banheiros:1,vagas:1,suites:0,disponivel:!0,caracteristicas:[]}],construtora:{name:"",logo:"",phoneNumber:"",fullAddress:""},statusEmpreendimento:""},m=J({mode:"all",resolver:Q(je),defaultValues:v,values:j}),{reset:C,handleSubmit:P,formState:{isSubmitting:N}}=m,S=P(async a=>{try{await new Promise(s=>setTimeout(s,500)),C(),K.success(j?"Atualização realizada com sucesso!":"Empreendimento criado com sucesso!"),O.push(X.dashboard.empreendimentos.root),console.info("DATA",a)}catch(s){console.error(s)}}),D=()=>e.jsxs(A,{children:[e.jsx(I,{title:"Detalhes",subheader:"Título, descrição, imagem...",sx:{mb:3}}),e.jsx(b,{}),e.jsxs(o,{spacing:3,sx:{p:3},children:[e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Título"}),e.jsx(i.Text,{name:"titulo",placeholder:"Ex: Residencial Vista Bela..."})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Descrição"}),e.jsx(i.Text,{name:"descricao",placeholder:"Descreva as principais características do empreendimento...",multiline:!0,rows:4})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Book do Empreendimento"}),e.jsx(z,{name:"book",render:({field:a,fieldState:{error:s}})=>{var y,f;const r=a.value&&(Array.isArray(a.value)?a.value.length>0:a.value),u=()=>{E.current&&E.current.click()},R=w=>{const h=w.target.files;h&&h.length>0&&a.onChange(h[0])},_=r?Array.isArray(a.value)?(y=a.value[0])==null?void 0:y.name:((f=a.value)==null?void 0:f.name)||"Arquivo selecionado":null;return e.jsxs(c,{children:[e.jsx(B,{variant:r?"contained":"outlined",color:r?"success":"primary",onClick:u,startIcon:r?e.jsx(p,{icon:"eva:checkmark-circle-2-fill"}):e.jsx(p,{icon:"eva:file-text-outline"}),sx:{width:"100%",height:56,borderStyle:r?"solid":"dashed",borderWidth:2,borderColor:r?"success.main":"grey.300",bgcolor:r?"success.lighter":"transparent",color:r?"success.dark":"inherit","&:hover":{bgcolor:r?"success.light":"grey.50"}},children:r?"Book Selecionado":"Selecionar Book"}),r&&e.jsxs(c,{sx:{mt:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(n,{variant:"body2",color:"success.main",sx:{flex:1},children:_}),e.jsx(U,{size:"small",onClick:()=>a.onChange(null),color:"error",children:e.jsx(p,{icon:"eva:close-fill",width:16})})]}),e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Formatos aceitos: PDF, DOC, DOCX"}),s&&e.jsx(n,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:s.message}),e.jsx("input",{ref:E,type:"file",accept:".pdf,.doc,.docx",onChange:R,style:{display:"none"}})]})}})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Avatar do Empreendimento"}),e.jsx(z,{name:"avatar",render:({field:a,fieldState:{error:s}})=>{var y,f;const r=a.value&&(Array.isArray(a.value)?a.value.length>0:a.value),u=()=>{x.current&&x.current.click()},R=w=>{const h=w.target.files;h&&h.length>0&&a.onChange(h[0])},_=r?Array.isArray(a.value)?(y=a.value[0])==null?void 0:y.name:((f=a.value)==null?void 0:f.name)||"Arquivo selecionado":null;return e.jsxs(c,{children:[e.jsx(B,{variant:r?"contained":"outlined",color:r?"success":"primary",onClick:u,startIcon:r?e.jsx(p,{icon:"eva:checkmark-circle-2-fill"}):e.jsx(p,{icon:"eva:image-outline"}),sx:{width:"100%",height:56,borderStyle:r?"solid":"dashed",borderWidth:2,borderColor:r?"success.main":"grey.300",bgcolor:r?"success.lighter":"transparent",color:r?"success.dark":"inherit","&:hover":{bgcolor:r?"success.light":"grey.50"}},children:r?"Imagem Selecionada":"Selecionar Imagem"}),r&&e.jsxs(c,{sx:{mt:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(n,{variant:"body2",color:"success.main",sx:{flex:1},children:_}),e.jsx(U,{size:"small",onClick:()=>a.onChange(null),color:"error",children:e.jsx(p,{icon:"eva:close-fill",width:16})})]}),e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Formatos aceitos: JPG, JPEG, PNG, WEBP"}),s&&e.jsx(n,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:s.message}),e.jsx("input",{ref:x,type:"file",accept:".jpg,.jpeg,.png,.webp",onChange:R,style:{display:"none"}})]})}})]})]})]}),k=()=>e.jsxs(A,{children:[e.jsx(I,{title:"Detalhes do Empreendimento",sx:{mb:3}}),e.jsx(b,{}),e.jsxs(o,{spacing:3,sx:{p:3},children:[e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Construtora"}),e.jsx(i.Text,{name:"construtora.name",placeholder:"Nome da construtora"})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Status do Empreendimento"}),e.jsx(i.Autocomplete,{name:"statusEmpreendimento",placeholder:"Selecionar status",options:ae,getOptionLabel:a=>(a==null?void 0:a.label)||"",isOptionEqualToValue:(a,s)=>(a==null?void 0:a.value)===(s==null?void 0:s.value)||(a==null?void 0:a.value)===s})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Tipo de empreendimento"}),e.jsx(i.RadioGroup,{row:!0,name:"tipoEmpreendimento",options:se,sx:{gap:4}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Tipos de unidade"}),e.jsx(i.MultiCheckbox,{row:!0,name:"tiposUnidade",options:re,sx:{gap:4}})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Localização"}),e.jsxs(c,{sx:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:2},children:[e.jsx(i.Text,{name:"cidade",placeholder:"Cidade"}),e.jsx(i.Text,{name:"estado",placeholder:"Estado"})]})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Data de entrega"}),e.jsx(i.DatePicker,{name:"dataEntrega"})]}),e.jsxs(o,{spacing:2,children:[e.jsx(n,{variant:"subtitle2",children:"Preço do m²"}),e.jsx(i.Text,{name:"preco.valor",placeholder:"0.00",type:"number",slotProps:{input:{startAdornment:e.jsx(q,{position:"start",sx:{mr:.75},children:e.jsx(c,{component:"span",sx:{color:"text.disabled"},children:"R$"})})}}})]})]})]}),M=()=>e.jsxs(A,{children:[e.jsx(I,{title:"Características e Diferenciais",sx:{mb:3}}),e.jsx(b,{}),e.jsxs(o,{spacing:3,sx:{p:3},children:[e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Características"}),e.jsx(i.Autocomplete,{name:"caracteristicas",placeholder:"+ Características",multiple:!0,disableCloseOnSelect:!0,options:ne.map(a=>a),getOptionLabel:a=>a||"",renderOption:(a,s)=>d.createElement("li",{...a,key:s},s),renderTags:(a,s)=>a.map((r,u)=>d.createElement(L,{...s({index:u}),key:r,label:r,size:"small",color:"info",variant:"soft"}))})]}),e.jsxs(o,{spacing:1.5,children:[e.jsx(n,{variant:"subtitle2",children:"Cronograma"}),e.jsx(i.Autocomplete,{name:"cronograma",placeholder:"+ Cronograma",multiple:!0,disableCloseOnSelect:!0,options:ie.map(a=>a),getOptionLabel:a=>a||"",renderOption:(a,s)=>d.createElement("li",{...a,key:s},s),renderTags:(a,s)=>a.map((r,u)=>d.createElement(L,{...s({index:u}),key:r,label:r,size:"small",color:"info",variant:"soft"}))})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Benefícios"}),e.jsx(i.MultiCheckbox,{name:"beneficios",options:oe,sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Diferenciais do Edifício"}),e.jsx(i.MultiCheckbox,{name:"diferenciaisEdificio",options:te.map(a=>({label:a,value:a})),sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Diferenciais do Apartamento"}),e.jsx(i.MultiCheckbox,{name:"diferenciaisApartamento",options:le.map(a=>({label:a,value:a})),sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Tipo de Apartamento"}),e.jsx(i.MultiCheckbox,{name:"tipoApartamento",options:ce.map(a=>({label:a,value:a})),sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Tipo de Sacada"}),e.jsx(i.MultiCheckbox,{name:"tipoSacada",options:de.map(a=>({label:a,value:a})),sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(o,{spacing:1,children:[e.jsx(n,{variant:"subtitle2",children:"Oportunidades Disponíveis"}),e.jsx(i.MultiCheckbox,{name:"oportunidadesDisponiveis",options:pe.map(a=>({label:a,value:a})),sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]})]})]}),l=()=>e.jsx(c,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(me,{type:"submit",variant:"contained",size:"large",loading:N,children:j?"Salvar alterações":"Criar empreendimento"})});return e.jsx(Y,{methods:m,onSubmit:S,children:e.jsxs(o,{spacing:{xs:3,md:5},sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[D(),k(),M(),e.jsx(ge,{caracteristicasOptions:Z}),l()]})})}export{Te as E};

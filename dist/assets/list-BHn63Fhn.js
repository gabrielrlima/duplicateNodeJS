import{V as E,ca as z,j as e,B as r,A as N,aJ as V,L as H,aB as O,aP as M,c3 as W,a1 as $,I as f,cb as U,cc as q,cd as k,r as v,S,au as K,a0 as _,b6 as h,cG as P,T as b,G as w,a_ as I,dC as J,b8 as G,aZ as L,p,dK as Z,aq as Q,f as B,R as X,l as Y,U as ee,n as se,c4 as ae,H as te,C as oe}from"./index-D82XrlGq.js";import"./grupo-new-edit-form-DANnZ9bo.js";import{u as re}from"./use-grupos-qz-PfNWO.js";import{u as ne,g as le,e as ie,T as ce}from"./table-no-data-DH7CjOyR.js";import{T as de}from"./table-empty-rows-Vu5FyjZw.js";import{T as ue}from"./table-head-custom-CuFVaOdc.js";import{T as me}from"./table-pagination-custom-D5_o9sKp.js";import{b as xe,T as pe,a as he}from"./TableHead-RMfhpLqX.js";import{T as g}from"./TableCell-9zzJlMjB.js";import{s as R}from"./sumBy-ofy1HSRF.js";import{C as F}from"./Card-Bw-3A9ev.js";import{F as be,a as A,c as D}from"./filters-result-BUC8QtIh.js";import"./empty-content-CAmd9egU.js";import"./use-corretores-D9KzIeK_.js";import"./confirm-dialog-rvtuH5TT.js";import"./schema-helper-BcHhi0sG.js";import"./TablePagination-DsJAP4En.js";import"./LastPage-xOhVKZvt.js";import"./Toolbar-CnhKmG_y.js";function ge({row:s,editHref:d,detailsHref:n}){const a=E(),t=z(),u=()=>{a.push(n)},o=e.jsxs(xe,{hover:!0,onClick:u,sx:{cursor:"pointer"},children:[e.jsx(g,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(N,{alt:s.name,src:s.avatarUrl||void 0,sx:{mr:2,width:40,height:40,bgcolor:"primary.main"},children:s.name.split(" ").map(c=>c.charAt(0)).join("").toUpperCase().slice(0,2)}),e.jsx(V,{primary:e.jsx(H,{color:"inherit",sx:{cursor:"pointer"},children:s.name}),secondary:e.jsx(r,{component:"span",sx:{typography:"caption",color:"text.disabled"},children:s.description}),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{color:"text.disabled","&:hover":{color:"text.secondary"}}}}})]})}),e.jsxs(g,{children:[e.jsx(r,{sx:{typography:"body2"},children:s.leader}),e.jsx(r,{sx:{typography:"caption",color:"text.disabled"},children:s.regiao})]}),e.jsxs(g,{align:"center",children:[e.jsx(r,{sx:{typography:"body2",fontWeight:"bold"},children:s.members}),e.jsx(r,{sx:{typography:"caption",color:"text.disabled"},children:"membros"})]}),e.jsx(g,{align:"center",children:e.jsx(r,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(r,{sx:{minWidth:35,mr:1},children:[e.jsx(r,{sx:{typography:"body2",fontWeight:"bold"},children:s.vendas||0}),s.meta&&e.jsxs(r,{sx:{typography:"caption",color:"text.disabled"},children:["/",s.meta]})]})})}),e.jsx(g,{align:"center",children:s.performance&&e.jsxs(r,{sx:{width:80},children:[e.jsx(O,{variant:"determinate",value:s.performance,color:s.performance>=80&&"success"||s.performance>=60&&"warning"||"error",sx:{height:6,borderRadius:1}}),e.jsxs(r,{sx:{typography:"caption",textAlign:"center",mt:.5},children:[s.performance,"%"]})]})}),e.jsx(g,{children:e.jsxs(M,{variant:"soft",color:s.status==="ativo"&&"success"||s.status==="suspenso"&&"warning"||s.status==="inativo"&&"error"||"default",children:[s.status==="ativo"&&"Ativo",s.status==="suspenso"&&"Suspenso",s.status==="inativo"&&"Inativo"]})}),e.jsx(g,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(W,{title:"Ações",placement:"top",arrow:!0,children:e.jsx($,{color:t.open?"inherit":"default",onClick:c=>{c.stopPropagation(),t.onOpen(c)},children:e.jsx(f,{icon:"eva:more-vertical-fill"})})})})]});return e.jsxs(e.Fragment,{children:[o,e.jsx(U,{open:t.open,anchorEl:t.anchorEl,onClose:t.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(q,{children:[e.jsxs(k,{onClick:()=>{t.onClose(),a.push(n)},children:[e.jsx(f,{icon:"solar:eye-bold"}),"Visualizar"]}),e.jsxs(k,{onClick:()=>{t.onClose(),a.push(d)},children:[e.jsx(f,{icon:"solar:pen-bold"}),"Editar"]})]})})]})}function je({filters:s,onResetPage:d}){const{state:n,setState:a}=s,t=v.useCallback(u=>{d(),a({name:u.target.value})},[d,a]);return e.jsx(S,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:e.jsx(K,{fullWidth:!0,value:n.name,onChange:t,placeholder:"Buscar grupo por nome ou líder...",InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(f,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}function fe({grupos:s,sx:d,...n}){const a=s.length,t=s.filter(l=>l.status==="ativo").length,u=R(s,l=>l.comissaoTotal),o=R(s,l=>l.vendas),c=R(s,l=>l.members),m=a>0?u/a:0,C=a>0?o/a:0,x=s.reduce((l,j)=>l.comissaoTotal>j.comissaoTotal?l:j,s[0]||{}),y=[{title:"Comissão Total",value:P(u),icon:"solar:dollar-minimalistic-bold-duotone",subtitle:`${h(a)} grupos`},{title:"Total de Vendas",value:h(o),icon:"solar:chart-square-bold-duotone",subtitle:`Média: ${h(C)} por grupo`},{title:"Comissão Média",value:P(m),icon:"solar:pie-chart-2-bold-duotone",subtitle:"Por grupo"},{title:"Total de Membros",value:h(c),icon:"solar:users-group-rounded-bold-duotone",subtitle:`${h(t)} grupos ativos`}];return e.jsxs(S,{spacing:3,sx:d,...n,children:[e.jsxs(r,{children:[e.jsx(b,{variant:"h6",sx:{mb:1},children:"Resumo de Performance dos Grupos"}),e.jsx(b,{variant:"body2",sx:{color:"text.secondary"},children:"Visão geral do desempenho dos grupos de vendas"})]}),e.jsx(w,{container:!0,spacing:3,children:y.map((l,j)=>e.jsx(w,{size:{xs:12,sm:6,md:3},children:e.jsxs(F,{sx:{p:3},children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",mb:2,color:"text.secondary"},children:e.jsx(f,{icon:l.icon,width:24,sx:{mr:1}})}),e.jsx(b,{variant:"h4",sx:{mb:.5},children:l.value}),e.jsx(b,{variant:"subtitle2",sx:{mb:1,color:"text.primary"},children:l.title}),e.jsx(b,{variant:"caption",sx:{color:"text.secondary"},children:l.subtitle})]})},j))}),(x==null?void 0:x.name)&&e.jsx(F,{sx:{p:3},children:e.jsxs(S,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",color:"warning.main"},children:e.jsx(f,{icon:"solar:crown-star-bold-duotone",width:24})}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(b,{variant:"subtitle2",sx:{mb:.5},children:"🏆 Grupo Top Performer"}),e.jsxs(b,{variant:"body2",sx:{color:"text.secondary"},children:[e.jsx("strong",{children:x.name})," • ",P(x.comissaoTotal)," em comissões • ",h(x.vendas)," vendas • ",h(x.members)," ","membros"]})]})]})})]})}function ve({filters:s,totalResults:d,onResetPage:n}){const{state:a,setState:t}=s,u=v.useCallback(()=>{n(),t({name:""})},[n,t]),o=v.useCallback(()=>{n(),t({status:"all"})},[n,t]),c=v.useCallback(()=>{n(),t({name:"",status:"all",startDate:null,endDate:null})},[n,t]);return e.jsxs(be,{totalResults:d,onReset:c,sx:{p:2.5,pt:0},children:[e.jsx(A,{label:"Status:",isShow:a.status!=="all",children:e.jsx(I,{...D,label:a.status==="ativo"&&"Ativo"||a.status==="suspenso"&&"Suspenso"||a.status==="inativo"&&"Inativo"||a.status,onDelete:o,sx:{textTransform:"capitalize"}})}),e.jsx(A,{label:"Palavra-chave:",isShow:!!a.name,children:e.jsx(I,{...D,label:a.name,onDelete:u})})]})}const ye=[{id:"name",label:"Nome"},{id:"leader",label:"Líder"},{id:"members",label:"Membros",align:"center"},{id:"vendas",label:"Vendas",align:"center"},{id:"performance",label:"Performance",align:"center"},{id:"status",label:"Status"},{id:"actions"}];function Ce(){const s=ne({defaultOrderBy:"name"}),{grupos:d,loading:n,error:a,refetch:t}=re();v.useEffect(()=>{t()},[t]);const u=J({name:"",status:"all",startDate:null,endDate:null}),{state:o,setState:c}=u,m=Te({inputData:d,comparator:le(s.order,s.orderBy),filters:o}),C=!!o.name||o.status!=="all",x=!m.length&&C||!m.length,y=i=>d.filter(T=>T.status===i).length,l=[{value:"all",label:"Todos",color:"default",count:d.length},{value:"ativo",label:"Ativo",color:"success",count:y("ativo")},{value:"inativo",label:"Inativo",color:"error",count:y("inativo")},{value:"suspenso",label:"Suspenso",color:"warning",count:y("suspenso")}],j=v.useCallback((i,T)=>{s.onResetPage(),c({status:T})},[s,c]);return n?e.jsxs(G,{children:[e.jsx(L,{heading:"Grupos",links:[{name:"Dashboard",href:p.dashboard.root},{name:"Grupos",href:p.dashboard.grupos.root},{name:"Lista"}],sx:{mb:{xs:3,md:5}}}),e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:e.jsx(Z,{size:60})})]}):a?e.jsxs(G,{children:[e.jsx(L,{heading:"Grupos",links:[{name:"Dashboard",href:p.dashboard.root},{name:"Grupos",href:p.dashboard.grupos.root},{name:"Lista"}],sx:{mb:{xs:3,md:5}}}),e.jsxs(Q,{severity:"error",sx:{mb:3},children:[a,e.jsx(B,{onClick:t,sx:{ml:2},variant:"outlined",size:"small",children:"Tentar novamente"})]})]}):e.jsxs(G,{children:[e.jsx(L,{heading:"Grupos",links:[{name:"Dashboard",href:p.dashboard.root},{name:"Grupos",href:p.dashboard.grupos.root},{name:"Lista"}],action:e.jsx(B,{component:X,href:p.dashboard.grupos.new,variant:"contained",children:"Novo grupo"}),sx:{mb:{xs:3,md:5}}}),e.jsx(fe,{grupos:d,sx:{mb:3}}),e.jsxs(F,{children:[e.jsx(Y,{value:o.status,onChange:j,sx:{px:2.5,boxShadow:i=>`inset 0 -2px 0 0 ${ee(i.vars.palette.grey["500Channel"],.08)}`},children:l.map(i=>e.jsx(se,{iconPosition:"end",value:i.value,label:i.label,icon:e.jsx(M,{variant:(i.value==="all"||i.value===o.status)&&"filled"||"soft",color:i.color,children:i.count})},i.value))}),e.jsx(je,{filters:u,onResetPage:s.onResetPage}),C&&e.jsx(ve,{filters:u,totalResults:m.length,onResetPage:s.onResetPage}),e.jsx(r,{sx:{position:"relative"},children:e.jsx(ae,{children:e.jsxs(pe,{size:s.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(ue,{order:s.order,orderBy:s.orderBy,headCells:ye,onSort:s.onSort}),e.jsxs(he,{children:[m.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(i=>e.jsx(ge,{row:i,editHref:p.dashboard.grupos.edit(i.id),detailsHref:p.dashboard.grupos.details(i.id)},i.id)),e.jsx(de,{height:s.dense?56:76,emptyRows:ie(s.page,s.rowsPerPage,m.length)}),e.jsx(ce,{notFound:x,title:"Nenhum grupo encontrado"})]})]})})}),e.jsx(me,{page:s.page,dense:s.dense,count:m.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})}function Te({inputData:s,comparator:d,filters:n}){const{name:a,status:t}=n,u=s.map((o,c)=>[o,c]);return u.sort((o,c)=>{const m=d(o[0],c[0]);return m!==0?m:o[1]-c[1]}),s=u.map(o=>o[0]),a&&(s=s.filter(o=>o.name.toLowerCase().indexOf(a.toLowerCase())!==-1||o.leader.toLowerCase().indexOf(a.toLowerCase())!==-1||o.description.toLowerCase().indexOf(a.toLowerCase())!==-1)),t!=="all"&&(s=s.filter(o=>o.status===t)),s}const Pe={title:`Lista de grupos | Dashboard - ${oe.appName}`};function $e(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsxs("title",{children:[" ",Pe.title," "]})}),e.jsx(Ce,{})]})}export{$e as default};
